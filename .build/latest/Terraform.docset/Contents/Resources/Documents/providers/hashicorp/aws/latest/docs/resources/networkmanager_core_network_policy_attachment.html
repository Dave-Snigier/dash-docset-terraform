<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/networkmanager_core_network_policy_attachment --><head>
                <title>aws_networkmanager_core_network_policy_attachment</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="resource-aws_networkmanager_core_network_policy_attachment">Resource: aws_networkmanager_core_network_policy_attachment</h1>

<p>Provides a Core Network Policy Attachment resource. This puts a Core Network Policy to an existing Core Network and executes the change set, which deploys changes globally based on the policy submitted (Sets the policy to <code>LIVE</code>).</p>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>Deleting this resource will not delete the current policy defined in this resource. Deleting this resource will also not revert the current <code>LIVE</code> policy to the previous version.</p>
</aside>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Basic"></a><h3 id="basic">Basic</h3>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">global_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_global_network.example.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.example.json</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/With%20VPC%20Attachment%20%28Single%20Region%29"></a><h3 id="with-vpc-attachment-single-region">With VPC Attachment (Single Region)</h3>

<p>The example below illustrates the scenario where your policy document has static routes pointing to VPC attachments and you want to attach your VPCs to the core network before applying the desired policy document. Set the <code>create_base_policy</code> argument of the <a href="../resources/networkmanager_core_network.html"><code>aws_networkmanager_core_network</code> resource</a> to <code>true</code> if your core network does not currently have any <code>LIVE</code> policies (e.g. this is the first <code>terraform apply</code> with the core network resource), since a <code>LIVE</code> policy is required before VPCs can be attached to the core network. Otherwise, if your core network already has a <code>LIVE</code> policy, you may exclude the <code>create_base_policy</code> argument. There are 2 options to implement this:</p>

<ul>
<li>Option 1: Use the <code>base_policy_document</code> argument in the <a href="../resources/networkmanager_core_network.html"><code>aws_networkmanager_core_network</code> resource</a> that allows the most customizations to a base policy. Use this to customize the <code>edge_locations</code> <code>asn</code>. In the example below, <code>us-west-2</code> and ASN <code>65500</code> are used in the base policy.</li>
<li>Option 2: Use the <code>create_base_policy</code> argument only. This creates a base policy in the region specified in the <code>provider</code> block.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Option%201%20-%20using%20base_policy_document"></a><h4 id="option-1-using-base_policy_document">Option 1 - using base_policy_document</h4>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_global_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_document"</span><span class="w"> </span><span class="nv">"base"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">core_network_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"65022-65534"</span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-west-2"</span><span class="w"></span>
<span class="w">      </span><span class="na">asn</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"65500"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">global_network_id</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_global_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">base_policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.base.json</span><span class="w"></span>
<span class="w">  </span><span class="na">create_base_policy</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_document"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">core_network_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"65022-65534"</span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-west-2"</span><span class="w"></span>
<span class="w">      </span><span class="na">asn</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"65500"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segment_actions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">action</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"create-route"</span><span class="w"></span>
<span class="w">    </span><span class="na">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">    </span><span class="na">destination_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"0.0.0.0/0"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">destinations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_networkmanager_vpc_attachment.example.id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.example.json</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_vpc_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">subnet_arns</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.example</span><span class="p">[</span><span class="err">*</span><span class="p">].</span><span class="err">arn</span><span class="w"></span>
<span class="w">  </span><span class="na">vpc_arn</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.example.arn</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Option%202%20-%20create_base_policy%20only"></a><h4 id="option-2-create_base_policy-only">Option 2 - create_base_policy only</h4>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_global_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_document"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">core_network_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"65022-65534"</span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-west-2"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segment_actions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">action</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"create-route"</span><span class="w"></span>
<span class="w">    </span><span class="na">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">    </span><span class="na">destination_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"0.0.0.0/0"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">destinations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_networkmanager_vpc_attachment.example.id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">global_network_id</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_global_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">create_base_policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.example.json</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_vpc_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">subnet_arns</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.example</span><span class="p">[</span><span class="err">*</span><span class="p">].</span><span class="err">arn</span><span class="w"></span>
<span class="w">  </span><span class="na">vpc_arn</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.example.arn</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/With%20VPC%20Attachment%20%28Multi-Region%29"></a><h3 id="with-vpc-attachment-multi-region">With VPC Attachment (Multi-Region)</h3>

<p>The example below illustrates the scenario where your policy document has static routes pointing to VPC attachments and you want to attach your VPCs to the core network before applying the desired policy document. Set the <code>create_base_policy</code> argument of the <a href="../resources/networkmanager_core_network.html"><code>aws_networkmanager_core_network</code> resource</a> to <code>true</code> if your core network does not currently have any <code>LIVE</code> policies (e.g. this is the first <code>terraform apply</code> with the core network resource), since a <code>LIVE</code> policy is required before VPCs can be attached to the core network. Otherwise, if your core network already has a <code>LIVE</code> policy, you may exclude the <code>create_base_policy</code> argument. For multi-region in a core network that does not yet have a <code>LIVE</code> policy, there are 2 options:</p>

<ul>
<li>Option 1: Use the <code>base_policy_document</code> argument that allows the most customizations to a base policy. Use this to customize the <code>edge_locations</code> <code>asn</code>. In the example below, <code>us-west-2</code>, <code>us-east-1</code> and specific ASNs are used in the base policy.</li>
<li>Option 2: Pass a list of regions to the <a href="../resources/networkmanager_core_network.html"><code>aws_networkmanager_core_network</code> resource</a> <code>base_policy_regions</code> argument. In the example below, <code>us-west-2</code> and <code>us-east-1</code> are specified in the base policy.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Option%201%20-%20using%20base_policy_document"></a><h4 id="option-1-using-base_policy_document-2">Option 1 - using base_policy_document</h4>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_global_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_document"</span><span class="w"> </span><span class="nv">"base"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">core_network_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"65022-65534"</span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-west-2"</span><span class="w"></span>
<span class="w">      </span><span class="na">asn</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"65500"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="w"></span>
<span class="w">      </span><span class="na">asn</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"65501"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">global_network_id</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_global_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">base_policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.base.json</span><span class="w"></span>
<span class="w">  </span><span class="na">create_base_policy</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_document"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">core_network_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"65022-65534"</span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-west-2"</span><span class="w"></span>
<span class="w">      </span><span class="na">asn</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"65500"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="w"></span>
<span class="w">      </span><span class="na">asn</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"65501"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment2"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segment_actions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">action</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"create-route"</span><span class="w"></span>
<span class="w">    </span><span class="na">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">    </span><span class="na">destination_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"10.0.0.0/16"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">destinations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_networkmanager_vpc_attachment.example_us_west_2.id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segment_actions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">action</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"create-route"</span><span class="w"></span>
<span class="w">    </span><span class="na">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">    </span><span class="na">destination_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"10.1.0.0/16"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">destinations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_networkmanager_vpc_attachment.example_us_east_1.id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.example.json</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_vpc_attachment"</span><span class="w"> </span><span class="nv">"example_us_west_2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">subnet_arns</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.example_us_west_2</span><span class="p">[</span><span class="err">*</span><span class="p">].</span><span class="err">arn</span><span class="w"></span>
<span class="w">  </span><span class="na">vpc_arn</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.example_us_west_2.arn</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_vpc_attachment"</span><span class="w"> </span><span class="nv">"example_us_east_1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"alternate"</span><span class="w"></span>

<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">subnet_arns</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.example_us_east_1</span><span class="p">[</span><span class="err">*</span><span class="p">].</span><span class="err">arn</span><span class="w"></span>
<span class="w">  </span><span class="na">vpc_arn</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.example_us_east_1.arn</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Option%202%20-%20using%20base_policy_regions"></a><h4 id="option-2-using-base_policy_regions">Option 2 - using base_policy_regions</h4>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_global_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_document"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">core_network_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"65022-65534"</span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-west-2"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="nb">edge_locations</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-east-1"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segments</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment2"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segment_actions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">action</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"create-route"</span><span class="w"></span>
<span class="w">    </span><span class="na">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">    </span><span class="na">destination_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"10.0.0.0/16"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">destinations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_networkmanager_vpc_attachment.example_us_west_2.id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">segment_actions</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">action</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"create-route"</span><span class="w"></span>
<span class="w">    </span><span class="na">segment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"segment"</span><span class="w"></span>
<span class="w">    </span><span class="na">destination_cidr_blocks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"10.1.0.0/16"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">destinations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_networkmanager_vpc_attachment.example_us_east_1.id</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">global_network_id</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_global_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">base_policy_regions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"us-west-2", "us-east-1"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="na">create_base_policy</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_core_network_policy_attachment"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_document</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_networkmanager_core_network_policy_document.example.json</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_vpc_attachment"</span><span class="w"> </span><span class="nv">"example_us_west_2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">subnet_arns</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.example_us_west_2</span><span class="p">[</span><span class="err">*</span><span class="p">].</span><span class="err">arn</span><span class="w"></span>
<span class="w">  </span><span class="na">vpc_arn</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.example_us_west_2.arn</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_networkmanager_vpc_attachment"</span><span class="w"> </span><span class="nv">"example_us_east_1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"alternate"</span><span class="w"></span>

<span class="w">  </span><span class="na">core_network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">subnet_arns</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_subnet.example_us_east_1</span><span class="p">[</span><span class="err">*</span><span class="p">].</span><span class="err">arn</span><span class="w"></span>
<span class="w">  </span><span class="na">vpc_arn</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_vpc.example_us_east_1.arn</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>This resource supports the following arguments:</p>

<ul>
<li><code>core_network_id</code> - (Required) The ID of the core network that a policy will be attached to and made <code>LIVE</code>.</li>
<li><code>policy_document</code> - (Required) Policy document for creating a core network. Note that updating this argument will result in the new policy document version being set as the <code>LATEST</code> and <code>LIVE</code> policy document. Refer to the <a href="https://docs.aws.amazon.com/network-manager/latest/cloudwan/cloudwan-policy-change-sets.html">Core network policies documentation</a> for more information.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p><a href="https://developer.hashicorp.com/terraform/language/resources/syntax#operation-timeouts">Configuration options</a>:</p>

<ul>
<li><code>update</code> - (Default <code>30m</code>). If this is the first time attaching a policy to a core network then this timeout value is also used as the <code>create</code> timeout value.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attribute%20Reference"></a><h2 id="attribute-reference">Attribute Reference</h2>

<p>This resource exports the following attributes in addition to the arguments above:</p>

<ul>
<li><code>state</code> - Current state of a core network.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import <code>aws_networkmanager_core_network_policy_attachment</code> using the core network ID. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_networkmanager_core_network_policy_attachment.example</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"core-network-0d47f6t230mz46dy4"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Using <code>terraform import</code>, import <code>aws_networkmanager_core_network_policy_attachment</code> using the core network ID. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">% </span>terraform import aws_networkmanager_core_network_policy_attachment.example core-network-0d47f6t230mz46dy4
</code></pre></div>

            
        
    </body></html>