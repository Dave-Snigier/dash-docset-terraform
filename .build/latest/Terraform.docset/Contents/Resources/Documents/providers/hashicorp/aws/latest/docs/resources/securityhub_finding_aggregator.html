<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/securityhub_finding_aggregator --><head>
                <title>aws_securityhub_finding_aggregator</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="resource-aws_securityhub_finding_aggregator">Resource: aws_securityhub_finding_aggregator</h1>

<p>Manages a Security Hub finding aggregator. Security Hub needs to be enabled in a region in order for the aggregator to pull through findings.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<a class="dashAnchor" name="//apple_ref/cpp/Section/All%20Regions%20Usage"></a><h3 id="all-regions-usage">All Regions Usage</h3>

<p>The following example will enable the aggregator for every region.</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_securityhub_account"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_securityhub_finding_aggregator"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">linking_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ALL_REGIONS"</span><span class="w"></span>

<span class="w">  </span><span class="na">depends_on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">aws_securityhub_account.example</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/All%20Regions%20Except%20Specified%20Regions%20Usage"></a><h3 id="all-regions-except-specified-regions-usage">All Regions Except Specified Regions Usage</h3>

<p>The following example will enable the aggregator for every region except those specified in <code>specified_regions</code>.</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_securityhub_account"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_securityhub_finding_aggregator"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">linking_mode</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"ALL_REGIONS_EXCEPT_SPECIFIED"</span><span class="w"></span>
<span class="w">  </span><span class="na">specified_regions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"eu-west-1", "eu-west-2"</span><span class="p">]</span><span class="w"></span>

<span class="w">  </span><span class="na">depends_on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">aws_securityhub_account.example</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Specified%20Regions%20Usage"></a><h3 id="specified-regions-usage">Specified Regions Usage</h3>

<p>The following example will enable the aggregator for every region specified in <code>specified_regions</code>.</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_securityhub_account"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_securityhub_finding_aggregator"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">linking_mode</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"SPECIFIED_REGIONS"</span><span class="w"></span>
<span class="w">  </span><span class="na">specified_regions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"eu-west-1", "eu-west-2"</span><span class="p">]</span><span class="w"></span>

<span class="w">  </span><span class="na">depends_on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">aws_securityhub_account.example</span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>This resource supports the following arguments:</p>

<ul>
<li><code>linking_mode</code> - (Required) Indicates whether to aggregate findings from all of the available Regions or from a specified list. The options are <code>ALL_REGIONS</code>, <code>ALL_REGIONS_EXCEPT_SPECIFIED</code> or <code>SPECIFIED_REGIONS</code>. When <code>ALL_REGIONS</code> or <code>ALL_REGIONS_EXCEPT_SPECIFIED</code> are used, Security Hub will automatically aggregate findings from new Regions as Security Hub supports them and you opt into them.</li>
<li><code>specified_regions</code> - (Optional) List of regions to include or exclude (required if <code>linking_mode</code> is set to <code>ALL_REGIONS_EXCEPT_SPECIFIED</code> or <code>SPECIFIED_REGIONS</code>)</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attribute%20Reference"></a><h2 id="attribute-reference">Attribute Reference</h2>

<p>This resource exports the following attributes in addition to the arguments above:</p>

<ul>
<li><code>arn</code> - Amazon Resource Name (ARN) of the Security Hub finding aggregator.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import an existing Security Hub finding aggregator using the <code>arn</code>. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_securityhub_finding_aggregator.example</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"arn:aws:securityhub:eu-west-1:123456789098:finding-aggregator/abcd1234-abcd-1234-1234-abcdef123456"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Using <code>terraform import</code>, import an existing Security Hub finding aggregator using the <code>arn</code>. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">% </span>terraform import aws_securityhub_finding_aggregator.example arn:aws:securityhub:eu-west-1:123456789098:finding-aggregator/abcd1234-abcd-1234-1234-abcdef123456
</code></pre></div>

            
        
    </body></html>