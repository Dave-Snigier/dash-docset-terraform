<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/amplify_branch --><head>
                <title>aws_amplify_branch</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="resource-aws_amplify_branch">Resource: aws_amplify_branch</h1>

<p>Provides an Amplify Branch resource.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_amplify_app"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"app"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_amplify_branch"</span><span class="w"> </span><span class="nv">"master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">app_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_amplify_app.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">branch_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"master"</span><span class="w"></span>

<span class="w">  </span><span class="na">framework</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"React"</span><span class="w"></span>
<span class="w">  </span><span class="na">stage</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"PRODUCTION"</span><span class="w"></span>

<span class="w">  </span><span class="nb">environment_variables</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">REACT_APP_API_SERVER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://api.example.com"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Basic%20Authentication"></a><h3 id="basic-authentication">Basic Authentication</h3>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_amplify_app"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"app"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_amplify_branch"</span><span class="w"> </span><span class="nv">"master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">app_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_amplify_app.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">branch_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"master"</span><span class="w"></span>

<span class="w">  </span><span class="na">enable_basic_auth</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">  </span><span class="na">basic_auth_credentials</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">base64encode</span><span class="p">(</span><span class="s2">"username:password"</span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Notifications"></a><h3 id="notifications">Notifications</h3>

<p>Amplify Console uses EventBridge (formerly known as CloudWatch Events) and SNS for email notifications.  To implement the same functionality, you need to set <code>enable_notification</code> in a <code>aws_amplify_branch</code> resource, as well as creating an EventBridge Rule, an SNS topic, and SNS subscriptions.</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_amplify_app"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"app"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_amplify_branch"</span><span class="w"> </span><span class="nv">"master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">app_id</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_amplify_app.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">branch_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"master"</span><span class="c1"></span>

<span class="c1">  # Enable SNS notifications.</span>
<span class="w">  </span><span class="na">enable_notification</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="c1"></span>

<span class="c1"># EventBridge Rule for Amplify notifications</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_cloudwatch_event_rule"</span><span class="w"> </span><span class="nv">"amplify_app_master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"amplify-${aws_amplify_app.app.id}-${aws_amplify_branch.master.branch_name}-branch-notification"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AWS Amplify build notifications for :  App: ${aws_amplify_app.app.id} Branch: ${aws_amplify_branch.master.branch_name}"</span><span class="w"></span>

<span class="w">  </span><span class="na">event_pattern</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsonencode</span><span class="p">({</span><span class="w"></span>
<span class="w">    </span><span class="s2">"detail"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="s2">"appId"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="nv">aws_amplify_app.example.id</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">      </span><span class="s2">"branchName"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="nv">aws_amplify_branch.master.branch_name</span><span class="w"></span>
<span class="w">      </span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="s2">"jobStatus"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">"SUCCEED"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"FAILED"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"STARTED"</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="s2">"detail-type"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Amplify Deployment Status Change"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="s2">"source"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"aws.amplify"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">})</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_cloudwatch_event_target"</span><span class="w"> </span><span class="nv">"amplify_app_master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">rule</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_cloudwatch_event_rule.amplify_app_master.name</span><span class="w"></span>
<span class="w">  </span><span class="na">target_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_amplify_branch.master.branch_name</span><span class="w"></span>
<span class="w">  </span><span class="na">arn</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_sns_topic.amplify_app_master.arn</span><span class="w"></span>

<span class="w">  </span><span class="nb">input_transformer</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">input_paths</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">jobId</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"$.detail.jobId"</span><span class="w"></span>
<span class="w">      </span><span class="na">appId</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"$.detail.appId"</span><span class="w"></span>
<span class="w">      </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$.region"</span><span class="w"></span>
<span class="w">      </span><span class="na">branch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$.detail.branchName"</span><span class="w"></span>
<span class="w">      </span><span class="na">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$.detail.jobStatus"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="na">input_template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"\"Build notification from the AWS Amplify Console for app: https://&lt;branch&gt;.&lt;appId&gt;.amplifyapp.com/. Your build status is &lt;status&gt;. Go to https://console.aws.amazon.com/amplify/home?region=&lt;region&gt;#&lt;appId&gt;/&lt;branch&gt;/&lt;jobId&gt; to view details on your build. \""</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="c1"></span>

<span class="c1"># SNS Topic for Amplify notifications</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sns_topic"</span><span class="w"> </span><span class="nv">"amplify_app_master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"amplify-${aws_amplify_app.app.id}_${aws_amplify_branch.master.branch_name}"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"aws_iam_policy_document"</span><span class="w"> </span><span class="nv">"amplify_app_master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">statement</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">sid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Allow_Publish_Events ${aws_amplify_branch.master.arn}"</span><span class="w"></span>

<span class="w">    </span><span class="na">effect</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Allow"</span><span class="w"></span>

<span class="w">    </span><span class="na">actions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"SNS:Publish"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>

<span class="w">    </span><span class="nb">principals</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Service"</span><span class="w"></span>
<span class="w">      </span><span class="na">identifiers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">"events.amazonaws.com"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="na">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="nv">aws_sns_topic.amplify_app_master.arn</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sns_topic_policy"</span><span class="w"> </span><span class="nv">"amplify_app_master"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">arn</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_sns_topic.amplify_app_master.arn</span><span class="w"></span>
<span class="w">  </span><span class="na">policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.aws_iam_policy_document.amplify_app_master.json</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sns_topic_subscription"</span><span class="w"> </span><span class="nv">"this"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">topic_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_sns_topic.amplify_app_master.arn</span><span class="w"></span>
<span class="w">  </span><span class="na">protocol</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"email"</span><span class="w"></span>
<span class="w">  </span><span class="na">endpoint</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"user@acme.com"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>This resource supports the following arguments:</p>

<ul>
<li><code>app_id</code> - (Required) Unique ID for an Amplify app.</li>
<li><code>branch_name</code> - (Required) Name for the branch.</li>
<li><code>backend_environment_arn</code> - (Optional) ARN for a backend environment that is part of an Amplify app.</li>
<li><code>basic_auth_credentials</code> - (Optional) Basic authorization credentials for the branch.</li>
<li><code>description</code> - (Optional) Description for the branch.</li>
<li><code>display_name</code> - (Optional) Display name for a branch. This is used as the default domain prefix.</li>
<li><code>enable_auto_build</code> - (Optional) Enables auto building for the branch.</li>
<li><code>enable_basic_auth</code> - (Optional) Enables basic authorization for the branch.</li>
<li><code>enable_notification</code> - (Optional) Enables notifications for the branch.</li>
<li><code>enable_performance_mode</code> - (Optional) Enables performance mode for the branch.</li>
<li><code>enable_pull_request_preview</code> - (Optional) Enables pull request previews for this branch.</li>
<li><code>environment_variables</code> - (Optional) Environment variables for the branch.</li>
<li><code>framework</code> - (Optional) Framework for the branch.</li>
<li><code>pull_request_environment_name</code> - (Optional) Amplify environment name for the pull request.</li>
<li><code>stage</code> - (Optional) Describes the current stage for the branch. Valid values: <code>PRODUCTION</code>, <code>BETA</code>, <code>DEVELOPMENT</code>, <code>EXPERIMENTAL</code>, <code>PULL_REQUEST</code>.</li>
<li><code>tags</code> - (Optional) Key-value mapping of resource tags. If configured with a provider <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block"><code>default_tags</code> configuration block</a> present, tags with matching keys will overwrite those defined at the provider-level.</li>
<li><code>ttl</code> - (Optional) Content Time To Live (TTL) for the website in seconds.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attribute%20Reference"></a><h2 id="attribute-reference">Attribute Reference</h2>

<p>This resource exports the following attributes in addition to the arguments above:</p>

<ul>
<li><code>arn</code> - ARN for the branch.</li>
<li><code>associated_resources</code> - A list of custom resources that are linked to this branch.</li>
<li><code>custom_domains</code> - Custom domains for the branch.</li>
<li><code>destination_branch</code> - Destination branch if the branch is a pull request branch.</li>
<li><code>source_branch</code> - Source branch if the branch is a pull request branch.</li>
<li><code>tags_all</code> - Map of tags assigned to the resource, including those inherited from the provider <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block"><code>default_tags</code> configuration block</a>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import Amplify branch using <code>app_id</code> and <code>branch_name</code>. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_amplify_branch.master</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"d2ypk4k47z8u6/master"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Using <code>terraform import</code>, import Amplify branch using <code>app_id</code> and <code>branch_name</code>. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">% </span>terraform import aws_amplify_branch.master d2ypk4k47z8u6/master
</code></pre></div>

            
        
    </body></html>