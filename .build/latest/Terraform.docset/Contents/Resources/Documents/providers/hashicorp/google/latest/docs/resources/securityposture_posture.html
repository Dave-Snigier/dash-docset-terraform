<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/securityposture_posture --><head>
                <title>google_securityposture_posture</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="google_securityposture_posture">google_securityposture_posture</h1>

<p>A Posture represents a collection of policy set including its name, state, description
and policy sets. A policy set includes set of policies along with their definition.
A posture can be created at the organization level.
Every update to a deployed posture creates a new posture revision with an updated revision_id.</p>

<p>To get more information about Posture, see:</p>

<ul>
<li><a href="https://cloud.google.com/security-command-center/docs/reference/securityposture/rest/v1/Posture">API documentation</a></li>
<li>How-to Guides
<ul>
<li><a href="https://cloud.google.com/security-command-center/docs/how-to-use-security-posture">Create and deploy a posture</a></li>
</ul></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Securityposture%20Posture%20Basic"></a><h2 id="example-usage-securityposture-posture-basic">Example Usage - Securityposture Posture Basic</h2>

<div class="codehilite"><pre><span></span><code><span class="err">resource</span><span class="w"> </span><span class="s2">"google_securityposture_posture" "posture1"</span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">posture_id</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"posture_example"</span><span class="w"></span>
<span class="w">  </span><span class="na">parent</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"organizations/123456789"</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"global"</span><span class="w"></span>
<span class="w">  </span><span class="na">state</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"ACTIVE"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"a new posture"</span><span class="w"></span>
<span class="w">  </span><span class="nb">policy_sets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">policy_set_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"org_policy_set"</span><span class="w"></span>
<span class="w">    </span><span class="na">description</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"set of org policies"</span><span class="w"></span>
<span class="w">    </span><span class="nb">policies</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">policy_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"canned_org_policy"</span><span class="w"></span>
<span class="w">      </span><span class="nb">constraint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nb">org_policy_constraint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="na">canned_constraint_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"storage.uniformBucketLevelAccess"</span><span class="w"></span>
<span class="w">          </span><span class="nb">policy_rules</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="na">enforce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">            </span><span class="nb">condition</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"condition description"</span><span class="w"></span>
<span class="w">                </span><span class="na">expression</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.matchTag('org_id/tag_key_short_name,'tag_value_short_name')"</span><span class="w"></span>
<span class="w">                </span><span class="na">title</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"a CEL condition"</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">policies</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">policy_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"custom_org_policy"</span><span class="w"></span>
<span class="w">      </span><span class="nb">constraint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nb">org_policy_constraint_custom</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="nb">custom_constraint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="na">name</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">"organizations/123456789/customConstraints/custom.disableGkeAutoUpgrade"</span><span class="w"></span>
<span class="w">            </span><span class="na">display_name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"Disable GKE auto upgrade"</span><span class="w"></span>
<span class="w">            </span><span class="na">description</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"Only allow GKE NodePool resource to be created or updated if AutoUpgrade is not enabled where this custom constraint is enforced."</span><span class="w"></span>
<span class="w">            </span><span class="na">action_type</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"ALLOW"</span><span class="w"></span>
<span class="w">            </span><span class="na">condition</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.management.autoUpgrade == false"</span><span class="w"></span>
<span class="w">            </span><span class="na">method_types</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"CREATE", "UPDATE"</span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="na">resource_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"container.googleapis.com/NodePool"</span><span class="p">]</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">          </span><span class="nb">policy_rules</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="na">enforce</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">            </span><span class="nb">condition</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"condition description"</span><span class="w"></span>
<span class="w">                </span><span class="na">expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.matchTagId('tagKeys/key_id','tagValues/value_id')"</span><span class="w"></span>
<span class="w">                </span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"a CEL condition"</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">policy_sets</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">policy_set_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sha_policy_set"</span><span class="w"></span>
<span class="w">    </span><span class="na">description</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"set of sha policies"</span><span class="w"></span>
<span class="w">    </span><span class="nb">policies</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">policy_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sha_builtin_module"</span><span class="w"></span>
<span class="w">      </span><span class="nb">constraint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nb">security_health_analytics_module</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="na">module_name</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="s2">"BIGQUERY_TABLE_CMEK_DISABLED"</span><span class="w"></span>
<span class="w">          </span><span class="na">module_enablement_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"enable BIGQUERY_TABLE_CMEK_DISABLED"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">policies</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">policy_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"sha_custom_module"</span><span class="w"></span>
<span class="w">      </span><span class="nb">constraint</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="nb">security_health_analytics_custom_module</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="na">display_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"custom_SHA_policy"</span><span class="w"></span>
<span class="w">          </span><span class="nb">config</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="nb">predicate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="na">expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.rotationPeriod &gt; duration('2592000s')"</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="nb">custom_output</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="nb">properties</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"duration"</span><span class="w"></span>
<span class="w">                </span><span class="nb">value_expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">                  </span><span class="na">expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.rotationPeriod"</span><span class="w"></span>
<span class="w">                </span><span class="p">}</span><span class="w"></span>
<span class="w">              </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="nb">resource_selector</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">              </span><span class="na">resource_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"cloudkms.googleapis.com/CryptoKey"</span><span class="p">]</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">severity</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"LOW"</span><span class="w"></span>
<span class="w">            </span><span class="na">description</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"Custom Module"</span><span class="w"></span>
<span class="w">            </span><span class="na">recommendation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Testing custom modules"</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">          </span><span class="na">module_enablement_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>state</code> -
(Required)
State of the posture. Update to state field should not be triggered along with
with other field updates.
Possible values are: <code>DEPRECATED</code>, <code>DRAFT</code>, <code>ACTIVE</code>.</p></li>
<li><p><code>policy_sets</code> -
(Required)
List of policy sets for the posture.
Structure is <a href="#nested_policy_sets">documented below</a>.</p></li>
<li><p><code>parent</code> -
(Required)
The parent of the resource, an organization. Format should be <code>organizations/{organization_id}</code>.</p></li>
<li><p><code>location</code> -
(Required)
Location of the resource, eg: global.</p></li>
<li><p><code>posture_id</code> -
(Required)
Id of the posture. It is an immutable field.</p></li>
</ul>

<p><a name="nested_policy_sets"></a>The <code>policy_sets</code> block supports:</p>

<ul>
<li><p><code>policy_set_id</code> -
(Required)
ID of the policy set.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the policy set.</p></li>
<li><p><code>policies</code> -
(Required)
List of security policy
Structure is <a href="#nested_policy_sets_policy_sets_policies">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies"></a>The <code>policies</code> block supports:</p>

<ul>
<li><p><code>policy_id</code> -
(Required)
ID of the policy.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the policy.</p></li>
<li><p><code>compliance_standards</code> -
(Optional)
Mapping for policy to security standards and controls.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_compliance_standards">documented below</a>.</p></li>
<li><p><code>constraint</code> -
(Required)
Policy constraint definition.It can have the definition of one of following constraints: orgPolicyConstraint orgPolicyConstraintCustom securityHealthAnalyticsModule securityHealthAnalyticsCustomModule
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_compliance_standards"></a>The <code>compliance_standards</code> block supports:</p>

<ul>
<li><p><code>standard</code> -
(Optional)
Mapping of compliance standards for the policy.</p></li>
<li><p><code>control</code> -
(Optional)
Mapping of security controls for the policy.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint"></a>The <code>constraint</code> block supports:</p>

<ul>
<li><p><code>org_policy_constraint</code> -
(Optional)
Organization policy canned constraint definition.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint">documented below</a>.</p></li>
<li><p><code>org_policy_constraint_custom</code> -
(Optional)
Organization policy custom constraint policy definition.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom">documented below</a>.</p></li>
<li><p><code>security_health_analytics_module</code> -
(Optional)
Security Health Analytics built-in detector definition.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_module">documented below</a>.</p></li>
<li><p><code>security_health_analytics_custom_module</code> -
(Optional)
Definition of Security Health Analytics Custom Module.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint"></a>The <code>org_policy_constraint</code> block supports:</p>

<ul>
<li><p><code>canned_constraint_id</code> -
(Required)
Organization policy canned constraint Id</p></li>
<li><p><code>policy_rules</code> -
(Required)
Definition of policy rules
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_policy_rules">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_policy_rules"></a>The <code>policy_rules</code> block supports:</p>

<ul>
<li><p><code>values</code> -
(Optional)
List of values to be used for this policy rule. This field can be set only in policies for list constraints.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_policy_rules_policy_rules_values">documented below</a>.</p></li>
<li><p><code>allow_all</code> -
(Optional)
Setting this to true means that all values are allowed. This field can be set only in policies for list constraints.</p></li>
<li><p><code>deny_all</code> -
(Optional)
Setting this to true means that all values are denied. This field can be set only in policies for list constraints.</p></li>
<li><p><code>enforce</code> -
(Optional)
If <code>true</code>, then the policy is enforced. If <code>false</code>, then any configuration is acceptable.
This field can be set only in policies for boolean constraints.</p></li>
<li><p><code>condition</code> -
(Optional)
Represents a textual expression in the Common Expression Language (CEL) syntax. CEL is a C-like expression language.
This page details the objects and attributes that are used to the build the CEL expressions for
custom access levels - https://cloud.google.com/access-context-manager/docs/custom-access-level-spec.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_policy_rules_policy_rules_condition">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_policy_rules_policy_rules_values"></a>The <code>values</code> block supports:</p>

<ul>
<li><p><code>allowed_values</code> -
(Optional)
List of values allowed at this resource.</p></li>
<li><p><code>denied_values</code> -
(Optional)
List of values denied at this resource.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_policy_rules_policy_rules_condition"></a>The <code>condition</code> block supports:</p>

<ul>
<li><p><code>expression</code> -
(Required)
Textual representation of an expression in Common Expression Language syntax.</p></li>
<li><p><code>title</code> -
(Optional)
Title for the expression, i.e. a short string describing its purpose.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the expression</p></li>
<li><p><code>location</code> -
(Optional)
String indicating the location of the expression for error reporting, e.g. a file name and a position in the file</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom"></a>The <code>org_policy_constraint_custom</code> block supports:</p>

<ul>
<li><p><code>custom_constraint</code> -
(Optional)
Organization policy custom constraint definition.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_custom_constraint">documented below</a>.</p></li>
<li><p><code>policy_rules</code> -
(Required)
Definition of policy rules
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_policy_rules">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_custom_constraint"></a>The <code>custom_constraint</code> block supports:</p>

<ul>
<li><p><code>name</code> -
(Required)
Immutable. The name of the custom constraint. This is unique within the organization.</p></li>
<li><p><code>display_name</code> -
(Optional)
A human-friendly name for the constraint.</p></li>
<li><p><code>description</code> -
(Optional)
A human-friendly description of the constraint to display as an error message when the policy is violated.</p></li>
<li><p><code>condition</code> -
(Required)
A CEL condition that refers to a supported service resource, for example <code>resource.management.autoUpgrade == false</code>. For details about CEL usage, see <a href="https://cloud.google.com/resource-manager/docs/organization-policy/creating-managing-custom-constraints#common_expression_language">Common Expression Language</a>.</p></li>
<li><p><code>action_type</code> -
(Required)
The action to take if the condition is met.
Possible values are: <code>ALLOW</code>, <code>DENY</code>.</p></li>
<li><p><code>method_types</code> -
(Required)
A list of RESTful methods for which to enforce the constraint. Can be <code>CREATE</code>, <code>UPDATE</code>, or both. Not all Google Cloud services support both methods. To see supported methods for each service, find the service in <a href="https://cloud.google.com/resource-manager/docs/organization-policy/custom-constraint-supported-services">Supported services</a>.</p></li>
<li><p><code>resource_types</code> -
(Required)
Immutable. The fully qualified name of the Google Cloud REST resource containing the object and field you want to restrict. For example, <code>container.googleapis.com/NodePool</code>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_policy_rules"></a>The <code>policy_rules</code> block supports:</p>

<ul>
<li><p><code>values</code> -
(Optional)
List of values to be used for this policy rule. This field can be set only in policies for list constraints.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_policy_rules_policy_rules_values">documented below</a>.</p></li>
<li><p><code>allow_all</code> -
(Optional)
Setting this to true means that all values are allowed. This field can be set only in policies for list constraints.</p></li>
<li><p><code>deny_all</code> -
(Optional)
Setting this to true means that all values are denied. This field can be set only in policies for list constraints.</p></li>
<li><p><code>enforce</code> -
(Optional)
If <code>true</code>, then the policy is enforced. If <code>false</code>, then any configuration is acceptable.
This field can be set only in policies for boolean constraints.</p></li>
<li><p><code>condition</code> -
(Optional)
Represents a textual expression in the Common Expression Language (CEL) syntax. CEL is a C-like expression language.
This page details the objects and attributes that are used to the build the CEL expressions for
custom access levels - https://cloud.google.com/access-context-manager/docs/custom-access-level-spec.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_policy_rules_policy_rules_condition">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_policy_rules_policy_rules_values"></a>The <code>values</code> block supports:</p>

<ul>
<li><p><code>allowed_values</code> -
(Optional)
List of values allowed at this resource.</p></li>
<li><p><code>denied_values</code> -
(Optional)
List of values denied at this resource.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_org_policy_constraint_custom_policy_rules_policy_rules_condition"></a>The <code>condition</code> block supports:</p>

<ul>
<li><p><code>expression</code> -
(Required)
Textual representation of an expression in Common Expression Language syntax.</p></li>
<li><p><code>title</code> -
(Optional)
Title for the expression, i.e. a short string describing its purpose.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the expression</p></li>
<li><p><code>location</code> -
(Optional)
String indicating the location of the expression for error reporting, e.g. a file name and a position in the file</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_module"></a>The <code>security_health_analytics_module</code> block supports:</p>

<ul>
<li><p><code>module_name</code> -
(Required)
The name of the module eg: BIGQUERY_TABLE_CMEK_DISABLED.</p></li>
<li><p><code>module_enablement_state</code> -
(Optional)
The state of enablement for the module at its level of the resource hierarchy.
Possible values are: <code>ENABLEMENT_STATE_UNSPECIFIED</code>, <code>ENABLED</code>, <code>DISABLED</code>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module"></a>The <code>security_health_analytics_custom_module</code> block supports:</p>

<ul>
<li><p><code>id</code> -
(Output)
A server generated id of custom module.</p></li>
<li><p><code>display_name</code> -
(Optional)
The display name of the Security Health Analytics custom module. This
display name becomes the finding category for all findings that are
returned by this custom module.</p></li>
<li><p><code>module_enablement_state</code> -
(Optional)
The state of enablement for the module at its level of the resource hierarchy.
Possible values are: <code>ENABLEMENT_STATE_UNSPECIFIED</code>, <code>ENABLED</code>, <code>DISABLED</code>.</p></li>
<li><p><code>config</code> -
(Required)
Custom module details.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config"></a>The <code>config</code> block supports:</p>

<ul>
<li><p><code>predicate</code> -
(Required)
The CEL expression to evaluate to produce findings.When the expression
evaluates to true against a resource, a finding is generated.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_predicate">documented below</a>.</p></li>
<li><p><code>custom_output</code> -
(Optional)
Custom output properties. A set of optional name-value pairs that define custom source properties to
return with each finding that is generated by the custom module. The custom
source properties that are defined here are included in the finding JSON
under <code>sourceProperties</code>.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_custom_output">documented below</a>.</p></li>
<li><p><code>resource_selector</code> -
(Required)
The resource types that the custom module operates on. Each custom module
can specify up to 5 resource types.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_resource_selector">documented below</a>.</p></li>
<li><p><code>severity</code> -
(Required)
The severity to assign to findings generated by the module.
Possible values are: <code>SEVERITY_UNSPECIFIED</code>, <code>CRITICAL</code>, <code>HIGH</code>, <code>MEDIUM</code>, <code>LOW</code>.</p></li>
<li><p><code>description</code> -
(Optional)
Text that describes the vulnerability or misconfiguration that the custom
module detects.</p></li>
<li><p><code>recommendation</code> -
(Optional)
An explanation of the recommended steps that security teams can take to
resolve the detected issue</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_predicate"></a>The <code>predicate</code> block supports:</p>

<ul>
<li><p><code>expression</code> -
(Required)
Textual representation of an expression in Common Expression Language syntax.</p></li>
<li><p><code>title</code> -
(Optional)
Title for the expression, i.e. a short string describing its purpose.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the expression</p></li>
<li><p><code>location</code> -
(Optional)
String indicating the location of the expression for error reporting, e.g. a file name and a position in the file</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_custom_output"></a>The <code>custom_output</code> block supports:</p>

<ul>
<li><code>properties</code> -
(Optional)
A list of custom output properties to add to the finding.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_custom_output_properties">documented below</a>.</li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_custom_output_properties"></a>The <code>properties</code> block supports:</p>

<ul>
<li><p><code>name</code> -
(Required)
Name of the property for the custom output.</p></li>
<li><p><code>value_expression</code> -
(Optional)
The CEL expression for the custom output. A resource property can be
specified to return the value of the property or a text string enclosed
in quotation marks.
Structure is <a href="#nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_custom_output_properties_properties_value_expression">documented below</a>.</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_custom_output_properties_properties_value_expression"></a>The <code>value_expression</code> block supports:</p>

<ul>
<li><p><code>expression</code> -
(Required)
Textual representation of an expression in Common Expression Language syntax.</p></li>
<li><p><code>title</code> -
(Optional)
Title for the expression, i.e. a short string describing its purpose.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the expression</p></li>
<li><p><code>location</code> -
(Optional)
String indicating the location of the expression for error reporting, e.g. a file name and a position in the file</p></li>
</ul>

<p><a name="nested_policy_sets_policy_sets_policies_policies_constraint_security_health_analytics_custom_module_config_resource_selector"></a>The <code>resource_selector</code> block supports:</p>

<ul>
<li><code>resource_types</code> -
(Required)
The resource types to run the detector on.</li>
</ul>

<hr/>

<ul>
<li><code>description</code> -
(Optional)
Description of the posture.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the arguments listed above, the following computed attributes are exported:</p>

<ul>
<li><p><code>id</code> - an identifier for the resource with format <code>{{parent}}/locations/{{location}}/postures/{{posture_id}}</code></p></li>
<li><p><code>name</code> -
Name of the posture.</p></li>
<li><p><code>revision_id</code> -
Revision_id of the posture.</p></li>
<li><p><code>create_time</code> -
Time the Posture was created in UTC.</p></li>
<li><p><code>update_time</code> -
Time the Posture was updated in UTC.</p></li>
<li><p><code>etag</code> -
For Resource freshness validation (https://google.aip.dev/154)</p></li>
<li><p><code>reconciling</code> -
If set, there are currently changes in flight to the posture.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>This resource provides the following
<a href="https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts">Timeouts</a> configuration options:</p>

<ul>
<li><code>create</code> - Default is 20 minutes.</li>
<li><code>update</code> - Default is 20 minutes.</li>
<li><code>delete</code> - Default is 20 minutes.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>Posture can be imported using any of these accepted formats:</p>

<ul>
<li><code>{{parent}}/locations/{{location}}/postures/{{posture_id}}</code></li>
</ul>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import Posture using one of the formats above. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"{{parent}}/locations/{{location}}/postures/{{posture_id}}"</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_securityposture_posture.default</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>When using the <a href="https://developer.hashicorp.com/terraform/cli/commands/import"><code>terraform import</code> command</a>, Posture can be imported using one of the formats above. For example:</p>

<pre><code>$ terraform import google_securityposture_posture.default {{parent}}/locations/{{location}}/postures/{{posture_id}}
</code></pre>

            
        
    </body></html>