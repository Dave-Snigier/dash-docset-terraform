<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/compute_router_nat --><head>
                <title>google_compute_router_nat</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="google_compute_router_nat">google_compute_router_nat</h1>

<p>A NAT service created in a router.</p>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>Recreating a <code>google_compute_address</code> that is being used by <code>google_compute_router_nat</code> will give a <code>resourceInUseByAnotherResource</code> error. Use <code>lifecycle.create_before_destroy</code> on this address resource to avoid this type of error as shown in the Manual Ips example.</p>
</aside>

<p>To get more information about RouterNat, see:</p>

<ul>
<li><a href="https://cloud.google.com/compute/docs/reference/rest/v1/routers">API documentation</a></li>
<li>How-to Guides
<ul>
<li><a href="https://cloud.google.com/router/docs/">Google Cloud Router</a></li>
</ul></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Router%20Nat%20Basic"></a><h2 id="example-usage-router-nat-basic">Example Usage - Router Nat Basic</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"net"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-network"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-subnetwork"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.0/16"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router"</span><span class="w"> </span><span class="nv">"router"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>

<span class="w">  </span><span class="nb">bgp</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">asn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">64514</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router_nat"</span><span class="w"> </span><span class="nv">"nat"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                               </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router-nat"</span><span class="w"></span>
<span class="w">  </span><span class="na">router</span><span class="w">                             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.name</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.region</span><span class="w"></span>
<span class="w">  </span><span class="na">nat_ip_allocate_option</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="s2">"AUTO_ONLY"</span><span class="w"></span>
<span class="w">  </span><span class="na">source_subnetwork_ip_ranges_to_nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ALL_SUBNETWORKS_ALL_IP_RANGES"</span><span class="w"></span>

<span class="w">  </span><span class="nb">log_config</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">enable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">    </span><span class="na">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ERRORS_ONLY"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Router%20Nat%20Manual%20Ips"></a><h2 id="example-usage-router-nat-manual-ips">Example Usage - Router Nat Manual Ips</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"net"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-network"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-subnetwork"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.0/16"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router"</span><span class="w"> </span><span class="nv">"router"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"address"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">count</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"nat-manual-ip-${count.index}"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>

<span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">create_before_destroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router_nat"</span><span class="w"> </span><span class="nv">"nat_manual"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router-nat"</span><span class="w"></span>
<span class="w">  </span><span class="na">router</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.name</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.region</span><span class="w"></span>

<span class="w">  </span><span class="na">nat_ip_allocate_option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MANUAL_ONLY"</span><span class="w"></span>
<span class="w">  </span><span class="na">nat_ips</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.address</span><span class="p">.</span><span class="err">*</span><span class="p">.</span><span class="err">self_link</span><span class="w"></span>

<span class="w">  </span><span class="na">source_subnetwork_ip_ranges_to_nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LIST_OF_SUBNETWORKS"</span><span class="w"></span>
<span class="w">  </span><span class="nb">subnetwork</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.id</span><span class="w"></span>
<span class="w">    </span><span class="na">source_ip_ranges_to_nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"ALL_IP_RANGES"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Router%20Nat%20Rules"></a><h2 id="example-usage-router-nat-rules">Example Usage - Router Nat Rules</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"net"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-network"</span><span class="w"></span>
<span class="w">  </span><span class="na">auto_create_subnetworks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-subnetwork"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.0/16"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router"</span><span class="w"> </span><span class="nv">"router"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"addr1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"nat-address1"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"addr2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"nat-address2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"addr3"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"nat-address3"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router_nat"</span><span class="w"> </span><span class="nv">"nat_rules"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router-nat"</span><span class="w"></span>
<span class="w">  </span><span class="na">router</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.name</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.region</span><span class="w"></span>

<span class="w">  </span><span class="na">nat_ip_allocate_option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MANUAL_ONLY"</span><span class="w"></span>
<span class="w">  </span><span class="na">nat_ips</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">google_compute_address.addr1.self_link</span><span class="p">]</span><span class="w"></span>

<span class="w">  </span><span class="na">source_subnetwork_ip_ranges_to_nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LIST_OF_SUBNETWORKS"</span><span class="w"></span>
<span class="w">  </span><span class="nb">subnetwork</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.id</span><span class="w"></span>
<span class="w">    </span><span class="na">source_ip_ranges_to_nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"ALL_IP_RANGES"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">rules</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">rule_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="w"></span>
<span class="w">    </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"nat rules example"</span><span class="w"></span>
<span class="w">    </span><span class="na">match</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"inIpRange(destination.ip, '1.1.0.0/16') || inIpRange(destination.ip, '2.2.0.0/16')"</span><span class="w"></span>
<span class="w">    </span><span class="nb">action</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">source_nat_active_ips</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">google_compute_address.addr2.self_link</span><span class="p">,</span><span class="w"> </span><span class="nv">google_compute_address.addr3.self_link</span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="na">enable_endpoint_independent_mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Router%20Nat%20Private"></a><h2 id="example-usage-router-nat-private">Example Usage - Router Nat Private</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"net"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>

<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-network"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>

<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-subnetwork"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.0/16"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"PRIVATE_NAT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router"</span><span class="w"> </span><span class="nv">"router"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>

<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.region</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_network_connectivity_hub"</span><span class="w"> </span><span class="nv">"hub"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>

<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-hub"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vpc hub for inter vpc nat"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_network_connectivity_spoke"</span><span class="w"> </span><span class="nv">"spoke"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>

<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-spoke"</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"global"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"vpc spoke for inter vpc nat"</span><span class="w"></span>
<span class="w">  </span><span class="na">hub</span><span class="w">         </span><span class="o">=</span><span class="w">  </span><span class="nv">google_network_connectivity_hub.hub.id</span><span class="w"></span>
<span class="w">  </span><span class="nb">linked_vpc_network</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">exclude_export_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">      </span><span class="s2">"198.51.100.0/24"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"10.10.0.0/16"</span><span class="w"></span>
<span class="w">    </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="na">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.net.self_link</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_router_nat"</span><span class="w"> </span><span class="nv">"nat_type"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w">                            </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>

<span class="w">  </span><span class="na">name</span><span class="w">                                </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-router-nat"</span><span class="w"></span>
<span class="w">  </span><span class="na">router</span><span class="w">                              </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.name</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                              </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router.router.region</span><span class="w"></span>
<span class="w">  </span><span class="na">source_subnetwork_ip_ranges_to_nat</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"LIST_OF_SUBNETWORKS"</span><span class="w"></span>
<span class="w">  </span><span class="na">enable_dynamic_port_allocation</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="w">  </span><span class="na">enable_endpoint_independent_mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="w">  </span><span class="na">min_ports_per_vm</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="m">32</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">                                </span><span class="o">=</span><span class="w"> </span><span class="s2">"PRIVATE"</span><span class="w"></span>
<span class="w">  </span><span class="nb">subnetwork</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet.id</span><span class="w"></span>
<span class="w">    </span><span class="na">source_ip_ranges_to_nat</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"ALL_IP_RANGES"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">rules</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">rule_number</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">100</span><span class="w"></span>
<span class="w">    </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rule for private nat"</span><span class="w"></span>
<span class="w">    </span><span class="na">match</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"nexthop.hub == \"//networkconnectivity.googleapis.com/projects/acm-test-proj-123/locations/global/hubs/my-hub\""</span><span class="w"></span>
<span class="w">    </span><span class="nb">action</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">source_nat_active_ranges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="nv">google_compute_subnetwork.subnet.self_link</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>name</code> -
(Required)
Name of the NAT service. The name must be 1-63 characters long and
comply with RFC1035.</p></li>
<li><p><code>source_subnetwork_ip_ranges_to_nat</code> -
(Required)
How NAT should be configured per Subnetwork.
If <code>ALL_SUBNETWORKS_ALL_IP_RANGES</code>, all of the
IP ranges in every Subnetwork are allowed to Nat.
If <code>ALL_SUBNETWORKS_ALL_PRIMARY_IP_RANGES</code>, all of the primary IP
ranges in every Subnetwork are allowed to Nat.
<code>LIST_OF_SUBNETWORKS</code>: A list of Subnetworks are allowed to Nat
(specified in the field subnetwork below). Note that if this field
contains ALL_SUBNETWORKS_ALL_IP_RANGES or
ALL_SUBNETWORKS_ALL_PRIMARY_IP_RANGES, then there should not be any
other RouterNat section in any Router for this network in this region.
Possible values are: <code>ALL_SUBNETWORKS_ALL_IP_RANGES</code>, <code>ALL_SUBNETWORKS_ALL_PRIMARY_IP_RANGES</code>, <code>LIST_OF_SUBNETWORKS</code>.</p></li>
<li><p><code>router</code> -
(Required)
The name of the Cloud Router in which this NAT will be configured.</p></li>
</ul>

<hr/>

<ul>
<li><p><code>nat_ip_allocate_option</code> -
(Optional)
How external IPs should be allocated for this NAT. Valid values are
<code>AUTO_ONLY</code> for only allowing NAT IPs allocated by Google Cloud
Platform, or <code>MANUAL_ONLY</code> for only user-allocated NAT IP addresses.
Possible values are: <code>MANUAL_ONLY</code>, <code>AUTO_ONLY</code>.</p></li>
<li><p><code>initial_nat_ips</code> -
(Optional)
Self-links of NAT IPs to be used as initial value for creation alongside a RouterNatAddress resource.
Conflicts with natIps and drainNatIps. Only valid if natIpAllocateOption is set to MANUAL_ONLY.</p></li>
<li><p><code>nat_ips</code> -
(Optional)
Self-links of NAT IPs. Only valid if natIpAllocateOption
is set to MANUAL_ONLY.
If this field is used alongside with a count created list of address resources <code>google_compute_address.foobar.*.self_link</code>,
the access level resource for the address resource must have a <code>lifecycle</code> block with <code>create_before_destroy = true</code> so
the number of resources can be increased/decreased without triggering the <code>resourceInUseByAnotherResource</code> error.</p></li>
<li><p><code>drain_nat_ips</code> -
(Optional)
A list of URLs of the IP resources to be drained. These IPs must be
valid static external IPs that have been assigned to the NAT.</p></li>
<li><p><code>subnetwork</code> -
(Optional)
One or more subnetwork NAT configurations. Only used if
<code>source_subnetwork_ip_ranges_to_nat</code> is set to <code>LIST_OF_SUBNETWORKS</code>
Structure is <a href="#nested_subnetwork">documented below</a>.</p></li>
<li><p><code>min_ports_per_vm</code> -
(Optional)
Minimum number of ports allocated to a VM from this NAT. Defaults to 64 for static port allocation and 32 dynamic port allocation if not set.</p></li>
<li><p><code>max_ports_per_vm</code> -
(Optional)
Maximum number of ports allocated to a VM from this NAT.
This field can only be set when enableDynamicPortAllocation is enabled.</p></li>
<li><p><code>enable_dynamic_port_allocation</code> -
(Optional)
Enable Dynamic Port Allocation.
If minPortsPerVm is set, minPortsPerVm must be set to a power of two greater than or equal to 32.
If minPortsPerVm is not set, a minimum of 32 ports will be allocated to a VM from this NAT config.
If maxPortsPerVm is set, maxPortsPerVm must be set to a power of two greater than minPortsPerVm.
If maxPortsPerVm is not set, a maximum of 65536 ports will be allocated to a VM from this NAT config.
Mutually exclusive with enableEndpointIndependentMapping.</p></li>
<li><p><code>udp_idle_timeout_sec</code> -
(Optional)
Timeout (in seconds) for UDP connections. Defaults to 30s if not set.</p></li>
<li><p><code>icmp_idle_timeout_sec</code> -
(Optional)
Timeout (in seconds) for ICMP connections. Defaults to 30s if not set.</p></li>
<li><p><code>tcp_established_idle_timeout_sec</code> -
(Optional)
Timeout (in seconds) for TCP established connections.
Defaults to 1200s if not set.</p></li>
<li><p><code>tcp_transitory_idle_timeout_sec</code> -
(Optional)
Timeout (in seconds) for TCP transitory connections.
Defaults to 30s if not set.</p></li>
<li><p><code>tcp_time_wait_timeout_sec</code> -
(Optional)
Timeout (in seconds) for TCP connections that are in TIME_WAIT state.
Defaults to 120s if not set.</p></li>
<li><p><code>log_config</code> -
(Optional)
Configuration for logging on NAT
Structure is <a href="#nested_log_config">documented below</a>.</p></li>
<li><p><code>endpoint_types</code> -
(Optional)
Specifies the endpoint Types supported by the NAT Gateway.
Supported values include:
    <code>ENDPOINT_TYPE_VM</code>, <code>ENDPOINT_TYPE_SWG</code>,
    <code>ENDPOINT_TYPE_MANAGED_PROXY_LB</code>.</p></li>
<li><p><code>rules</code> -
(Optional)
A list of rules associated with this NAT.
Structure is <a href="#nested_rules">documented below</a>.</p></li>
<li><p><code>enable_endpoint_independent_mapping</code> -
(Optional)
Enable endpoint independent mapping.
For more information see the <a href="https://cloud.google.com/nat/docs/overview#specs-rfcs">official documentation</a>.</p></li>
<li><p><code>type</code> -
(Optional, <a href="https://terraform.io/docs/providers/google/guides/provider_versions.html">Beta</a>)
Indicates whether this NAT is used for public or private IP translation.
If unspecified, it defaults to PUBLIC.
If <code>PUBLIC</code> NAT used for public IP translation.
If <code>PRIVATE</code> NAT used for private IP translation.
Default value is <code>PUBLIC</code>.
Possible values are: <code>PUBLIC</code>, <code>PRIVATE</code>.</p></li>
<li><p><code>auto_network_tier</code> -
(Optional)
The network tier to use when automatically reserving NAT IP addresses.
Must be one of: PREMIUM, STANDARD. If not specified, then the current
project-level default tier is used.
Possible values are: <code>PREMIUM</code>, <code>STANDARD</code>.</p></li>
<li><p><code>region</code> -
(Optional)
Region where the router and NAT reside.</p></li>
<li><p><code>project</code> - (Optional) The ID of the project in which the resource belongs.
If it is not provided, the provider project is used.</p></li>
</ul>

<p><a name="nested_subnetwork"></a>The <code>subnetwork</code> block supports:</p>

<ul>
<li><p><code>name</code> -
(Required)
Self-link of subnetwork to NAT</p></li>
<li><p><code>source_ip_ranges_to_nat</code> -
(Required)
List of options for which source IPs in the subnetwork
should have NAT enabled. Supported values include:
<code>ALL_IP_RANGES</code>, <code>LIST_OF_SECONDARY_IP_RANGES</code>,
<code>PRIMARY_IP_RANGE</code>.</p></li>
<li><p><code>secondary_ip_range_names</code> -
(Optional)
List of the secondary ranges of the subnetwork that are allowed
to use NAT. This can be populated only if
<code>LIST_OF_SECONDARY_IP_RANGES</code> is one of the values in
sourceIpRangesToNat</p></li>
</ul>

<p><a name="nested_log_config"></a>The <code>log_config</code> block supports:</p>

<ul>
<li><p><code>enable</code> -
(Required)
Indicates whether or not to export logs.</p></li>
<li><p><code>filter</code> -
(Required)
Specifies the desired filtering of logs on this NAT.
Possible values are: <code>ERRORS_ONLY</code>, <code>TRANSLATIONS_ONLY</code>, <code>ALL</code>.</p></li>
</ul>

<p><a name="nested_rules"></a>The <code>rules</code> block supports:</p>

<ul>
<li><p><code>rule_number</code> -
(Required)
An integer uniquely identifying a rule in the list.
The rule number must be a positive value between 0 and 65000, and must be unique among rules within a NAT.</p></li>
<li><p><code>description</code> -
(Optional)
An optional description of this rule.</p></li>
<li><p><code>match</code> -
(Required)
CEL expression that specifies the match condition that egress traffic from a VM is evaluated against.
If it evaluates to true, the corresponding action is enforced.
The following examples are valid match expressions for public NAT:
"inIpRange(destination.ip, '1.1.0.0/16') || inIpRange(destination.ip, '2.2.0.0/16')"
"destination.ip == '1.1.0.1' || destination.ip == '8.8.8.8'"
The following example is a valid match expression for private NAT:
"nexthop.hub == 'https://networkconnectivity.googleapis.com/v1alpha1/projects/my-project/global/hub/hub-1'"</p></li>
<li><p><code>action</code> -
(Optional)
The action to be enforced for traffic that matches this rule.
Structure is <a href="#nested_rules_rules_action">documented below</a>.</p></li>
</ul>

<p><a name="nested_rules_rules_action"></a>The <code>action</code> block supports:</p>

<ul>
<li><p><code>source_nat_active_ips</code> -
(Optional)
A list of URLs of the IP resources used for this NAT rule.
These IP addresses must be valid static external IP addresses assigned to the project.
This field is used for public NAT.</p></li>
<li><p><code>source_nat_drain_ips</code> -
(Optional)
A list of URLs of the IP resources to be drained.
These IPs must be valid static external IPs that have been assigned to the NAT.
These IPs should be used for updating/patching a NAT rule only.
This field is used for public NAT.</p></li>
<li><p><code>source_nat_active_ranges</code> -
(Optional, <a href="https://terraform.io/docs/providers/google/guides/provider_versions.html">Beta</a>)
A list of URLs of the subnetworks used as source ranges for this NAT Rule.
These subnetworks must have purpose set to PRIVATE_NAT.
This field is used for private NAT.</p></li>
<li><p><code>source_nat_drain_ranges</code> -
(Optional, <a href="https://terraform.io/docs/providers/google/guides/provider_versions.html">Beta</a>)
A list of URLs of subnetworks representing source ranges to be drained.
This is only supported on patch/update, and these subnetworks must have previously been used as active ranges in this NAT Rule.
This field is used for private NAT.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the arguments listed above, the following computed attributes are exported:</p>

<ul>
<li><code>id</code> - an identifier for the resource with format <code>{{project}}/{{region}}/{{router}}/{{name}}</code></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>This resource provides the following
<a href="https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts">Timeouts</a> configuration options:</p>

<ul>
<li><code>create</code> - Default is 20 minutes.</li>
<li><code>update</code> - Default is 20 minutes.</li>
<li><code>delete</code> - Default is 20 minutes.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>RouterNat can be imported using any of these accepted formats:</p>

<ul>
<li><code>projects/{{project}}/regions/{{region}}/routers/{{router}}/{{name}}</code></li>
<li><code>{{project}}/{{region}}/{{router}}/{{name}}</code></li>
<li><code>{{region}}/{{router}}/{{name}}</code></li>
<li><code>{{router}}/{{name}}</code></li>
</ul>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import RouterNat using one of the formats above. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projects/{{project}}/regions/{{region}}/routers/{{router}}/{{name}}"</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_router_nat.default</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>When using the <a href="https://developer.hashicorp.com/terraform/cli/commands/import"><code>terraform import</code> command</a>, RouterNat can be imported using one of the formats above. For example:</p>

<pre><code>$ terraform import google_compute_router_nat.default projects/{{project}}/regions/{{region}}/routers/{{router}}/{{name}}
$ terraform import google_compute_router_nat.default {{project}}/{{region}}/{{router}}/{{name}}
$ terraform import google_compute_router_nat.default {{region}}/{{router}}/{{name}}
$ terraform import google_compute_router_nat.default {{router}}/{{name}}
</code></pre>

<a class="dashAnchor" name="//apple_ref/cpp/Section/User%20Project%20Overrides"></a><h2 id="user-project-overrides">User Project Overrides</h2>

<p>This resource supports <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override">User Project Overrides</a>.</p>

            
        
    </body></html>