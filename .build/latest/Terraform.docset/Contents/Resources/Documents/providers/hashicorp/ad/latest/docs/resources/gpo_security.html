<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/ad/latest/docs/resources/gpo_security --><head>
                <title>ad_gpo_security</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="ad_gpo_security-resource">ad_gpo_security (Resource)</h1>

<p><code>ad_gpo_security</code> manages the security settings portion of a Group Policy Object (GPO).</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<div class="codehilite"><pre><span></span><code><span class="err">variable</span><span class="w"> </span><span class="nb">domain</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="na">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"yourdomain.com"</span><span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="err">variable</span><span class="w"> </span><span class="nb">gpo_name</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="na">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TestGPO"</span><span class="w"> </span><span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"ad_gpo"</span><span class="w"> </span><span class="nv">"gpo"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">var.gpo_name</span><span class="w"></span>
<span class="w">  </span><span class="na">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.domain</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"ad_gpo_security"</span><span class="w"> </span><span class="nv">"gpo_sec"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">gpo_container</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">ad_gpo.gpo.id</span><span class="w"></span>
<span class="w">  </span><span class="nb">password_policies</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">minimum_password_length</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">system_services</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">service_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TapiSrv"</span><span class="w"></span>
<span class="w">    </span><span class="na">startup_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2"</span><span class="w"></span>
<span class="w">    </span><span class="na">acl</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"D:AR(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;LA)"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">system_services</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">service_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"CertSvc"</span><span class="w"></span>
<span class="w">    </span><span class="na">startup_mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"2"</span><span class="w"></span>
<span class="w">    </span><span class="na">acl</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"D:AR(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;BA)(A;;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;SY)(A;;CCLCSWLOCRRC;;;IU)S:(AU;FA;CCDCLCSWRPWPDTLOCRSDRCWDWO;;;WD)"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="p">}</span><span class="w"></span>
</code></pre></div>

<!-- schema generated by tfplugindocs -->

<a class="dashAnchor" name="//apple_ref/cpp/Section/Schema"></a><h2 id="schema">Schema</h2>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Required"></a><h3 id="required">Required</h3>

<ul>
<li><code>gpo_container</code> (String) The GUID of the container the security settings belong to.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Optional"></a><h3 id="optional">Optional</h3>

<ul>
<li><code>account_lockout</code> (Block List, Max: 1) Settings related to account lockout. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/2cd39c97-97cd-4859-a7b4-1229dad5f53d) (see <a href="#nestedblock--account_lockout">below for nested schema</a>)</li>
<li><code>application_log</code> (Block List, Max: 1) Application log related settings. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/0b9673a7-ce0a-49b4-912b-591efdb37cdf) (see <a href="#nestedblock--application_log">below for nested schema</a>)</li>
<li><code>audit_log</code> (Block List, Max: 1) Audit log related settings. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/0b9673a7-ce0a-49b4-912b-591efdb37cdf) (see <a href="#nestedblock--audit_log">below for nested schema</a>)</li>
<li><code>event_audit</code> (Block List, Max: 1) Event audit related settings. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/01f8e057-f6a8-4d6e-8a00-99bcd241b403). Valid values for all items below are: 0 (None), 1 (Success audits only), 2 (Failure audits only), 3 (Success and failure audits), 4 (None) (see <a href="#nestedblock--event_audit">below for nested schema</a>)</li>
<li><code>filesystem</code> (Block Set) Settings related to File System permissions. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/abeebe06-49aa-44d4-ae5b-d6aff458e8e7) (see <a href="#nestedblock--filesystem">below for nested schema</a>)</li>
<li><code>id</code> (String) The ID of this resource.</li>
<li><code>kerberos_policy</code> (Block List, Max: 1) Settings related to kerberos policies. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/0fce5b92-bcc1-4b96-9c2b-56397c3f144f) (see <a href="#nestedblock--kerberos_policy">below for nested schema</a>)</li>
<li><code>password_policies</code> (Block List, Max: 1) Settings related to password policies. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/0b40db09-d95d-40a6-8467-32aedec8140c) (see <a href="#nestedblock--password_policies">below for nested schema</a>)</li>
<li><code>registry_keys</code> (Block Set) Settings related to Registry Keys. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/13712a60-de1e-4642-bd9c-ab054dd86278) (see <a href="#nestedblock--registry_keys">below for nested schema</a>)</li>
<li><code>registry_values</code> (Block Set) Settings related to Registry Values. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/3a14ca47-a22f-43c5-b35e-6be791003ca7) (see <a href="#nestedblock--registry_values">below for nested schema</a>)</li>
<li><code>restricted_groups</code> (Block Set) Settings related to Groups Membership. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/b73d8bae-ed22-48aa-acba-7065ab52d709) (see <a href="#nestedblock--restricted_groups">below for nested schema</a>)</li>
<li><code>system_log</code> (Block List, Max: 1) System log related settings. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/0b9673a7-ce0a-49b4-912b-591efdb37cdf) (see <a href="#nestedblock--system_log">below for nested schema</a>)</li>
<li><code>system_services</code> (Block Set) Settings related to System Services. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-gpsb/32deea3e-3fa4-414b-ba25-4121ad8c055c) (see <a href="#nestedblock--system_services">below for nested schema</a>)</li>
</ul>

<p><a id="nestedblock--account_lockout"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20account_lockout"></a><h3 id="nested-schema-for-account_lockout">Nested Schema for <code>account_lockout</code></h3>

<p>Optional:</p>

<ul>
<li><code>force_logoff_when_hour_expire</code> (String) Disconnect SMB sessions when logon hours expire.</li>
<li><code>lockout_bad_count</code> (String) Number of failed logon attempts until a account is locked.</li>
<li><code>lockout_duration</code> (String) Number of minutes a locked out account must remain locked out.</li>
<li><code>reset_lockout_count</code> (String) Number of minutes a account will remain locked after a failed logon attempt.</li>
</ul>

<p><a id="nestedblock--application_log"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20application_log"></a><h3 id="nested-schema-for-application_log">Nested Schema for <code>application_log</code></h3>

<p>Optional:</p>

<ul>
<li><code>audit_log_retention_period</code> (String) Control log retention. Values: 0: overwrite events as needed, 1: overwrite events as specified specified by <code>retention_days</code>, 2: never overwrite events.</li>
<li><code>maximum_log_size</code> (String) Maximum size of log in KiloBytes. (64-4194240)</li>
<li><code>restrict_guest_access</code> (String) Restrict access to logs for guest users. A non-zero value restricts access to guest users.</li>
<li><code>retention_days</code> (String) Number of days before new events overwrite old events. (1-365)</li>
</ul>

<p><a id="nestedblock--audit_log"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20audit_log"></a><h3 id="nested-schema-for-audit_log">Nested Schema for <code>audit_log</code></h3>

<p>Optional:</p>

<ul>
<li><code>audit_log_retention_period</code> (String) Control log retention. Values: 0: overwrite events as needed, 1: overwrite events as specified specified by <code>retention_days</code>, 2: never overwrite events.</li>
<li><code>maximum_log_size</code> (String) Maximum size of log in KiloBytes. (64-4194240)</li>
<li><code>restrict_guest_access</code> (String) Restrict access to logs for guest users. A non-zero value restricts access to guest users.</li>
<li><code>retention_days</code> (String) Number of days before new events overwrite old events. (1-365)</li>
</ul>

<p><a id="nestedblock--event_audit"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20event_audit"></a><h3 id="nested-schema-for-event_audit">Nested Schema for <code>event_audit</code></h3>

<p>Optional:</p>

<ul>
<li><code>audit_account_logon</code> (String) Audit credential validation.</li>
<li><code>audit_account_manage</code> (String) Audit account management events.</li>
<li><code>audit_ds_access</code> (String) Audit access attempts to AD objects.</li>
<li><code>audit_logon_events</code> (String) Audit logon events.</li>
<li><code>audit_object_access</code> (String) Audit access attempts to non-AD objects.</li>
<li><code>audit_policy_change</code> (String) Audit attempts to change a policy.</li>
<li><code>audit_privilege_use</code> (String) Audit user attempts of exercising user rights.</li>
<li><code>audit_process_tracking</code> (String) Audit process related events.</li>
<li><code>audit_system_events</code> (String) Audit system events.</li>
</ul>

<p><a id="nestedblock--filesystem"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20filesystem"></a><h3 id="nested-schema-for-filesystem">Nested Schema for <code>filesystem</code></h3>

<p>Required:</p>

<ul>
<li><code>acl</code> (String) Security descriptor to apply. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/f4296d69-1c0f-491f-9587-a960b292d070)</li>
<li><code>path</code> (String) Path of the file or directory.</li>
<li><code>propagation_mode</code> (String) Control permission propagation. 0: Propagate permissions to all subfolders and files, 1: Replace existing permissions on all subfolders and files, 2: Do not allow permissions to be replaced.</li>
</ul>

<p><a id="nestedblock--kerberos_policy"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20kerberos_policy"></a><h3 id="nested-schema-for-kerberos_policy">Nested Schema for <code>kerberos_policy</code></h3>

<p>Optional:</p>

<ul>
<li><code>max_clock_skew</code> (String) Maximum time difference, in minutes, between the client clock and the server clock. (0-99999).</li>
<li><code>max_renew_age</code> (String) Number of days during which a ticket-granting ticket can be renewed (0-99999).</li>
<li><code>max_service_age</code> (String) Maximum amount of minutes a ticket must be valid to access a service or resource. Minimum should be 10 and maximum should be equal to <code>max_ticket_age</code>.</li>
<li><code>max_ticket_age</code> (String) Maximum amount of hours a ticket-granting ticket is valid (0-99999).</li>
<li><code>ticket_validate_client</code> (String) Control if the session ticket is validated for every request. A non-zero value disables the policy.</li>
</ul>

<p><a id="nestedblock--password_policies"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20password_policies"></a><h3 id="nested-schema-for-password_policies">Nested Schema for <code>password_policies</code></h3>

<p>Optional:</p>

<ul>
<li><code>clear_text_password</code> (String) Store password with reversible encryption (0-2^16). The password will not be stored with reversible encryption if the value is set to 0. Reversible encryption will be used in any other case.</li>
<li><code>maximum_password_age</code> (String) Number of days before password expires (-1-999). If set to -1, it means the password never expires.</li>
<li><code>minimum_password_age</code> (String) Number of days a password must be used before changing it (0-999).</li>
<li><code>minimum_password_length</code> (String) Minimum number of characters used in a password (0-2^16). If set to 0, it means no password is required.</li>
<li><code>password_complexity</code> (String) Password must meet complexity requirements (0-2^16). If set to 0, then requirements do not apply, any other value means requirements are applied</li>
<li><code>password_history_size</code> (String) The number of unique new passwords that are required before an old password can be reused in association with a user account (0-2^16).  A value of 0 indicates that the password history is disabled.</li>
</ul>

<p><a id="nestedblock--registry_keys"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20registry_keys"></a><h3 id="nested-schema-for-registry_keys">Nested Schema for <code>registry_keys</code></h3>

<p>Required:</p>

<ul>
<li><code>acl</code> (String) Security descriptor to apply. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/f4296d69-1c0f-491f-9587-a960b292d070)</li>
<li><code>key_name</code> (String) Fully qualified name of the key (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/97587de7-3524-4291-8527-3951711      0c0eb)</li>
<li><code>propagation_mode</code> (String) Control permission propagation. 0: Propagate permissions to all subkeys, 1: Replace existing permissions on all subkeys, 2: Do not allow permissions to be replaced on the key.</li>
</ul>

<p><a id="nestedblock--registry_values"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20registry_values"></a><h3 id="nested-schema-for-registry_values">Nested Schema for <code>registry_values</code></h3>

<p>Required:</p>

<ul>
<li><code>key_name</code> (String) Fully qualified name of the key (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-rrp/97587de7-3524-4291-8527-39517110c0eb)</li>
<li><code>value</code> (String) The value of the key, matching the type set in <code>value_type</code>.</li>
<li><code>value_type</code> (String) Data type of the key's value. 1: String, 2: Expand String, 3: Binary, 4: DWORD, 5: MULTI_SZ.</li>
</ul>

<p><a id="nestedblock--restricted_groups"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20restricted_groups"></a><h3 id="nested-schema-for-restricted_groups">Nested Schema for <code>restricted_groups</code></h3>

<p>Required:</p>

<ul>
<li><code>group_memberof</code> (String) Comma separated list of group names or SIDs that this group belongs to.</li>
<li><code>group_members</code> (String) Comma separated list of group names or SIDs that are members of the group.</li>
<li><code>group_name</code> (String) Name of the group we are managing.</li>
</ul>

<p><a id="nestedblock--system_log"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20system_log"></a><h3 id="nested-schema-for-system_log">Nested Schema for <code>system_log</code></h3>

<p>Optional:</p>

<ul>
<li><code>audit_log_retention_period</code> (String) Control log retention. Values: 0: overwrite events as needed, 1: overwrite events as specified specified by <code>retention_days</code>, 2: never overwrite events.</li>
<li><code>maximum_log_size</code> (String) Maximum size of log in KiloBytes. (64-4194240)</li>
<li><code>restrict_guest_access</code> (String) Restrict access to logs for guest users. A non-zero value restricts access to guest users.</li>
<li><code>retention_days</code> (String) Number of days before new events overwrite old events. (1-365)</li>
</ul>

<p><a id="nestedblock--system_services"></a></p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Nested%20Schema%20for%20system_services"></a><h3 id="nested-schema-for-system_services">Nested Schema for <code>system_services</code></h3>

<p>Required:</p>

<ul>
<li><code>acl</code> (String) Security descriptor to apply. (https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-dtyp/f4296d69-1c0f-491f-9587-a960b292d070)</li>
<li><code>service_name</code> (String) Name of the service.</li>
<li><code>startup_mode</code> (String) Startup mode of the service. Possible values are 2: Automatic, 3: Manual, 4: Disabled.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>Import is supported using the following syntax:</p>

<div class="codehilite"><pre><span></span><code>$ terraform import ad_gpo_security 9CB8219C-31FF-4A85-A7A3-9BCBB6A41D02_securitysettings
</code></pre></div>

            
        
    </body></html>