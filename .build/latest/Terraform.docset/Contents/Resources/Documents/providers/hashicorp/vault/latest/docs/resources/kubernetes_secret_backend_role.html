<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/vault/latest/docs/resources/kubernetes_secret_backend_role --><head>
                <title>vault_kubernetes_secret_backend_role</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="vault_kubernetes_secret_backend_role">vault_kubernetes_secret_backend_role</h1>

<p>Creates a role for the Kubernetes Secrets Engine in Vault.</p>

<p>A role configures what service account tokens can be generated, and what permissions will 
be attached to them. The permissions attached to a service account token depend on the 
Kubernetes roles applied to its service account.</p>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>Important</em>
    <p>All data provided in the resource configuration will be written in cleartext to state and plan files generated by Terraform, and will appear in the console output when Terraform runs. Protect these artifacts accordingly. See <a href="../index.html">the main provider documentation</a> for more details.</p>
</aside>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<p>Example using <code>service_account_name</code> mode:</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"vault_kubernetes_secret_backend"</span><span class="w"> </span><span class="nv">"config"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">path</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"kubernetes"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"kubernetes secrets engine description"</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_host</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://127.0.0.1:61233"</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_ca_cert</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nf">file</span><span class="p">(</span><span class="s2">"/path/to/cert"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="na">service_account_jwt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">file</span><span class="p">(</span><span class="s2">"/path/to/token"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="na">disable_local_ca_jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"vault_kubernetes_secret_backend_role"</span><span class="w"> </span><span class="nv">"sa-example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">backend</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="nv">vault_kubernetes_secret_backend.config.path</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                          </span><span class="o">=</span><span class="w"> </span><span class="s2">"service-account-name-role"</span><span class="w"></span>
<span class="w">  </span><span class="na">allowed_kubernetes_namespaces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"*"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="na">token_max_ttl</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="m">43200</span><span class="w"></span>
<span class="w">  </span><span class="na">token_default_ttl</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="m">21600</span><span class="w"></span>
<span class="w">  </span><span class="na">service_account_name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"test-service-account-with-generated-token"</span><span class="w"></span>

<span class="w">  </span><span class="nb">extra_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">id</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"abc123"</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"some_name"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">extra_annotations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">env</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"development"</span><span class="w"></span>
<span class="w">    </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"earth"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Example using <code>kubernetes_role_name</code> mode:</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"vault_kubernetes_secret_backend"</span><span class="w"> </span><span class="nv">"config"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">path</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"kubernetes"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"kubernetes secrets engine description"</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_host</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://127.0.0.1:61233"</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_ca_cert</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nf">file</span><span class="p">(</span><span class="s2">"/path/to/cert"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="na">service_account_jwt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">file</span><span class="p">(</span><span class="s2">"/path/to/token"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="na">disable_local_ca_jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"vault_kubernetes_secret_backend_role"</span><span class="w"> </span><span class="nv">"name-example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">backend</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="nv">vault_kubernetes_secret_backend.config.path</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                          </span><span class="o">=</span><span class="w"> </span><span class="s2">"service-account-name-role"</span><span class="w"></span>
<span class="w">  </span><span class="na">allowed_kubernetes_namespaces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"*"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="na">token_max_ttl</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="m">43200</span><span class="w"></span>
<span class="w">  </span><span class="na">token_default_ttl</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="m">21600</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_role_name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"vault-k8s-secrets-role"</span><span class="w"></span>

<span class="w">  </span><span class="nb">extra_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">id</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"abc123"</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"some_name"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">extra_annotations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">env</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"development"</span><span class="w"></span>
<span class="w">    </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"earth"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Example using <code>generated_role_rules</code> mode:</p>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"vault_kubernetes_secret_backend"</span><span class="w"> </span><span class="nv">"config"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">path</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"kubernetes"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"kubernetes secrets engine description"</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_host</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://127.0.0.1:61233"</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_ca_cert</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nf">file</span><span class="p">(</span><span class="s2">"/path/to/cert"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="na">service_account_jwt</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nf">file</span><span class="p">(</span><span class="s2">"/path/to/token"</span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="na">disable_local_ca_jwt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"vault_kubernetes_secret_backend_role"</span><span class="w"> </span><span class="nv">"rules-example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">backend</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="nv">vault_kubernetes_secret_backend.config.path</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                          </span><span class="o">=</span><span class="w"> </span><span class="s2">"service-account-name-role"</span><span class="w"></span>
<span class="w">  </span><span class="na">allowed_kubernetes_namespaces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"*"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="na">token_max_ttl</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="m">43200</span><span class="w"></span>
<span class="w">  </span><span class="na">token_default_ttl</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="m">21600</span><span class="w"></span>
<span class="w">  </span><span class="na">kubernetes_role_type</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"Role"</span><span class="w"></span>
<span class="w">  </span><span class="na">generated_role_rules</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">rules:</span>
<span class="sh">- apiGroups: [""]</span>
<span class="sh">  resources: ["pods"]</span>
<span class="sh">  verbs: ["list"]</span>
<span class="dl">EOF</span>

<span class="w">  </span><span class="nb">extra_labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">id</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"abc123"</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"some_name"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">extra_annotations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">env</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"development"</span><span class="w"></span>
<span class="w">    </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"earth"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>namespace</code> - (Optional) The namespace to provision the resource in.
The value should not contain leading or trailing forward slashes.
The <code>namespace</code> is always relative to the provider's configured <a href="../index.html#namespace">namespace</a>.
<em>Available only for Vault Enterprise</em>.</p></li>
<li><p><code>name</code> - (Required) The name of the role.</p></li>
<li><p><code>backend</code> - (Required) The path of the Kubernetes Secrets Engine backend mount to create
the role in.</p></li>
<li><p><code>allowed_kubernetes_namespaces</code> - (Optional) The list of Kubernetes namespaces this role 
can generate credentials for. If set to <code>*</code> all namespaces are allowed. If set with 
<code>allowed_kubernetes_namespace_selector</code>, the conditions are <code>OR</code>ed.</p></li>
<li><p><code>allowed_kubernetes_namespace_selector</code> - (Optional) A label selector for Kubernetes namespaces 
in which credentials can be generated. Accepts either a JSON or YAML object. The value should be 
of type <a href="https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.24/#labelselector-v1-meta">LabelSelector</a>. 
If set with <code>allowed_kubernetes_namespace</code>, the conditions are <code>OR</code>ed.</p></li>
<li><p><code>token_max_ttl</code> - (Optional) The maximum TTL for generated Kubernetes tokens in seconds.</p></li>
<li><p><code>token_default_ttl</code> - (Optional) The default TTL for generated Kubernetes tokens in seconds.</p></li>
<li><p><code>service_account_name</code> - (Optional) The pre-existing service account to generate tokens for.
Mutually exclusive with <code>kubernetes_role_name</code> and <code>generated_role_rules</code>. If set, only a
Kubernetes token will be created when credentials are requested.</p></li>
<li><p><code>kubernetes_role_name</code> - (Optional) The pre-existing Role or ClusterRole to bind a 
generated service account to. Mutually exclusive with <code>service_account_name</code> and 
<code>generated_role_rules</code>. If set, Kubernetes token, service account, and role 
binding objects will be created when credentials are requested.</p></li>
<li><p><code>kubernetes_role_type</code> - (Optional) Specifies whether the Kubernetes role is a Role or 
ClusterRole.</p></li>
<li><p><code>generated_role_rules</code> - (Optional) The Role or ClusterRole rules to use when generating 
a role. Accepts either JSON or YAML formatted rules. Mutually exclusive with <code>service_account_name</code> 
and <code>kubernetes_role_name</code>. If set, the entire chain of Kubernetes objects will be generated 
when credentials are requested.</p></li>
<li><p><code>name_template</code> - (Optional) The name template to use when generating service accounts, 
roles and role bindings. If unset, a default template is used.</p></li>
<li><p><code>extra_annotations</code> - (Optional) Additional annotations to apply to all generated 
Kubernetes objects.</p></li>
<li><p><code>extra_labels</code> - (Optional) Additional labels to apply to all generated Kubernetes 
objects.</p></li>
</ul>

<p>This resource also directly accepts all <a href="mount.html.md">vault_mount</a> fields.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>No additional attributes are exported by this resource.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>The Kubernetes secret backend role can be imported using the full path to the role
of the form: <code>&lt;backend_path&gt;/roles/&lt;role_name&gt;</code> e.g.</p>

<pre><code>$ terraform import vault_kubernetes_secret_backend_role.example kubernetes kubernetes/roles/example-role
</code></pre>

            
        
    </body></html>