<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/chronicle_rule --><head>
                <title>google_chronicle_rule</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="google_chronicle_rule">google_chronicle_rule</h1>

<p>The Rule resource represents a user-created rule.</p>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>Warning</em>
    <p>This resource is in beta, and should be used with the terraform-provider-google-beta provider. See <a href="https://terraform.io/docs/providers/google/guides/provider_versions.html">Provider Versions</a> for more details on beta resources.</p>
</aside>

<p>To get more information about Rule, see:</p>

<ul>
<li><a href="https://cloud.google.com/chronicle/docs/reference/rest/v1alpha/projects.locations.instances.rules">API documentation</a></li>
<li>How-to Guides
<ul>
<li><a href="https://cloud.google.com/chronicle/docs/secops/secops-overview">Google SecOps Guides</a></li>
</ul></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Chronicle%20Rule%20Basic"></a><h2 id="example-usage-chronicle-rule-basic">Example Usage - Chronicle Rule Basic</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_chronicle_rule"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"google-beta"</span><span class="w"></span>
<span class="w"> </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us"</span><span class="w"></span>
<span class="w"> </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="w"></span>
<span class="w"> </span><span class="na">deletion_policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DEFAULT"</span><span class="w"></span>
<span class="w"> </span><span class="na">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="dl">EOT</span><span class="sh"></span>
<span class="sh">             rule test_rule { meta: events:  $userid = $e.principal.user.userid  match: $userid over 10m condition: $e }</span>
<span class="dl">         EOT</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Chronicle%20Rule%20With%20Force%20Deletion"></a><h2 id="example-usage-chronicle-rule-with-force-deletion">Example Usage - Chronicle Rule With Force Deletion</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_chronicle_rule"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"google-beta"</span><span class="w"></span>
<span class="w"> </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us"</span><span class="w"></span>
<span class="w"> </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="w"></span>
<span class="w"> </span><span class="na">deletion_policy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"FORCE"</span><span class="w"></span>
<span class="w"> </span><span class="na">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="dl">EOT</span><span class="sh"></span>
<span class="sh">             rule test_rule { meta: events:  $userid = $e.principal.user.userid  match: $userid over 10m condition: $e }</span>
<span class="dl">         EOT</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Chronicle%20Rule%20With%20Data%20Access%20Scope"></a><h2 id="example-usage-chronicle-rule-with-data-access-scope">Example Usage - Chronicle Rule With Data Access Scope</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_chronicle_data_access_scope"</span><span class="w"> </span><span class="nv">"data_access_scope_test"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"google-beta"</span><span class="w"></span>
<span class="w"> </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us"</span><span class="w"></span>
<span class="w"> </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="w"></span>
<span class="w"> </span><span class="na">data_access_scope_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"scope-name"</span><span class="w"></span>
<span class="w"> </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"scope-description"</span><span class="w"></span>
<span class="w"> </span><span class="nb">allowed_data_access_labels</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">   </span><span class="na">log_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCP_CLOUDAUDIT"</span><span class="w"></span>
<span class="w"> </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_chronicle_rule"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w"> </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"google-beta"</span><span class="w"></span>
<span class="w"> </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us"</span><span class="w"></span>
<span class="w"> </span><span class="na">instance</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"00000000-0000-0000-0000-000000000000"</span><span class="w"></span>
<span class="w"> </span><span class="na">scope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">resource.google_chronicle_data_access_scope.data_access_scope_test.name</span><span class="w"></span>
<span class="w"> </span><span class="na">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;-</span><span class="dl">EOT</span><span class="sh"></span>
<span class="sh">             rule test_rule { meta: events:  $userid = $e.principal.user.userid  match: $userid over 10m condition: $e }</span>
<span class="dl">         EOT</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>location</code> -
(Required)
The location of the resource. This is the geographical region where the Chronicle instance resides, such as "us" or "europe-west2".</p></li>
<li><p><code>instance</code> -
(Required)
The unique identifier for the Chronicle instance, which is the same as the customer ID.</p></li>
</ul>

<hr/>

<ul>
<li><p><code>text</code> -
(Optional)
The YARA-L content of the rule.
Populated in FULL view.</p></li>
<li><p><code>scope</code> -
(Optional)
Resource name of the DataAccessScope bound to this rule.
Populated in BASIC view and FULL view.
If reference lists are used in the rule, validations will be performed
against this scope to ensure that the reference lists are compatible with
both the user's and the rule's scopes.
The scope should be in the format:
"projects/{project}/locations/{location}/instances/{instance}/dataAccessScopes/{scope}".</p></li>
<li><p><code>etag</code> -
(Optional)
The etag for this rule.
If this is provided on update, the request will succeed if and only if it
matches the server-computed value, and will fail with an ABORTED error
otherwise.
Populated in BASIC view and FULL view.</p></li>
<li><p><code>project</code> - (Optional) The ID of the project in which the resource belongs.
If it is not provided, the provider project is used.</p></li>
<li><p><code>deletion_policy</code> - (Optional) Policy to determine if the rule should be deleted forcefully.
If deletion_policy = "FORCE", any retrohunts and any detections associated with the rule
will also be deleted. If deletion_policy = "DEFAULT", the call will only succeed if the
rule has no associated retrohunts, including completed retrohunts, and no
associated detections. Regardless of this field's value, the rule
deployment associated with this rule will also be deleted.
Possible values: DEFAULT, FORCE</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the arguments listed above, the following computed attributes are exported:</p>

<ul>
<li><p><code>id</code> - an identifier for the resource with format <code>projects/{{project}}/locations/{{location}}/instances/{{instance}}/rules/{{rule_id}}</code></p></li>
<li><p><code>name</code> -
Full resource name for the rule. This unique identifier is generated using values provided for the URL parameters.
Format:
projects/{project}/locations/{location}/instances/{instance}/rules/{rule}</p></li>
<li><p><code>rule_id</code> -
Rule Id is the ID of the Rule.</p></li>
<li><p><code>metadata</code> -
Output only. Additional metadata specified in the meta section of text.
Populated in FULL view.</p></li>
<li><p><code>near_real_time_live_rule_eligible</code> -
Output only. Indicate the rule can run in near real time live rule.
If this is true, the rule uses the near real time live rule when the run
frequency is set to LIVE.</p></li>
<li><p><code>revision_id</code> -
Output only. The revision ID of the rule.
A new revision is created whenever the rule text is changed in any way.
Format: v_{10 digits}_{9 digits}
Populated in REVISION_METADATA_ONLY view and FULL view.</p></li>
<li><p><code>severity</code> -
Severity represents the severity level of the rule.
Structure is <a href="#nested_severity">documented below</a>.</p></li>
<li><p><code>revision_create_time</code> -
Output only. The timestamp of when the rule revision was created.
Populated in FULL, REVISION_METADATA_ONLY views.</p></li>
<li><p><code>compilation_state</code> -
Output only. The current compilation state of the rule.
Populated in FULL view.
Possible values:
COMPILATION_STATE_UNSPECIFIED
SUCCEEDED
FAILED</p></li>
<li><p><code>type</code> -
Possible values:
RULE_TYPE_UNSPECIFIED
SINGLE_EVENT
MULTI_EVENT</p></li>
<li><p><code>reference_lists</code> -
Output only. Resource names of the reference lists used in this rule.
Populated in FULL view.</p></li>
<li><p><code>display_name</code> -
Output only. Display name of the rule.
Populated in BASIC view and FULL view.</p></li>
<li><p><code>create_time</code> -
Output only. The timestamp of when the rule was created.
Populated in FULL view.</p></li>
<li><p><code>author</code> -
Output only. The author of the rule. Extracted from the meta section of text.
Populated in BASIC view and FULL view.</p></li>
<li><p><code>allowed_run_frequencies</code> -
Output only. The run frequencies that are allowed for the rule.
Populated in BASIC view and FULL view.</p></li>
<li><p><code>compilation_diagnostics</code> -
Output only. A list of a rule's corresponding compilation diagnostic messages
such as compilation errors and compilation warnings.
Populated in FULL view.
Structure is <a href="#nested_compilation_diagnostics">documented below</a>.</p></li>
<li><p><code>data_tables</code> -
Output only. Resource names of the data tables used in this rule.</p></li>
</ul>

<p><a name="nested_severity"></a>The <code>severity</code> block contains:</p>

<ul>
<li><code>display_name</code> -
(Optional)
The display name of the severity level. Extracted from the meta section of
the rule text.</li>
</ul>

<p><a name="nested_compilation_diagnostics"></a>The <code>compilation_diagnostics</code> block contains:</p>

<ul>
<li><p><code>message</code> -
(Output)
Output only. The diagnostic message.</p></li>
<li><p><code>position</code> -
(Optional)
CompilationPosition represents the location of a compilation diagnostic in
rule text.
Structure is <a href="#nested_compilation_diagnostics_compilation_diagnostics_position">documented below</a>.</p></li>
<li><p><code>severity</code> -
(Output)
Output only. The severity of a rule's compilation diagnostic.
Possible values:
SEVERITY_UNSPECIFIED
WARNING
ERROR</p></li>
<li><p><code>uri</code> -
(Output)
Output only. Link to documentation that describes a diagnostic in more detail.</p></li>
</ul>

<p><a name="nested_compilation_diagnostics_compilation_diagnostics_position"></a>The <code>position</code> block supports:</p>

<ul>
<li><p><code>start_line</code> -
(Output)
Output only. Start line number, beginning at 1.</p></li>
<li><p><code>start_column</code> -
(Output)
Output only. Start column number, beginning at 1.</p></li>
<li><p><code>end_line</code> -
(Output)
Output only. End line number, beginning at 1.</p></li>
<li><p><code>end_column</code> -
(Output)
Output only. End column number, beginning at 1.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>This resource provides the following
<a href="https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts">Timeouts</a> configuration options:</p>

<ul>
<li><code>create</code> - Default is 20 minutes.</li>
<li><code>update</code> - Default is 20 minutes.</li>
<li><code>delete</code> - Default is 20 minutes.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>Rule can be imported using any of these accepted formats:</p>

<ul>
<li><code>projects/{{project}}/locations/{{location}}/instances/{{instance}}/rules/{{rule_id}}</code></li>
<li><code>{{project}}/{{location}}/{{instance}}/{{rule_id}}</code></li>
<li><code>{{location}}/{{instance}}/{{rule_id}}</code></li>
</ul>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import Rule using one of the formats above. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projects/{{project}}/locations/{{location}}/instances/{{instance}}/rules/{{rule_id}}"</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_chronicle_rule.default</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>When using the <a href="https://developer.hashicorp.com/terraform/cli/commands/import"><code>terraform import</code> command</a>, Rule can be imported using one of the formats above. For example:</p>

<pre><code>$ terraform import google_chronicle_rule.default projects/{{project}}/locations/{{location}}/instances/{{instance}}/rules/{{rule_id}}
$ terraform import google_chronicle_rule.default {{project}}/{{location}}/{{instance}}/{{rule_id}}
$ terraform import google_chronicle_rule.default {{location}}/{{instance}}/{{rule_id}}
</code></pre>

<a class="dashAnchor" name="//apple_ref/cpp/Section/User%20Project%20Overrides"></a><h2 id="user-project-overrides">User Project Overrides</h2>

<p>This resource supports <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override">User Project Overrides</a>.</p>

            
        
    </body></html>