<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/api_gateway_api_config --><head>
                <title>google_api_gateway_api_config</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="google_api_gateway_api_config">google_api_gateway_api_config</h1>

<p>An API Configuration is an association of an API Controller Config and a Gateway Config</p>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>Warning</em>
    <p>This resource is in beta, and should be used with the terraform-provider-google-beta provider. See <a href="https://terraform.io/docs/providers/google/guides/provider_versions.html">Provider Versions</a> for more details on beta resources.</p>
</aside>

<p>To get more information about ApiConfig, see:</p>

<ul>
<li><a href="https://cloud.google.com/api-gateway/docs/reference/rest/v1beta/projects.locations.apis.configs">API documentation</a></li>
<li>How-to Guides
<ul>
<li><a href="https://cloud.google.com/api-gateway/docs/creating-api-config">Official Documentation</a></li>
</ul></li>
</ul>

<div class="oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&amp;cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&amp;cloudshell_print=.%2Fmotd&amp;cloudshell_tutorial=.%2Ftutorial.md&amp;cloudshell_working_dir=apigateway_api_config_basic&amp;open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;"/>
  </a>
</div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Apigateway%20Api%20Config%20Basic"></a><h2 id="example-usage-apigateway-api-config-basic">Example Usage - Apigateway Api Config Basic</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_api_gateway_api"</span><span class="w"> </span><span class="nv">"api_cfg"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>
<span class="w">  </span><span class="na">api_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-api"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_api_gateway_api_config"</span><span class="w"> </span><span class="nv">"api_cfg"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>
<span class="w">  </span><span class="na">api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_api_gateway_api.api_cfg.api_id</span><span class="w"></span>
<span class="w">  </span><span class="na">api_config_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-config"</span><span class="w"></span>

<span class="w">  </span><span class="nb">openapi_documents</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">document</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"spec.yaml"</span><span class="w"></span>
<span class="w">      </span><span class="na">contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">filebase64</span><span class="p">(</span><span class="s2">"test-fixtures/openapi.yaml"</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">create_before_destroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<div class="oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&amp;cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&amp;cloudshell_print=.%2Fmotd&amp;cloudshell_tutorial=.%2Ftutorial.md&amp;cloudshell_working_dir=apigateway_api_config_grpc&amp;open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;"/>
  </a>
</div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Apigateway%20Api%20Config%20Grpc"></a><h2 id="example-usage-apigateway-api-config-grpc">Example Usage - Apigateway Api Config Grpc</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_api_gateway_api"</span><span class="w"> </span><span class="nv">"api_cfg"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>
<span class="w">  </span><span class="na">api_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-api"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_api_gateway_api_config"</span><span class="w"> </span><span class="nv">"api_cfg"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">provider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">google-beta</span><span class="w"></span>
<span class="w">  </span><span class="na">api</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_api_gateway_api.api_cfg.api_id</span><span class="w"></span>
<span class="w">  </span><span class="na">api_config_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-config"</span><span class="w"></span>

<span class="w">  </span><span class="nb">grpc_services</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">file_descriptor_set</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"api_descriptor.pb"</span><span class="w"></span>
<span class="w">      </span><span class="na">contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">filebase64</span><span class="p">(</span><span class="s2">"test-fixtures/api_descriptor.pb"</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">managed_service_configs</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"api_config.yaml"</span><span class="w"></span>
<span class="w">    </span><span class="na">contents</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">base64encode</span><span class="p">(</span><span class="o">&lt;&lt;-</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">      type: google.api.Service</span>
<span class="sh">      config_version: 3</span>
<span class="sh">      name: ${google_api_gateway_api.api_cfg.managed_service}</span>
<span class="sh">      title: gRPC API example</span>
<span class="sh">      apis:</span>
<span class="sh">        - name: endpoints.examples.bookstore.Bookstore</span>
<span class="sh">      usage:</span>
<span class="sh">        rules:</span>
<span class="sh">        - selector: endpoints.examples.bookstore.Bookstore.ListShelves</span>
<span class="sh">          allow_unregistered_calls: true</span>
<span class="sh">      backend:</span>
<span class="sh">        rules:</span>
<span class="sh">          - selector: "*"</span>
<span class="sh">            address: grpcs://example.com</span>
<span class="sh">            disable_auth: true</span>

<span class="dl">    EOF</span>
<span class="w">    </span><span class="p">)</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">lifecycle</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">create_before_destroy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><code>api</code> -
(Required)
The API to attach the config to.</li>
</ul>

<hr/>

<ul>
<li><p><code>display_name</code> -
(Optional)
A user-visible name for the API.</p></li>
<li><p><code>labels</code> -
(Optional)
Resource labels to represent user-provided metadata.</p>

<p><strong>Note</strong>: This field is non-authoritative, and will only manage the labels present in your configuration.
Please refer to the field <code>effective_labels</code> for all of the labels present on the resource.</p></li>
<li><p><code>gateway_config</code> -
(Optional)
Immutable. Gateway specific configuration.
If not specified, backend authentication will be set to use OIDC authentication using the default compute service account
Structure is <a href="#nested_gateway_config">documented below</a>.</p></li>
<li><p><code>openapi_documents</code> -
(Optional)
OpenAPI specification documents. If specified, grpcServices and managedServiceConfigs must not be included.
Structure is <a href="#nested_openapi_documents">documented below</a>.</p></li>
<li><p><code>grpc_services</code> -
(Optional)
gRPC service definition files. If specified, openapiDocuments must not be included.
Structure is <a href="#nested_grpc_services">documented below</a>.</p></li>
<li><p><code>managed_service_configs</code> -
(Optional)
Optional. Service Configuration files. At least one must be included when using gRPC service definitions. See https://cloud.google.com/endpoints/docs/grpc/grpc-service-config#service_configuration_overview for the expected file contents.
If multiple files are specified, the files are merged with the following rules: * All singular scalar fields are merged using "last one wins" semantics in the order of the files uploaded. * Repeated fields are concatenated. * Singular embedded messages are merged using these rules for nested fields.
Structure is <a href="#nested_managed_service_configs">documented below</a>.</p></li>
<li><p><code>api_config_id</code> -
(Optional)
Identifier to assign to the API Config. Must be unique within scope of the parent resource(api).</p></li>
<li><p><code>project</code> - (Optional) The ID of the project in which the resource belongs.
If it is not provided, the provider project is used.</p></li>
<li><p><code>api_config_id_prefix</code> - (Optional) Creates a unique name beginning with the
specified prefix. If this and api_config_id are unspecified, a random value is chosen for the name.</p></li>
</ul>

<p><a name="nested_gateway_config"></a>The <code>gateway_config</code> block supports:</p>

<ul>
<li><code>backend_config</code> -
(Required)
Backend settings that are applied to all backends of the Gateway.
Structure is <a href="#nested_gateway_config_backend_config">documented below</a>.</li>
</ul>

<p><a name="nested_gateway_config_backend_config"></a>The <code>backend_config</code> block supports:</p>

<ul>
<li><code>google_service_account</code> -
(Required)
Google Cloud IAM service account used to sign OIDC tokens for backends that have authentication configured
(https://cloud.google.com/service-infrastructure/docs/service-management/reference/rest/v1/services.configs#backend).</li>
</ul>

<p><a name="nested_openapi_documents"></a>The <code>openapi_documents</code> block supports:</p>

<ul>
<li><code>document</code> -
(Required)
The OpenAPI Specification document file.
Structure is <a href="#nested_openapi_documents_openapi_documents_document">documented below</a>.</li>
</ul>

<p><a name="nested_openapi_documents_openapi_documents_document"></a>The <code>document</code> block supports:</p>

<ul>
<li><p><code>path</code> -
(Required)
The file path (full or relative path). This is typically the path of the file when it is uploaded.</p></li>
<li><p><code>contents</code> -
(Required)
Base64 encoded content of the file.</p></li>
</ul>

<p><a name="nested_grpc_services"></a>The <code>grpc_services</code> block supports:</p>

<ul>
<li><p><code>file_descriptor_set</code> -
(Required)
Input only. File descriptor set, generated by protoc.
To generate, use protoc with imports and source info included. For an example test.proto file, the following command would put the value in a new file named out.pb.
$ protoc --include_imports --include_source_info test.proto -o out.pb
Structure is <a href="#nested_grpc_services_grpc_services_file_descriptor_set">documented below</a>.</p></li>
<li><p><code>source</code> -
(Optional)
Uncompiled proto files associated with the descriptor set, used for display purposes (server-side compilation is not supported). These should match the inputs to 'protoc' command used to generate fileDescriptorSet.
Structure is <a href="#nested_grpc_services_grpc_services_source">documented below</a>.</p></li>
</ul>

<p><a name="nested_grpc_services_grpc_services_file_descriptor_set"></a>The <code>file_descriptor_set</code> block supports:</p>

<ul>
<li><p><code>path</code> -
(Required)
The file path (full or relative path). This is typically the path of the file when it is uploaded.</p></li>
<li><p><code>contents</code> -
(Required)
Base64 encoded content of the file.</p></li>
</ul>

<p><a name="nested_grpc_services_grpc_services_source"></a>The <code>source</code> block supports:</p>

<ul>
<li><p><code>path</code> -
(Required)
The file path (full or relative path). This is typically the path of the file when it is uploaded.</p></li>
<li><p><code>contents</code> -
(Required)
Base64 encoded content of the file.</p></li>
</ul>

<p><a name="nested_managed_service_configs"></a>The <code>managed_service_configs</code> block supports:</p>

<ul>
<li><p><code>path</code> -
(Required)
The file path (full or relative path). This is typically the path of the file when it is uploaded.</p></li>
<li><p><code>contents</code> -
(Required)
Base64 encoded content of the file.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the arguments listed above, the following computed attributes are exported:</p>

<ul>
<li><p><code>id</code> - an identifier for the resource with format <code>projects/{{project}}/locations/global/apis/{{api}}/configs/{{api_config_id}}</code></p></li>
<li><p><code>name</code> -
The resource name of the API Config.</p></li>
<li><p><code>service_config_id</code> -
The ID of the associated Service Config (https://cloud.google.com/service-infrastructure/docs/glossary#config).</p></li>
<li><p><code>terraform_labels</code> -
The combination of labels configured directly on the resource
and default labels configured on the provider.</p></li>
<li><p><code>effective_labels</code> -
All of labels (key/value pairs) present on the resource in GCP, including the labels configured through Terraform, other clients and services.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>This resource provides the following
<a href="https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts">Timeouts</a> configuration options:</p>

<ul>
<li><code>create</code> - Default is 20 minutes.</li>
<li><code>update</code> - Default is 20 minutes.</li>
<li><code>delete</code> - Default is 20 minutes.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>ApiConfig can be imported using any of these accepted formats:</p>

<ul>
<li><code>projects/{{project}}/locations/global/apis/{{api}}/configs/{{api_config_id}}</code></li>
<li><code>{{project}}/{{api}}/{{api_config_id}}</code></li>
<li><code>{{api}}/{{api_config_id}}</code></li>
</ul>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import ApiConfig using one of the formats above. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projects/{{project}}/locations/global/apis/{{api}}/configs/{{api_config_id}}"</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_api_gateway_api_config.default</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>When using the <a href="https://developer.hashicorp.com/terraform/cli/commands/import"><code>terraform import</code> command</a>, ApiConfig can be imported using one of the formats above. For example:</p>

<pre><code>$ terraform import google_api_gateway_api_config.default projects/{{project}}/locations/global/apis/{{api}}/configs/{{api_config_id}}
$ terraform import google_api_gateway_api_config.default {{project}}/{{api}}/{{api_config_id}}
$ terraform import google_api_gateway_api_config.default {{api}}/{{api_config_id}}
</code></pre>

<a class="dashAnchor" name="//apple_ref/cpp/Section/User%20Project%20Overrides"></a><h2 id="user-project-overrides">User Project Overrides</h2>

<p>This resource supports <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override">User Project Overrides</a>.</p>

            
        
    </body></html>