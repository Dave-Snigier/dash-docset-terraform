<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/container_registry_task --><head>
                <title>azurerm_container_registry_task</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="azurerm_container_registry_task">azurerm_container_registry_task</h1>

<p>Manages a Container Registry Task.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"azurerm"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">features</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_resource_group"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-rg"</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"West Europe"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_container_registry"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>
<span class="w">  </span><span class="na">resource_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_resource_group.example.name</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_resource_group.example.location</span><span class="w"></span>
<span class="w">  </span><span class="na">sku</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"Basic"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_container_registry_task"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-task"</span><span class="w"></span>
<span class="w">  </span><span class="na">container_registry_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_container_registry.example.id</span><span class="w"></span>
<span class="w">  </span><span class="nb">platform</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">os</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Linux"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">docker_step</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">dockerfile_path</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"Dockerfile"</span><span class="w"></span>
<span class="w">    </span><span class="na">context_path</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"https://github.com/&lt;username&gt;/&lt;repository&gt;#&lt;branch&gt;:&lt;folder&gt;"</span><span class="w"></span>
<span class="w">    </span><span class="na">context_access_token</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"&lt;github personal access token&gt;"</span><span class="w"></span>
<span class="w">    </span><span class="na">image_names</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">"helloworld:{{.Run.ID}}"</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Arguments%20Reference"></a><h2 id="arguments-reference">Arguments Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>name</code> - (Required) The name which should be used for this Container Registry Task. Changing this forces a new Container Registry Task to be created.</p></li>
<li><p><code>container_registry_id</code> - (Required) The ID of the Container Registry that this Container Registry Task resides in. Changing this forces a new Container Registry Task to be created.</p></li>
</ul>

<hr/>

<ul>
<li><p><code>agent_pool_name</code> - (Optional) The name of the dedicated Container Registry Agent Pool for this Container Registry Task.</p></li>
<li><p><code>agent_setting</code> - (Optional) A <code>agent_setting</code> block as defined below.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>Only one of <code>agent_pool_name</code> and <code>agent_setting</code> can be specified.</p>
</aside>

<ul>
<li><p><code>enabled</code> - (Optional) Should this Container Registry Task be enabled? Defaults to <code>true</code>.</p></li>
<li><p><code>identity</code> - (Optional) An <code>identity</code> block as defined below.</p></li>
<li><p><code>platform</code> - (Optional) A <code>platform</code> block as defined below.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>The <code>platform</code> is required for non-system task (when <code>is_system_task</code> is set to <code>false</code>).</p>
</aside>

<ul>
<li><p><code>docker_step</code> - (Optional) A <code>docker_step</code> block as defined below.</p></li>
<li><p><code>encoded_step</code> - (Optional) A <code>encoded_step</code> block as defined below.</p></li>
<li><p><code>file_step</code> - (Optional) A <code>file_step</code> block as defined below.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>For non-system task (when <code>is_system_task</code> is set to <code>false</code>), one and only one of the <code>docker_step</code>, <code>encoded_step</code> and <code>file_step</code> should be specified.</p>
</aside>

<ul>
<li><p><code>base_image_trigger</code> - (Optional) A <code>base_image_trigger</code> block as defined below.</p></li>
<li><p><code>source_trigger</code> - (Optional) One or more <code>source_trigger</code> blocks as defined below.</p></li>
<li><p><code>timer_trigger</code> - (Optional) One or more <code>timer_trigger</code> blocks as defined below.</p></li>
<li><p><code>is_system_task</code> - (Optional) Whether this Container Registry Task is a system task. Changing this forces a new Container Registry Task to be created. Defaults to <code>false</code>.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>For system task, the <code>name</code> has to be set as <code>quicktask</code>. And the following properties can't be specified: <code>docker_step</code>, <code>encoded_step</code>, <code>file_step</code>, <code>platform</code>, <code>base_image_trigger</code>, <code>source_trigger</code>, <code>timer_trigger</code>.</p>
</aside>

<ul>
<li><p><code>log_template</code> - (Optional) The template that describes the run log artifact.</p></li>
<li><p><code>registry_credential</code> - (Optional) One <code>registry_credential</code> block as defined below.</p></li>
<li><p><code>tags</code> - (Optional) A mapping of tags which should be assigned to the Container Registry Task.</p></li>
<li><p><code>timeout_in_seconds</code> - (Optional) The timeout of this Container Registry Task in seconds. The valid range lies from 300 to 28800. Defaults to <code>3600</code>.</p></li>
</ul>

<hr/>

<p>A <code>agent_setting</code> block supports the following:</p>

<ul>
<li><code>cpu</code> - (Required) The number of cores required for the Container Registry Task. Possible value is <code>2</code>.</li>
</ul>

<hr/>

<p>A <code>authentication</code> block supports the following:</p>

<ul>
<li><p><code>token</code> - (Required) The access token used to access the source control provider.</p></li>
<li><p><code>token_type</code> - (Required) The type of the token. Possible values are <code>PAT</code> (personal access token) and <code>OAuth</code>.</p></li>
<li><p><code>expire_in_seconds</code> - (Optional) Time in seconds that the token remains valid.</p></li>
<li><p><code>refresh_token</code> - (Optional) The refresh token used to refresh the access token.</p></li>
<li><p><code>scope</code> - (Optional) The scope of the access token.</p></li>
</ul>

<hr/>

<p>A <code>base_image_trigger</code> block supports the following:</p>

<ul>
<li><p><code>name</code> - (Required) The name which should be used for this trigger.</p></li>
<li><p><code>type</code> - (Required) The type of the trigger. Possible values are <code>All</code> and <code>Runtime</code>.</p></li>
<li><p><code>enabled</code> - (Optional) Should the trigger be enabled? Defaults to <code>true</code>.</p></li>
<li><p><code>update_trigger_endpoint</code> - (Optional) The endpoint URL for receiving the trigger.</p></li>
<li><p><code>update_trigger_payload_type</code> - (Optional) Type of payload body for the trigger. Possible values are <code>Default</code> and <code>Token</code>.</p></li>
</ul>

<hr/>

<p>A <code>custom</code> block supports the following:</p>

<ul>
<li><p><code>login_server</code> - (Required) The login server of the custom Container Registry.</p></li>
<li><p><code>identity</code> - (Optional) The managed identity assigned to this custom credential. For user assigned identity, the value is the client ID of the identity. For system assigned identity, the value is <code>[system]</code>.</p></li>
<li><p><code>password</code> - (Optional) The password for logging into the custom Container Registry. It can be either a plain text of password, or a Keyvault Secret ID.</p></li>
<li><p><code>username</code> - (Optional) The username for logging into the custom Container Registry. It can be either a plain text of username, or a Keyvault Secret ID.</p></li>
</ul>

<hr/>

<p>A <code>docker_step</code> block supports the following:</p>

<ul>
<li><p><code>context_access_token</code> - (Required) The token (Git PAT or SAS token of storage account blob) associated with the context for this step.</p></li>
<li><p><code>context_path</code> - (Required) The URL (absolute or relative) of the source context for this step. If the context is an url you can reference a specific branch or folder via <code>#branch:folder</code>.</p></li>
<li><p><code>dockerfile_path</code> - (Required) The Dockerfile path relative to the source context.</p></li>
<li><p><code>arguments</code> - (Optional) Specifies a map of arguments to be used when executing this step.</p></li>
<li><p><code>image_names</code> - (Optional) Specifies a list of fully qualified image names including the repository and tag.</p></li>
<li><p><code>cache_enabled</code> - (Optional) Should the image cache be enabled? Defaults to <code>true</code>.</p></li>
<li><p><code>push_enabled</code> - (Optional) Should the image built be pushed to the registry or not? Defaults to <code>true</code>.</p></li>
<li><p><code>secret_arguments</code> - (Optional) Specifies a map of <em>secret</em> arguments to be used when executing this step.</p></li>
<li><p><code>target</code> - (Optional) The name of the target build stage for the docker build.</p></li>
</ul>

<hr/>

<p>A <code>encoded_step</code> block supports the following:</p>

<ul>
<li><p><code>task_content</code> - (Required) The (optionally base64 encoded) content of the build template.</p></li>
<li><p><code>context_access_token</code> - (Optional) The token (Git PAT or SAS token of storage account blob) associated with the context for this step.</p></li>
<li><p><code>context_path</code> - (Optional) The URL (absolute or relative) of the source context for this step.</p></li>
<li><p><code>secret_values</code> - (Optional) Specifies a map of secret values that can be passed when running a task.</p></li>
<li><p><code>value_content</code> - (Optional) The (optionally base64 encoded) content of the build parameters.</p></li>
<li><p><code>values</code> - (Optional) Specifies a map of values that can be passed when running a task.</p></li>
</ul>

<hr/>

<p>A <code>file_step</code> block supports the following:</p>

<ul>
<li><p><code>task_file_path</code> - (Required) The task template file path relative to the source context.</p></li>
<li><p><code>context_access_token</code> - (Optional) The token (Git PAT or SAS token of storage account blob) associated with the context for this step.</p></li>
<li><p><code>context_path</code> - (Optional) The URL (absolute or relative) of the source context for this step.</p></li>
<li><p><code>secret_values</code> - (Optional) Specifies a map of secret values that can be passed when running a task.</p></li>
<li><p><code>value_file_path</code> - (Optional) The parameters file path relative to the source context.</p></li>
<li><p><code>values</code> - (Optional) Specifies a map of values that can be passed when running a task.</p></li>
</ul>

<hr/>

<p>An <code>identity</code> block supports the following:</p>

<ul>
<li><p><code>type</code> - (Required) Specifies the type of Managed Service Identity that should be configured on this Container Registry Task. Possible values are <code>SystemAssigned</code>, <code>UserAssigned</code>, <code>SystemAssigned, UserAssigned</code> (to enable both).</p></li>
<li><p><code>identity_ids</code> - (Optional) Specifies a list of User Assigned Managed Identity IDs to be assigned to this Container Registry Task.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>This is required when <code>type</code> is set to <code>UserAssigned</code> or <code>SystemAssigned, UserAssigned</code>.</p>
</aside>

<hr/>

<p>A <code>platform</code> block supports the following:</p>

<ul>
<li><p><code>os</code> - (Required) The operating system type required for the task. Possible values are <code>Windows</code> and <code>Linux</code>.</p></li>
<li><p><code>architecture</code> - (Optional) The OS architecture. Possible values are <code>amd64</code>, <code>x86</code>, <code>386</code>, <code>arm</code> and <code>arm64</code>.</p></li>
<li><p><code>variant</code> - (Optional) The variant of the CPU. Possible values are <code>v6</code>, <code>v7</code>, <code>v8</code>.</p></li>
</ul>

<hr/>

<p>A <code>registry_credential</code> block supports the following:</p>

<ul>
<li><p><code>source</code> - (Optional) One <code>source</code> block as defined below.</p></li>
<li><p><code>custom</code> - (Optional) One or more <code>custom</code> blocks as defined above.</p></li>
</ul>

<hr/>

<p>A <code>source</code> block supports the following:</p>

<ul>
<li><code>login_mode</code> - (Required) The login mode for the source registry. Possible values are <code>None</code> and <code>Default</code>.</li>
</ul>

<hr/>

<p>A <code>source_trigger</code> block supports the following:</p>

<ul>
<li><p><code>name</code> - (Required) The name which should be used for this trigger.</p></li>
<li><p><code>events</code> - (Required) Specifies a list of source events corresponding to the trigger. Possible values are <code>commit</code> and <code>pullrequest</code>.</p></li>
<li><p><code>repository_url</code> - (Required) The full URL to the source code repository.</p></li>
<li><p><code>source_type</code> - (Required) The type of the source control service. Possible values are <code>Github</code> and <code>VisualStudioTeamService</code>.</p></li>
<li><p><code>authentication</code> - (Optional) A <code>authentication</code> block as defined above.</p></li>
<li><p><code>branch</code> - (Optional) The branch name of the source code.</p></li>
<li><p><code>enabled</code> - (Optional) Should the trigger be enabled? Defaults to <code>true</code>.</p></li>
</ul>

<hr/>

<p>A <code>timer_trigger</code> block supports the following:</p>

<ul>
<li><p><code>name</code> - (Required) The name which should be used for this trigger.</p></li>
<li><p><code>schedule</code> - (Required) The CRON expression for the task schedule.</p></li>
<li><p><code>enabled</code> - (Optional) Should the trigger be enabled? Defaults to <code>true</code>.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the Arguments listed above - the following Attributes are exported:</p>

<ul>
<li><p><code>id</code> - The ID of the Container Registry Task.</p></li>
<li><p><code>identity</code> - An <code>identity</code> block as defined below.</p></li>
</ul>

<hr/>

<p>An <code>identity</code> block exports the following:</p>

<ul>
<li><p><code>principal_id</code> - The Principal ID associated with this Managed Service Identity.</p></li>
<li><p><code>tenant_id</code> - The Tenant ID associated with this Managed Service Identity.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>The <code>timeouts</code> block allows you to specify <a href="https://www.terraform.io/language/resources/syntax#operation-timeouts">timeouts</a> for certain actions:</p>

<ul>
<li><code>create</code> - (Defaults to 30 minutes) Used when creating the Container Registry Task.</li>
<li><code>read</code> - (Defaults to 5 minutes) Used when retrieving the Container Registry Task.</li>
<li><code>update</code> - (Defaults to 30 minutes) Used when updating the Container Registry Task.</li>
<li><code>delete</code> - (Defaults to 30 minutes) Used when deleting the Container Registry Task.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>Container Registry Tasks can be imported using the <code>resource id</code>, e.g.</p>

<div class="codehilite"><pre><span></span><code>terraform import azurerm_container_registry_task.example /subscriptions/12345678-1234-9876-4563-123456789012/resourceGroups/group1/providers/Microsoft.ContainerRegistry/registries/registry1/tasks/task1
</code></pre></div>

            
        
    </body></html>