<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/apigatewayv2_api --><head>
                <title>aws_apigatewayv2_api</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="resource-aws_apigatewayv2_api">Resource: aws_apigatewayv2_api</h1>

<p>Manages an Amazon API Gateway Version 2 API.</p>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>Amazon API Gateway Version 2 resources are used for creating and deploying WebSocket and HTTP APIs. To create and deploy REST APIs, use Amazon API Gateway Version 1 <a href="../resources/api_gateway_rest_api.html">resources</a>.</p>
</aside>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Basic%20WebSocket%20API"></a><h3 id="basic-websocket-api">Basic WebSocket API</h3>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_apigatewayv2_api"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                       </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-websocket-api"</span><span class="w"></span>
<span class="w">  </span><span class="na">protocol_type</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="s2">"WEBSOCKET"</span><span class="w"></span>
<span class="w">  </span><span class="na">route_selection_expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"$request.body.action"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Basic%20HTTP%20API"></a><h3 id="basic-http-api">Basic HTTP API</h3>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_apigatewayv2_api"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-http-api"</span><span class="w"></span>
<span class="w">  </span><span class="na">protocol_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"HTTP"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>This resource supports the following arguments:</p>

<ul>
<li><code>name</code> - (Required) Name of the API. Must be less than or equal to 128 characters in length.</li>
<li><code>protocol_type</code> - (Required) API protocol. Valid values: <code>HTTP</code>, <code>WEBSOCKET</code>.</li>
<li><code>api_key_selection_expression</code> - (Optional) An <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-selection-expressions.html#apigateway-websocket-api-apikey-selection-expressions">API key selection expression</a>.
Valid values: <code>$context.authorizer.usageIdentifierKey</code>, <code>$request.header.x-api-key</code>. Defaults to <code>$request.header.x-api-key</code>.
Applicable for WebSocket APIs.</li>
<li><code>cors_configuration</code> - (Optional) Cross-origin resource sharing (CORS) <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-cors.html">configuration</a>. Applicable for HTTP APIs.</li>
<li><code>credentials_arn</code> - (Optional) Part of _quick create_. Specifies any credentials required for the integration. Applicable for HTTP APIs.</li>
<li><code>description</code> - (Optional) Description of the API. Must be less than or equal to 1024 characters in length.</li>
<li><code>disable_execute_api_endpoint</code> - (Optional) Whether clients can invoke the API by using the default <code>execute-api</code> endpoint.
By default, clients can invoke the API with the default <code>{api_id}.execute-api.{region}.amazonaws.com endpoint</code>.
To require that clients use a custom domain name to invoke the API, disable the default endpoint.</li>
<li><code>route_key</code> - (Optional) Part of _quick create_. Specifies any <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/http-api-develop-routes.html">route key</a>. Applicable for HTTP APIs.</li>
<li><code>route_selection_expression</code> - (Optional) The <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-api-selection-expressions.html#apigateway-websocket-api-route-selection-expressions">route selection expression</a> for the API.
Defaults to <code>$request.method $request.path</code>.</li>
<li><code>tags</code> - (Optional) Map of tags to assign to the API. If configured with a provider <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block"><code>default_tags</code> configuration block</a> present, tags with matching keys will overwrite those defined at the provider-level.</li>
<li><code>target</code> - (Optional) Part of _quick create_. Quick create produces an API with an integration, a default catch-all route, and a default stage which is configured to automatically deploy changes.
For HTTP integrations, specify a fully qualified URL. For Lambda integrations, specify a function ARN.
The type of the integration will be <code>HTTP_PROXY</code> or <code>AWS_PROXY</code>, respectively. Applicable for HTTP APIs.</li>
<li><code>body</code> - (Optional) An OpenAPI specification that defines the set of routes and integrations to create as part of the HTTP APIs. Supported only for HTTP APIs.</li>
<li><code>version</code> - (Optional) Version identifier for the API. Must be between 1 and 64 characters in length.</li>
<li><code>fail_on_warnings</code> - (Optional) Whether warnings should return an error while API Gateway is creating or updating the resource using an OpenAPI specification. Defaults to <code>false</code>. Applicable for HTTP APIs.</li>
</ul>

<p>__Note__: If the <code>body</code> argument is provided, the OpenAPI specification will be used to configure the integrations and route for the HTTP API. If this argument is provided, the following resources should not be managed as separate ones, as updates may cause manual resource updates to be overwritten:</p>

<ul>
<li><code>aws_apigatewayv2_integration</code></li>
<li><code>aws_apigatewayv2_route</code></li>
</ul>

<p>Further more, the <code>name</code>, <code>description</code>, <code>cors_configuration</code>, <code>tags</code> and <code>version</code> fields should be specified in the Terraform configuration and the values will override any values specified in the OpenAPI document.</p>

<p>The <code>cors_configuration</code> object supports the following:</p>

<ul>
<li><code>allow_credentials</code> - (Optional) Whether credentials are included in the CORS request.</li>
<li><code>allow_headers</code> - (Optional) Set of allowed HTTP headers.</li>
<li><code>allow_methods</code> - (Optional) Set of allowed HTTP methods.</li>
<li><code>allow_origins</code> - (Optional) Set of allowed origins.</li>
<li><code>expose_headers</code> - (Optional) Set of exposed HTTP headers.</li>
<li><code>max_age</code> - (Optional) Number of seconds that the browser should cache preflight request results.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attribute%20Reference"></a><h2 id="attribute-reference">Attribute Reference</h2>

<p>This resource exports the following attributes in addition to the arguments above:</p>

<ul>
<li><code>id</code> - API identifier.</li>
<li><code>api_endpoint</code> - URI of the API, of the form <code>https://{api-id}.execute-api.{region}.amazonaws.com</code> for HTTP APIs and <code>wss://{api-id}.execute-api.{region}.amazonaws.com</code> for WebSocket APIs.</li>
<li><code>arn</code> - ARN of the API.</li>
<li><code>execution_arn</code> - ARN prefix to be used in an <a href="../resources/lambda_permission.html"><code>aws_lambda_permission</code></a>'s <code>source_arn</code> attribute
or in an <a href="../resources/iam_policy.html"><code>aws_iam_policy</code></a> to authorize access to the <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-how-to-call-websocket-api-connections.html"><code>@connections</code> API</a>.
See the <a href="https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-websocket-control-access-iam.html">Amazon API Gateway Developer Guide</a> for details.</li>
<li><code>tags_all</code> - Map of tags assigned to the resource, including those inherited from the provider <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block"><code>default_tags</code> configuration block</a>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import <code>aws_apigatewayv2_api</code> using the API identifier. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_apigatewayv2_api.example</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"aabbccddee"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Using <code>terraform import</code>, import <code>aws_apigatewayv2_api</code> using the API identifier. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">% </span>terraform import aws_apigatewayv2_api.example aabbccddee
</code></pre></div>

            
        
    </body></html>