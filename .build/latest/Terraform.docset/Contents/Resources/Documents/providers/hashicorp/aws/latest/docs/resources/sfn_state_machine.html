<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/sfn_state_machine --><head>
                <title>aws_sfn_state_machine</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="resource-aws_sfn_state_machine">Resource: aws_sfn_state_machine</h1>

<p>Provides a Step Function State Machine resource</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Basic%20%28Standard%20Workflow%29"></a><h3 id="basic-standard-workflow">Basic (Standard Workflow)</h3>

<div class="codehilite"><pre><span></span><code><span class="c1"># ...</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sfn_state_machine"</span><span class="w"> </span><span class="nv">"sfn_state_machine"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-state-machine"</span><span class="w"></span>
<span class="w">  </span><span class="na">role_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_iam_role.iam_for_sfn.arn</span><span class="w"></span>

<span class="w">  </span><span class="na">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">{</span>
<span class="sh">  "Comment": "A Hello World example of the Amazon States Language using an AWS Lambda Function",</span>
<span class="sh">  "StartAt": "HelloWorld",</span>
<span class="sh">  "States": {</span>
<span class="sh">    "HelloWorld": {</span>
<span class="sh">      "Type": "Task",</span>
<span class="sh">      "Resource": "${aws_lambda_function.lambda.arn}",</span>
<span class="sh">      "End": true</span>
<span class="sh">    }</span>
<span class="sh">  }</span>
<span class="sh">}</span>
<span class="dl">EOF</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Basic%20%28Express%20Workflow%29"></a><h3 id="basic-express-workflow">Basic (Express Workflow)</h3>

<div class="codehilite"><pre><span></span><code><span class="c1"># ...</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sfn_state_machine"</span><span class="w"> </span><span class="nv">"sfn_state_machine"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-state-machine"</span><span class="w"></span>
<span class="w">  </span><span class="na">role_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_iam_role.iam_for_sfn.arn</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"EXPRESS"</span><span class="w"></span>

<span class="w">  </span><span class="na">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">{</span>
<span class="sh">  "Comment": "A Hello World example of the Amazon States Language using an AWS Lambda Function",</span>
<span class="sh">  "StartAt": "HelloWorld",</span>
<span class="sh">  "States": {</span>
<span class="sh">    "HelloWorld": {</span>
<span class="sh">      "Type": "Task",</span>
<span class="sh">      "Resource": "${aws_lambda_function.lambda.arn}",</span>
<span class="sh">      "End": true</span>
<span class="sh">    }</span>
<span class="sh">  }</span>
<span class="sh">}</span>
<span class="dl">EOF</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Publish%20%28Publish%20SFN%20version%29"></a><h3 id="publish-publish-sfn-version">Publish (Publish SFN version)</h3>

<div class="codehilite"><pre><span></span><code><span class="c1"># ...</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sfn_state_machine"</span><span class="w"> </span><span class="nv">"sfn_state_machine"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-state-machine"</span><span class="w"></span>
<span class="w">  </span><span class="na">role_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_iam_role.iam_for_sfn.arn</span><span class="w"></span>
<span class="w">  </span><span class="na">publish</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"EXPRESS"</span><span class="w"></span>

<span class="w">  </span><span class="na">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">{</span>
<span class="sh">  "Comment": "A Hello World example of the Amazon States Language using an AWS Lambda Function",</span>
<span class="sh">  "StartAt": "HelloWorld",</span>
<span class="sh">  "States": {</span>
<span class="sh">    "HelloWorld": {</span>
<span class="sh">      "Type": "Task",</span>
<span class="sh">      "Resource": "${aws_lambda_function.lambda.arn}",</span>
<span class="sh">      "End": true</span>
<span class="sh">    }</span>
<span class="sh">  }</span>
<span class="sh">}</span>
<span class="dl">EOF</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Logging"></a><h3 id="logging">Logging</h3>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p><em>NOTE:</em> See the <a href="https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html">AWS Step Functions Developer Guide</a> for more information about enabling Step Function logging.</p>
</aside>

<div class="codehilite"><pre><span></span><code><span class="c1"># ...</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sfn_state_machine"</span><span class="w"> </span><span class="nv">"sfn_state_machine"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-state-machine"</span><span class="w"></span>
<span class="w">  </span><span class="na">role_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_iam_role.iam_for_sfn.arn</span><span class="w"></span>

<span class="w">  </span><span class="na">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">{</span>
<span class="sh">  "Comment": "A Hello World example of the Amazon States Language using an AWS Lambda Function",</span>
<span class="sh">  "StartAt": "HelloWorld",</span>
<span class="sh">  "States": {</span>
<span class="sh">    "HelloWorld": {</span>
<span class="sh">      "Type": "Task",</span>
<span class="sh">      "Resource": "${aws_lambda_function.lambda.arn}",</span>
<span class="sh">      "End": true</span>
<span class="sh">    }</span>
<span class="sh">  }</span>
<span class="sh">}</span>
<span class="dl">EOF</span>

<span class="w">  </span><span class="nb">logging_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">log_destination</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"${aws_cloudwatch_log_group.log_group_for_sfn.arn}:*"</span><span class="w"></span>
<span class="w">    </span><span class="na">include_execution_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">    </span><span class="na">level</span><span class="w">                  </span><span class="o">=</span><span class="w"> </span><span class="s2">"ERROR"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Encryption"></a><h3 id="encryption">Encryption</h3>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p><em>NOTE:</em> See the section <a href="https://docs.aws.amazon.com/step-functions/latest/dg/encryption-at-rest.html">Data at rest encyption</a> in the <a href="https://docs.aws.amazon.com/step-functions/latest/dg/welcome.html">AWS Step Functions Developer Guide</a> for more information about enabling encryption of data using a customer-managed key for Step Functions State Machines data.</p>
</aside>

<div class="codehilite"><pre><span></span><code><span class="c1"># ...</span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"aws_sfn_state_machine"</span><span class="w"> </span><span class="nv">"sfn_state_machine"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-state-machine"</span><span class="w"></span>
<span class="w">  </span><span class="na">role_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_iam_role.iam_for_sfn.arn</span><span class="w"></span>

<span class="w">  </span><span class="na">definition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">{</span>
<span class="sh">  "Comment": "A Hello World example of the Amazon States Language using an AWS Lambda Function",</span>
<span class="sh">  "StartAt": "HelloWorld",</span>
<span class="sh">  "States": {</span>
<span class="sh">    "HelloWorld": {</span>
<span class="sh">      "Type": "Task",</span>
<span class="sh">      "Resource": "${aws_lambda_function.lambda.arn}",</span>
<span class="sh">      "End": true</span>
<span class="sh">    }</span>
<span class="sh">  }</span>
<span class="sh">}</span>
<span class="dl">EOF</span>

<span class="w">  </span><span class="nb">encryption_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">kms_key_id</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_kms_key.kms_key_for_sfn.arn</span><span class="w"></span>
<span class="w">    </span><span class="na">type</span><span class="w">                              </span><span class="o">=</span><span class="w"> </span><span class="s2">"CUSTOMER_MANAGED_KMS_KEY"</span><span class="w"></span>
<span class="w">    </span><span class="na">kms_data_key_reuse_period_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">900</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>This resource supports the following arguments:</p>

<ul>
<li><code>definition</code> - (Required) The <a href="https://docs.aws.amazon.com/step-functions/latest/dg/concepts-amazon-states-language.html">Amazon States Language</a> definition of the state machine.</li>
<li><code>encryption_configuration</code> - (Optional) Defines what encryption configuration is used to encrypt data in the State Machine. For more information see [TBD] in the AWS Step Functions User Guide.</li>
<li><code>logging_configuration</code> - (Optional) Defines what execution history events are logged and where they are logged. The <code>logging_configuration</code> parameter is valid when <code>type</code> is set to <code>STANDARD</code> or <code>EXPRESS</code>. Defaults to <code>OFF</code>. For more information see <a href="https://docs.aws.amazon.com/step-functions/latest/dg/cw-logs.html">Logging Express Workflows</a>, <a href="https://docs.aws.amazon.com/step-functions/latest/dg/cloudwatch-log-level.html">Log Levels</a> and <a href="https://docs.aws.amazon.com/step-functions/latest/apireference/API_CreateStateMachine.html">Logging Configuration</a> in the AWS Step Functions User Guide.</li>
<li><code>name</code> - (Optional) The name of the state machine. The name should only contain <code>0</code>-<code>9</code>, <code>A</code>-<code>Z</code>, <code>a</code>-<code>z</code>, <code>-</code> and <code>_</code>. If omitted, Terraform will assign a random, unique name.</li>
<li><code>name_prefix</code> - (Optional) Creates a unique name beginning with the specified prefix. Conflicts with <code>name</code>.</li>
<li><code>publish</code> - (Optional) Set to true to publish a version of the state machine during creation. Default: false.</li>
<li><code>role_arn</code> - (Required) The Amazon Resource Name (ARN) of the IAM role to use for this state machine.</li>
<li><code>tags</code> - (Optional) Key-value map of resource tags. If configured with a provider <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block"><code>default_tags</code> configuration block</a> present, tags with matching keys will overwrite those defined at the provider-level.</li>
<li><code>tracing_configuration</code> - (Optional) Selects whether AWS X-Ray tracing is enabled.</li>
<li><code>type</code> - (Optional) Determines whether a Standard or Express state machine is created. The default is <code>STANDARD</code>. You cannot update the type of a state machine once it has been created. Valid values: <code>STANDARD</code>, <code>EXPRESS</code>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/encryption_configuration%20Configuration%20Block"></a><h3 id="encryption_configuration-configuration-block"><code>encryption_configuration</code> Configuration Block</h3>

<ul>
<li><code>kms_key_id</code> - (Optional) The alias, alias ARN, key ID, or key ARN of the symmetric encryption KMS key that encrypts the data key. To specify a KMS key in a different AWS account, the customer must use the key ARN or alias ARN. For more information regarding kms_key_id, see <a href="https://docs.aws.amazon.com/kms/latest/APIReference/API_DescribeKey.html#API_DescribeKey_RequestParameters">KeyId</a> in the KMS documentation.</li>
<li><code>type</code> - (Required) The encryption option specified for the state machine. Valid values: <code>AWS_OWNED_KEY</code>, <code>CUSTOMER_MANAGED_KMS_KEY</code></li>
<li><code>kms_data_key_reuse_period_seconds</code> - (Optional) Maximum duration for which Step Functions will reuse data keys. When the period expires, Step Functions will call GenerateDataKey. This setting only applies to customer managed KMS key and does not apply when <code>type</code> is <code>AWS_OWNED_KEY</code>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/logging_configuration%20Configuration%20Block"></a><h3 id="logging_configuration-configuration-block"><code>logging_configuration</code> Configuration Block</h3>

<ul>
<li><code>include_execution_data</code> - (Optional) Determines whether execution data is included in your log. When set to <code>false</code>, data is excluded.</li>
<li><code>level</code> - (Optional) Defines which category of execution history events are logged. Valid values: <code>ALL</code>, <code>ERROR</code>, <code>FATAL</code>, <code>OFF</code></li>
<li><code>log_destination</code> - (Optional) Amazon Resource Name (ARN) of a CloudWatch log group. Make sure the State Machine has the correct IAM policies for logging. The ARN must end with <code>:*</code></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/tracing_configuration%20Configuration%20Block"></a><h3 id="tracing_configuration-configuration-block"><code>tracing_configuration</code> Configuration Block</h3>

<ul>
<li><code>enabled</code> - (Optional) When set to <code>true</code>, AWS X-Ray tracing is enabled. Make sure the State Machine has the correct IAM policies for logging. See the <a href="https://docs.aws.amazon.com/step-functions/latest/dg/xray-iam.html">AWS Step Functions Developer Guide</a> for details.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attribute%20Reference"></a><h2 id="attribute-reference">Attribute Reference</h2>

<p>This resource exports the following attributes in addition to the arguments above:</p>

<ul>
<li><code>id</code> - The ARN of the state machine.</li>
<li><code>arn</code> - The ARN of the state machine.</li>
<li><code>creation_date</code> - The date the state machine was created.</li>
<li><code>state_machine_version_arn</code> - The ARN of the state machine version.</li>
<li><code>status</code> - The current status of the state machine. Either <code>ACTIVE</code> or <code>DELETING</code>.</li>
<li><code>tags_all</code> - A map of tags assigned to the resource, including those inherited from the provider <a href="https://registry.terraform.io/providers/hashicorp/aws/latest/docs#default_tags-configuration-block"><code>default_tags</code> configuration block</a>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p><a href="https://developer.hashicorp.com/terraform/language/resources/syntax#operation-timeouts">Configuration options</a>:</p>

<ul>
<li><code>create</code> - (Default <code>5m</code>)</li>
<li><code>update</code> - (Default <code>1m</code>)</li>
<li><code>delete</code> - (Default <code>5m</code>)</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import State Machines using the <code>arn</code>. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">aws_sfn_state_machine.foo</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"arn:aws:states:eu-west-1:123456789098:stateMachine:bar"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Using <code>terraform import</code>, import State Machines using the <code>arn</code>. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="gp">% </span>terraform import aws_sfn_state_machine.foo arn:aws:states:eu-west-1:123456789098:stateMachine:bar
</code></pre></div>

            
        
    </body></html>