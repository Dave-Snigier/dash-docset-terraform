<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/redis_cluster_user_created_connections --><head>
                <title>google_redis_cluster_user_created_connections</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="google_redis_cluster_user_created_connections">google_redis_cluster_user_created_connections</h1>

<p>Manages user created connections for Redis cluster</p>

<p>To get more information about ClusterUserCreatedConnections, see:</p>

<ul>
<li><a href="https://cloud.google.com/memorystore/docs/cluster/reference/rest/v1/projects.locations.clusters">API documentation</a></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>Please ensure your connections meet the requirements outlined at https://cloud.devsite.corp.google.com/memorystore/docs/cluster/about-multiple-vpc-networking#application_connection_requirements. If you remove a connections item from the resource, the corresponding forwarding rule will no longer be functioning. If the corresponding forwarding rule is represented in your terraform configuration it is recommended to delete that <code>google_compute_forwarding_rule</code> resource at the same time.</p>
</aside>

<div class="oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&amp;cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&amp;cloudshell_print=.%2Fmotd&amp;cloudshell_tutorial=.%2Ftutorial.md&amp;cloudshell_working_dir=redis_cluster_user_created_connections&amp;open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;"/>
  </a>
</div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Redis%20Cluster%20User%20Created%20Connections"></a><h2 id="example-usage-redis-cluster-user-created-connections">Example Usage - Redis Cluster User Created Connections</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_redis_cluster_user_created_connections"</span><span class="w"> </span><span class="nv">"cluster-user-conn"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cluster-user-conn"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="nb">cluster_endpoints</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">connections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">psc_connection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">psc_connection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule1_network1.psc_connection_id</span><span class="w"></span>
<span class="w">        </span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip1_network1.address</span><span class="w"></span>
<span class="w">        </span><span class="na">forwarding_rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule1_network1.id</span><span class="w"></span>
<span class="w">        </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="w">        </span><span class="na">project_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.google_project.project.project_id</span><span class="w"></span>
<span class="w">        </span><span class="na">service_attachment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[0].service_attachment</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">connections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">psc_connection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">psc_connection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule2_network1.psc_connection_id</span><span class="w"></span>
<span class="w">        </span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip2_network1.address</span><span class="w"></span>
<span class="w">        </span><span class="na">forwarding_rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule2_network1.id</span><span class="w"></span>
<span class="w">        </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="w">        </span><span class="na">service_attachment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[1].service_attachment</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="nb">cluster_endpoints</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">connections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">psc_connection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">psc_connection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule1_network2.psc_connection_id</span><span class="w"></span>
<span class="w">        </span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip1_network2.address</span><span class="w"></span>
<span class="w">        </span><span class="na">forwarding_rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule1_network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">service_attachment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[0].service_attachment</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">connections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">psc_connection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">psc_connection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule2_network2.psc_connection_id</span><span class="w"></span>
<span class="w">        </span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip2_network2.address</span><span class="w"></span>
<span class="w">        </span><span class="na">forwarding_rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule2_network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">service_attachment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[1].service_attachment</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_forwarding_rule"</span><span class="w"> </span><span class="nv">"forwarding_rule1_network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"fwd1-net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_address</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip1_network1.id</span><span class="w"></span>
<span class="w">  </span><span class="na">load_balancing_scheme</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="w">  </span><span class="na">target</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[0].service_attachment</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_forwarding_rule"</span><span class="w"> </span><span class="nv">"forwarding_rule2_network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"fwd2-net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_address</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip2_network1.id</span><span class="w"></span>
<span class="w">  </span><span class="na">load_balancing_scheme</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="w">  </span><span class="na">target</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[1].service_attachment</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"ip1_network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"ip1-net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">subnetwork</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet_network1.id</span><span class="w"></span>
<span class="w">  </span><span class="na">address_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCE_ENDPOINT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"ip2_network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"ip2-net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">subnetwork</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet_network1.id</span><span class="w"></span>
<span class="w">  </span><span class="na">address_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCE_ENDPOINT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet_network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"subnet-net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.248/29"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="s2">"net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">auto_create_subnetworks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_forwarding_rule"</span><span class="w"> </span><span class="nv">"forwarding_rule1_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"fwd1-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_address</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip1_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">load_balancing_scheme</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">target</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[0].service_attachment</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_forwarding_rule"</span><span class="w"> </span><span class="nv">"forwarding_rule2_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"fwd2-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_address</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip2_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">load_balancing_scheme</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">target</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-conn.psc_service_attachments[1].service_attachment</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"ip1_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"ip1-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">subnetwork</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">address_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCE_ENDPOINT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"ip2_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"ip2-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">subnetwork</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">address_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCE_ENDPOINT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"subnet-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.248/29"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="s2">"network2"</span><span class="w"></span>
<span class="w">  </span><span class="na">auto_create_subnetworks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="c1"></span>

<span class="c1">// redis cluster without endpoint</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_redis_cluster"</span><span class="w"> </span><span class="nv">"cluster-user-conn"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">"cluster-user-conn"</span><span class="w"></span>
<span class="w">  </span><span class="na">shard_count</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">replica_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="w">  </span><span class="na">deletion_protection_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"google_project"</span><span class="w"> </span><span class="nv">"project"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<div class="oics-button" style="float: right; margin: 0 0 -15px">
  <a href="https://console.cloud.google.com/cloudshell/open?cloudshell_git_repo=https%3A%2F%2Fgithub.com%2Fterraform-google-modules%2Fdocs-examples.git&amp;cloudshell_image=gcr.io%2Fcloudshell-images%2Fcloudshell%3Alatest&amp;cloudshell_print=.%2Fmotd&amp;cloudshell_tutorial=.%2Ftutorial.md&amp;cloudshell_working_dir=redis_cluster_user_and_auto_created_connections&amp;open_in_editor=main.tf" target="_blank">
    <img alt="Open in Cloud Shell" src="//gstatic.com/cloudssh/images/open-btn.svg" style="max-height: 44px; margin: 32px auto; max-width: 100%;"/>
  </a>
</div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Redis%20Cluster%20User%20And%20Auto%20Created%20Connections"></a><h2 id="example-usage-redis-cluster-user-and-auto-created-connections">Example Usage - Redis Cluster User And Auto Created Connections</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_redis_cluster_user_created_connections"</span><span class="w"> </span><span class="nv">"cluster-user-auto-conn"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cluster-user-auto-conn"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="nb">cluster_endpoints</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">connections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">psc_connection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">psc_connection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule1_network2.psc_connection_id</span><span class="w"></span>
<span class="w">        </span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip1_network2.address</span><span class="w"></span>
<span class="w">        </span><span class="na">forwarding_rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule1_network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">service_attachment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-auto-conn.psc_service_attachments[0].service_attachment</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">connections</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">psc_connection</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">psc_connection_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule2_network2.psc_connection_id</span><span class="w"></span>
<span class="w">        </span><span class="na">address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip2_network2.address</span><span class="w"></span>
<span class="w">        </span><span class="na">forwarding_rule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_forwarding_rule.forwarding_rule2_network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">        </span><span class="na">service_attachment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-auto-conn.psc_service_attachments[1].service_attachment</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_forwarding_rule"</span><span class="w"> </span><span class="nv">"forwarding_rule1_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"fwd1-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_address</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip1_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">load_balancing_scheme</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">target</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-auto-conn.psc_service_attachments[0].service_attachment</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_forwarding_rule"</span><span class="w"> </span><span class="nv">"forwarding_rule2_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"fwd2-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_address</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_address.ip2_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">load_balancing_scheme</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">""</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">target</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster.cluster-user-auto-conn.psc_service_attachments[1].service_attachment</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"ip1_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"ip1-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">subnetwork</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">address_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCE_ENDPOINT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_address"</span><span class="w"> </span><span class="nv">"ip2_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"ip2-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">subnetwork</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_subnetwork.subnet_network2.id</span><span class="w"></span>
<span class="w">  </span><span class="na">address_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"INTERNAL"</span><span class="w"></span>
<span class="w">  </span><span class="na">purpose</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"GCE_ENDPOINT"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet_network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"subnet-net2"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.248/29"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network2.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"network2"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="s2">"network2"</span><span class="w"></span>
<span class="w">  </span><span class="na">auto_create_subnetworks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="c1"></span>

<span class="c1">// redis cluster without endpoint</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_redis_cluster"</span><span class="w"> </span><span class="nv">"cluster-user-auto-conn"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="s2">"cluster-user-auto-conn"</span><span class="w"></span>
<span class="w">  </span><span class="na">shard_count</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">replica_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="w">  </span><span class="na">deletion_protection_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="w">  </span><span class="nb">psc_configs</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="na">depends_on</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">    </span><span class="nv">google_network_connectivity_service_connection_policy.default</span><span class="w"></span>
<span class="w">  </span><span class="p">]</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_network_connectivity_service_connection_policy"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"scpolicy"</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">service_class</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"gcp-memorystore-redis"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"my basic service connection policy"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="w">  </span><span class="nb">psc_config</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">subnetworks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="nv">google_compute_subnetwork.subnet_network1.id</span><span class="p">]</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_subnetwork"</span><span class="w"> </span><span class="nv">"subnet_network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">          </span><span class="o">=</span><span class="w"> </span><span class="s2">"subnet-net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">ip_cidr_range</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"10.0.0.248/29"</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"us-central1"</span><span class="w"></span>
<span class="w">  </span><span class="na">network</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">google_compute_network.network1.id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"google_compute_network"</span><span class="w"> </span><span class="nv">"network1"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="s2">"net1"</span><span class="w"></span>
<span class="w">  </span><span class="na">auto_create_subnetworks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>name</code> -
(Required)
The name of the Redis cluster these endpoints should be added to.</p></li>
<li><p><code>region</code> -
(Required)
The name of the region of the Redis cluster these endpoints should be added to.</p></li>
</ul>

<hr/>

<ul>
<li><p><code>cluster_endpoints</code> -
(Optional)
A list of cluster endpoints
Structure is <a href="#nested_cluster_endpoints">documented below</a>.</p></li>
<li><p><code>project</code> - (Optional) The ID of the project in which the resource belongs.
If it is not provided, the provider project is used.</p></li>
</ul>

<p><a name="nested_cluster_endpoints"></a>The <code>cluster_endpoints</code> block supports:</p>

<ul>
<li><code>connections</code> -
(Optional)
Structure is <a href="#nested_cluster_endpoints_cluster_endpoints_connections">documented below</a>.</li>
</ul>

<p><a name="nested_cluster_endpoints_cluster_endpoints_connections"></a>The <code>connections</code> block supports:</p>

<ul>
<li><code>psc_connection</code> -
(Optional)
Detailed information of a PSC connection that is created by the customer
who owns the cluster.
Structure is <a href="#nested_cluster_endpoints_cluster_endpoints_connections_connections_psc_connection">documented below</a>.</li>
</ul>

<p><a name="nested_cluster_endpoints_cluster_endpoints_connections_connections_psc_connection"></a>The <code>psc_connection</code> block supports:</p>

<ul>
<li><p><code>psc_connection_id</code> -
(Required)
The PSC connection id of the forwarding rule connected to the
service attachment.</p></li>
<li><p><code>address</code> -
(Required)
The IP allocated on the consumer network for the PSC forwarding rule.</p></li>
<li><p><code>forwarding_rule</code> -
(Required)
The URI of the consumer side forwarding rule.
Format:
projects/{project}/regions/{region}/forwardingRules/{forwarding_rule}</p></li>
<li><p><code>project_id</code> -
(Optional)
The consumer project_id where the forwarding rule is created from.</p></li>
<li><p><code>network</code> -
(Required)
The consumer network where the IP address resides, in the form of
projects/{project_id}/global/networks/{network_id}.</p></li>
<li><p><code>service_attachment</code> -
(Required)
The service attachment which is the target of the PSC connection, in the form of projects/{project-id}/regions/{region}/serviceAttachments/{service-attachment-id}.</p></li>
<li><p><code>psc_connection_status</code> -
(Output)
Output Only. The status of the PSC connection: whether a connection exists and ACTIVE or it no longer exists. 
Possible values:
ACTIVE 
NOT_FOUND</p></li>
<li><p><code>connection_type</code> -
(Output)
Output Only. Type of a PSC Connection. 
Possible values:
CONNECTION_TYPE_DISCOVERY 
CONNECTION_TYPE_PRIMARY 
CONNECTION_TYPE_READER</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the arguments listed above, the following computed attributes are exported:</p>

<ul>
<li><code>id</code> - an identifier for the resource with format <code>projects/{{project}}/locations/{{region}}/clusters/{{name}}</code></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>This resource provides the following
<a href="https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts">Timeouts</a> configuration options:</p>

<ul>
<li><code>create</code> - Default is 60 minutes.</li>
<li><code>update</code> - Default is 120 minutes.</li>
<li><code>delete</code> - Default is 30 minutes.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>ClusterUserCreatedConnections can be imported using any of these accepted formats:</p>

<ul>
<li><code>projects/{{project}}/locations/{{region}}/clusters/{{name}}</code></li>
<li><code>{{project}}/{{region}}/{{name}}</code></li>
<li><code>{{region}}/{{name}}</code></li>
<li><code>{{name}}</code></li>
</ul>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import ClusterUserCreatedConnections using one of the formats above. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"projects/{{project}}/locations/{{region}}/clusters/{{name}}"</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_redis_cluster_user_created_connections.default</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>When using the <a href="https://developer.hashicorp.com/terraform/cli/commands/import"><code>terraform import</code> command</a>, ClusterUserCreatedConnections can be imported using one of the formats above. For example:</p>

<pre><code>$ terraform import google_redis_cluster_user_created_connections.default projects/{{project}}/locations/{{region}}/clusters/{{name}}
$ terraform import google_redis_cluster_user_created_connections.default {{project}}/{{region}}/{{name}}
$ terraform import google_redis_cluster_user_created_connections.default {{region}}/{{name}}
$ terraform import google_redis_cluster_user_created_connections.default {{name}}
</code></pre>

<a class="dashAnchor" name="//apple_ref/cpp/Section/User%20Project%20Overrides"></a><h2 id="user-project-overrides">User Project Overrides</h2>

<p>This resource supports <a href="https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#user_project_override">User Project Overrides</a>.</p>

            
        
    </body></html>