<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/scc_organization_custom_module --><head>
                <title>google_scc_organization_custom_module</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="google_scc_organization_custom_module">google_scc_organization_custom_module</h1>

<p>Represents an instance of a Security Health Analytics custom module, including
its full module name, display name, enablement state, and last updated time.
You can create a custom module at the organization, folder, or project level.
Custom modules that you create at the organization or folder level are inherited
by the child folders and projects.</p>

<p>To get more information about OrganizationCustomModule, see:</p>

<ul>
<li><a href="https://cloud.google.com/security-command-center/docs/reference/rest/v1/organizations.securityHealthAnalyticsSettings.customModules">API documentation</a></li>
<li>How-to Guides
<ul>
<li><a href="https://cloud.google.com/security-command-center/docs/custom-modules-sha-overview">Overview of custom modules for Security Health Analytics</a></li>
</ul></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Scc%20Organization%20Custom%20Module%20Basic"></a><h2 id="example-usage-scc-organization-custom-module-basic">Example Usage - Scc Organization Custom Module Basic</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_scc_organization_custom_module"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">organization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"123456789"</span><span class="w"></span>
<span class="w">  </span><span class="na">display_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"basic_custom_module"</span><span class="w"></span>
<span class="w">  </span><span class="na">enablement_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="w"></span>
<span class="w">  </span><span class="nb">custom_config</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">predicate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.rotationPeriod &gt; duration(\"2592000s\")"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">resource_selector</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">resource_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">"cloudkms.googleapis.com/CryptoKey"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"The rotation period of the identified cryptokey resource exceeds 30 days."</span><span class="w"></span>
<span class="w">    </span><span class="na">recommendation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Set the rotation period to at most 30 days."</span><span class="w"></span>
<span class="w">    </span><span class="na">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"MEDIUM"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage%20-%20Scc%20Organization%20Custom%20Module%20Full"></a><h2 id="example-usage-scc-organization-custom-module-full">Example Usage - Scc Organization Custom Module Full</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"google_scc_organization_custom_module"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">organization</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"123456789"</span><span class="w"></span>
<span class="w">  </span><span class="na">display_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"full_custom_module"</span><span class="w"></span>
<span class="w">  </span><span class="na">enablement_state</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"ENABLED"</span><span class="w"></span>
<span class="w">  </span><span class="nb">custom_config</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="nb">predicate</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.rotationPeriod &gt; duration(\"2592000s\")"</span><span class="w"></span>
<span class="w">      </span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Purpose of the expression"</span><span class="w"></span>
<span class="w">      </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"description of the expression"</span><span class="w"></span>
<span class="w">      </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"location of the expression"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">custom_output</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="nb">properties</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"duration"</span><span class="w"></span>
<span class="w">        </span><span class="nb">value_expression</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="na">expression</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"resource.rotationPeriod"</span><span class="w"></span>
<span class="w">          </span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Purpose of the expression"</span><span class="w"></span>
<span class="w">          </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"description of the expression"</span><span class="w"></span>
<span class="w">          </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"location of the expression"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">resource_selector</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">resource_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="s2">"cloudkms.googleapis.com/CryptoKey"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="p">]</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="na">severity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LOW"</span><span class="w"></span>
<span class="w">    </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Description of the custom module"</span><span class="w"></span>
<span class="w">    </span><span class="na">recommendation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Steps to resolve violation"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>display_name</code> -
(Required)
The display name of the Security Health Analytics custom module. This
display name becomes the finding category for all findings that are
returned by this custom module. The display name must be between 1 and
128 characters, start with a lowercase letter, and contain alphanumeric
characters or underscores only.</p></li>
<li><p><code>enablement_state</code> -
(Required)
The enablement state of the custom module.
Possible values are: <code>ENABLED</code>, <code>DISABLED</code>.</p></li>
<li><p><code>custom_config</code> -
(Required)
The user specified custom configuration for the module.
Structure is <a href="#nested_custom_config">documented below</a>.</p></li>
<li><p><code>organization</code> -
(Required)
Numerical ID of the parent organization.</p></li>
</ul>

<p><a name="nested_custom_config"></a>The <code>custom_config</code> block supports:</p>

<ul>
<li><p><code>predicate</code> -
(Required)
The CEL expression to evaluate to produce findings. When the expression evaluates
to true against a resource, a finding is generated.
Structure is <a href="#nested_custom_config_predicate">documented below</a>.</p></li>
<li><p><code>custom_output</code> -
(Optional)
Custom output properties.
Structure is <a href="#nested_custom_config_custom_output">documented below</a>.</p></li>
<li><p><code>resource_selector</code> -
(Required)
The resource types that the custom module operates on. Each custom module
can specify up to 5 resource types.
Structure is <a href="#nested_custom_config_resource_selector">documented below</a>.</p></li>
<li><p><code>severity</code> -
(Required)
The severity to assign to findings generated by the module.
Possible values are: <code>CRITICAL</code>, <code>HIGH</code>, <code>MEDIUM</code>, <code>LOW</code>.</p></li>
<li><p><code>description</code> -
(Optional)
Text that describes the vulnerability or misconfiguration that the custom
module detects. This explanation is returned with each finding instance to
help investigators understand the detected issue. The text must be enclosed in quotation marks.</p></li>
<li><p><code>recommendation</code> -
(Required)
An explanation of the recommended steps that security teams can take to resolve
the detected issue. This explanation is returned with each finding generated by
this module in the nextSteps property of the finding JSON.</p></li>
</ul>

<p><a name="nested_custom_config_predicate"></a>The <code>predicate</code> block supports:</p>

<ul>
<li><p><code>expression</code> -
(Required)
Textual representation of an expression in Common Expression Language syntax.</p></li>
<li><p><code>title</code> -
(Optional)
Title for the expression, i.e. a short string describing its purpose. This can
be used e.g. in UIs which allow to enter the expression.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the expression. This is a longer text which describes the
expression, e.g. when hovered over it in a UI.</p></li>
<li><p><code>location</code> -
(Optional)
String indicating the location of the expression for error reporting, e.g. a
file name and a position in the file.</p></li>
</ul>

<p><a name="nested_custom_config_custom_output"></a>The <code>custom_output</code> block supports:</p>

<ul>
<li><code>properties</code> -
(Optional)
A list of custom output properties to add to the finding.
Structure is <a href="#nested_custom_config_custom_output_properties">documented below</a>.</li>
</ul>

<p><a name="nested_custom_config_custom_output_properties"></a>The <code>properties</code> block supports:</p>

<ul>
<li><p><code>name</code> -
(Optional)
Name of the property for the custom output.</p></li>
<li><p><code>value_expression</code> -
(Optional)
The CEL expression for the custom output. A resource property can be specified
to return the value of the property or a text string enclosed in quotation marks.
Structure is <a href="#nested_custom_config_custom_output_properties_properties_value_expression">documented below</a>.</p></li>
</ul>

<p><a name="nested_custom_config_custom_output_properties_properties_value_expression"></a>The <code>value_expression</code> block supports:</p>

<ul>
<li><p><code>expression</code> -
(Required)
Textual representation of an expression in Common Expression Language syntax.</p></li>
<li><p><code>title</code> -
(Optional)
Title for the expression, i.e. a short string describing its purpose. This can
be used e.g. in UIs which allow to enter the expression.</p></li>
<li><p><code>description</code> -
(Optional)
Description of the expression. This is a longer text which describes the
expression, e.g. when hovered over it in a UI.</p></li>
<li><p><code>location</code> -
(Optional)
String indicating the location of the expression for error reporting, e.g. a
file name and a position in the file.</p></li>
</ul>

<p><a name="nested_custom_config_resource_selector"></a>The <code>resource_selector</code> block supports:</p>

<ul>
<li><code>resource_types</code> -
(Required)
The resource types to run the detector on.</li>
</ul>

<hr/>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the arguments listed above, the following computed attributes are exported:</p>

<ul>
<li><p><code>id</code> - an identifier for the resource with format <code>organizations/{{organization}}/securityHealthAnalyticsSettings/customModules/{{name}}</code></p></li>
<li><p><code>name</code> -
The resource name of the custom module. Its format is "organizations/{org_id}/securityHealthAnalyticsSettings/customModules/{customModule}".
The id {customModule} is server-generated and is not user settable. It will be a numeric id containing 1-20 digits.</p></li>
<li><p><code>update_time</code> -
The time at which the custom module was last updated.
A timestamp in RFC3339 UTC "Zulu" format, with nanosecond resolution and
up to nine fractional digits. Examples: "2014-10-02T15:01:23Z" and "2014-10-02T15:01:23.045123456Z".</p></li>
<li><p><code>last_editor</code> -
The editor that last updated the custom module.</p></li>
<li><p><code>ancestor_module</code> -
If empty, indicates that the custom module was created in the organization, folder,
or project in which you are viewing the custom module. Otherwise, ancestor_module
specifies the organization or folder from which the custom module is inherited.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>This resource provides the following
<a href="https://developer.hashicorp.com/terraform/plugin/sdkv2/resources/retries-and-customizable-timeouts">Timeouts</a> configuration options:</p>

<ul>
<li><code>create</code> - Default is 20 minutes.</li>
<li><code>update</code> - Default is 20 minutes.</li>
<li><code>delete</code> - Default is 20 minutes.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>OrganizationCustomModule can be imported using any of these accepted formats:</p>

<ul>
<li><code>organizations/{{organization}}/securityHealthAnalyticsSettings/customModules/{{name}}</code></li>
<li><code>{{organization}}/{{name}}</code></li>
</ul>

<p>In Terraform v1.5.0 and later, use an <a href="https://developer.hashicorp.com/terraform/language/import"><code>import</code> block</a> to import OrganizationCustomModule using one of the formats above. For example:</p>

<div class="codehilite"><pre><span></span><code><span class="nb">import</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"organizations/{{organization}}/securityHealthAnalyticsSettings/customModules/{{name}}"</span><span class="w"></span>
<span class="w">  </span><span class="na">to</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">google_scc_organization_custom_module.default</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>When using the <a href="https://developer.hashicorp.com/terraform/cli/commands/import"><code>terraform import</code> command</a>, OrganizationCustomModule can be imported using one of the formats above. For example:</p>

<pre><code>$ terraform import google_scc_organization_custom_module.default organizations/{{organization}}/securityHealthAnalyticsSettings/customModules/{{name}}
$ terraform import google_scc_organization_custom_module.default {{organization}}/{{name}}
</code></pre>

            
        
    </body></html>