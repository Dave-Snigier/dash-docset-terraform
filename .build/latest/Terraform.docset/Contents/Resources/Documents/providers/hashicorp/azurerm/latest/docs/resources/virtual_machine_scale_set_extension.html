<html><!-- Online page at https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/virtual_machine_scale_set_extension --><head>
                <title>azurerm_virtual_machine_scale_set_extension</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="azurerm_virtual_machine_scale_set_extension">azurerm_virtual_machine_scale_set_extension</h1>

<p>Manages an Extension for a Virtual Machine Scale Set.</p>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>This resource is not intended to be used with the <code>azurerm_virtual_machine_scale_set</code> resource - instead it's intended for this to be used with the <code>azurerm_linux_virtual_machine_scale_set</code> and <code>azurerm_windows_virtual_machine_scale_set</code> resources.</p>
</aside>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_resource_group"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"West Europe"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_linux_virtual_machine_scale_set"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>
<span class="w">  </span><span class="na">resource_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_resource_group.example.name</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_resource_group.example.location</span><span class="w"></span>
<span class="w">  </span><span class="na">sku</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"Standard_F2"</span><span class="w"></span>
<span class="w">  </span><span class="na">admin_username</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"adminuser"</span><span class="w"></span>
<span class="w">  </span><span class="na">instances</span><span class="w">           </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"></span>

<span class="w">  </span><span class="nb">source_image_reference</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">publisher</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Canonical"</span><span class="w"></span>
<span class="w">    </span><span class="na">offer</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"0001-com-ubuntu-server-jammy"</span><span class="w"></span>
<span class="w">    </span><span class="na">sku</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"22_04-lts"</span><span class="w"></span>
<span class="w">    </span><span class="na">version</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"latest"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">network_interface</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>

<span class="w">    </span><span class="nb">ip_configuration</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"internal"</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>

<span class="w">  </span><span class="nb">os_disk</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">storage_account_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Standard_LRS"</span><span class="w"></span>
<span class="w">    </span><span class="na">caching</span><span class="w">              </span><span class="o">=</span><span class="w"> </span><span class="s2">"ReadWrite"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_virtual_machine_scale_set_extension"</span><span class="w"> </span><span class="nv">"example"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                         </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>
<span class="w">  </span><span class="na">virtual_machine_scale_set_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_linux_virtual_machine_scale_set.example.id</span><span class="w"></span>
<span class="w">  </span><span class="na">publisher</span><span class="w">                    </span><span class="o">=</span><span class="w"> </span><span class="s2">"Microsoft.Azure.Extensions"</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">                         </span><span class="o">=</span><span class="w"> </span><span class="s2">"CustomScript"</span><span class="w"></span>
<span class="w">  </span><span class="na">type_handler_version</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="s2">"2.0"</span><span class="w"></span>
<span class="w">  </span><span class="na">settings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsonencode</span><span class="p">({</span><span class="w"></span>
<span class="w">    </span><span class="s2">"commandToExecute"</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"echo $HOSTNAME"</span><span class="w"></span>
<span class="w">  </span><span class="p">})</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><p><code>name</code> - (Required) The name for the Virtual Machine Scale Set Extension. Changing this forces a new resource to be created.</p></li>
<li><p><code>virtual_machine_scale_set_id</code> - (Required) The ID of the Virtual Machine Scale Set. Changing this forces a new resource to be created.</p></li>
</ul>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>This should be the ID from the <code>azurerm_linux_virtual_machine_scale_set</code> or <code>azurerm_windows_virtual_machine_scale_set</code> resource - when using the older <code>azurerm_virtual_machine_scale_set</code> resource extensions should instead be defined inline.</p>
</aside>

<ul>
<li><p><code>publisher</code> - (Required) Specifies the Publisher of the Extension. Changing this forces a new resource to be created.</p></li>
<li><p><code>type</code> - (Required) Specifies the Type of the Extension. Changing this forces a new resource to be created.</p></li>
<li><p><code>type_handler_version</code> - (Required) Specifies the version of the extension to use, available versions can be found using the Azure CLI.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>The <code>Publisher</code> and <code>Type</code> of Virtual Machine Scale Set Extensions can be found using the Azure CLI, via:</p>
</aside>

<div class="codehilite"><pre><span></span><code>az vmss extension image list --location westus -o table
</code></pre></div>

<hr/>

<ul>
<li><p><code>auto_upgrade_minor_version</code> - (Optional) Should the latest version of the Extension be used at Deployment Time, if one is available? This won't auto-update the extension on existing installation. Defaults to <code>true</code>.</p></li>
<li><p><code>automatic_upgrade_enabled</code> - (Optional) Should the Extension be automatically updated whenever the Publisher releases a new version of this VM Extension? </p></li>
<li><p><code>failure_suppression_enabled</code> - (Optional) Should failures from the extension be suppressed? Possible values are <code>true</code> or <code>false</code>. Defaults to <code>false</code>.</p></li>
</ul>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>Operational failures such as not connecting to the VM will not be suppressed regardless of the <code>failure_suppression_enabled</code> value.</p>
</aside>

<ul>
<li><p><code>force_update_tag</code> - (Optional) A value which, when different to the previous value can be used to force-run the Extension even if the Extension Configuration hasn't changed.</p></li>
<li><p><code>protected_settings</code> - (Optional) A JSON String which specifies Sensitive Settings (such as Passwords) for the Extension.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>Keys within the <code>protected_settings</code> block are notoriously case-sensitive, where the casing required (e.g. TitleCase vs snakeCase) depends on the Extension being used. Please refer to the documentation for the specific Virtual Machine Extension you're looking to use for more information.</p>
</aside>

<ul>
<li><code>protected_settings_from_key_vault</code> - (Optional) A <code>protected_settings_from_key_vault</code> block as defined below.</li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p><code>protected_settings_from_key_vault</code> cannot be used with <code>protected_settings</code></p>
</aside>

<ul>
<li><p><code>provision_after_extensions</code> - (Optional) An ordered list of Extension names which this should be provisioned after.</p></li>
<li><p><code>settings</code> - (Optional) A JSON String which specifies Settings for the Extension.</p></li>
</ul>

<aside class="admonition warning">
    <strong>warning</strong>
    <em>warning</em>
    <p>Keys within the <code>settings</code> block are notoriously case-sensitive, where the casing required (e.g. TitleCase vs snakeCase) depends on the Extension being used. Please refer to the documentation for the specific Virtual Machine Extension you're looking to use for more information.</p>
</aside>

<hr/>

<p>A <code>protected_settings_from_key_vault</code> block supports the following:</p>

<ul>
<li><p><code>secret_url</code> - (Required) The URL to the Key Vault Secret which stores the protected settings.</p></li>
<li><p><code>source_vault_id</code> - (Required) The ID of the source Key Vault.</p></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>In addition to the Arguments listed above - the following Attributes are exported:</p>

<ul>
<li><code>id</code> - The ID of the Virtual Machine Scale Set Extension.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>The <code>timeouts</code> block allows you to specify <a href="https://www.terraform.io/language/resources/syntax#operation-timeouts">timeouts</a> for certain actions:</p>

<ul>
<li><code>create</code> - (Defaults to 30 minutes) Used when creating the Virtual Machine Scale Set Extension.</li>
<li><code>update</code> - (Defaults to 30 minutes) Used when updating the Virtual Machine Scale Set Extension.</li>
<li><code>read</code> - (Defaults to 5 minutes) Used when retrieving the Virtual Machine Scale Set Extension.</li>
<li><code>delete</code> - (Defaults to 30 minutes) Used when deleting the Virtual Machine Scale Set Extension.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>Virtual Machine Scale Set Extensions can be imported using the <code>resource id</code>, e.g.</p>

<div class="codehilite"><pre><span></span><code>terraform import azurerm_virtual_machine_scale_set_extension.test /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/group1/providers/Microsoft.Compute/virtualMachineScaleSets/scaleSet1/extensions/extension1
</code></pre></div>

            
        
    </body></html>