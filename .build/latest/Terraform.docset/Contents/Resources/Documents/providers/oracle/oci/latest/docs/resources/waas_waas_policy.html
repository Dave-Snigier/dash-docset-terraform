<html><!-- Online page at https://registry.terraform.io/providers/oracle/oci/latest/docs/resources/waas_waas_policy --><head>
                <title>oci_waas_waas_policy</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="oci_waas_waas_policy">oci_waas_waas_policy</h1>

<p>This resource provides the Waas Policy resource in Oracle Cloud Infrastructure Web Application Acceleration and Security service.</p>

<p>Creates a new Web Application Acceleration and Security (WAAS) policy in the specified compartment. A WAAS policy must be established before creating Web Application Firewall (WAF) rules. To use WAF rules, your web application's origin servers must defined in the <code>WaasPolicy</code> schema.</p>

<p>A domain name must be specified when creating a WAAS policy. The domain name should be different from the origins specified in your <code>WaasPolicy</code>. Once domain name is entered and stored, it is unchangeable.</p>

<p>Use the record data returned in the <code>cname</code> field of the <code>WaasPolicy</code> object to create a CNAME record in your DNS configuration that will direct your domain's traffic through the WAF.</p>

<p>For the purposes of access control, you must provide the OCID of the compartment where you want the service to reside. For information about access control and compartments, see <a href="https://docs.cloud.oracle.com/iaas/Content/Identity/Concepts/overview.htm">Overview of the IAM Service</a>.</p>

<p>You must specify a display name and domain for the WAAS policy. The display name does not have to be unique and can be changed. The domain name should be different from every origin specified in <code>WaasPolicy</code>.</p>

<p>All Oracle Cloud Infrastructure resources, including WAAS policies, receive a unique, Oracle-assigned ID called an Oracle Cloud Identifier (OCID). When a resource is created, you can find its OCID in the response. You can also retrieve a resource's OCID by using a list API operation for that resource type, or by viewing the resource in the Console. Fore more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm">Resource Identifiers</a>.</p>

<p><strong>Note:</strong> After sending the POST request, the new object's state will temporarily be <code>CREATING</code>. Ensure that the resource's state has changed to <code>ACTIVE</code> before use.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">resource</span><span class="w"> </span><span class="nc">"oci_waas_waas_policy"</span><span class="w"> </span><span class="nv">"test_waas_policy"</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">    #Required</span>
<span class="w">    </span><span class="na">compartment_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.compartment_id</span><span class="w"></span>
<span class="w">    </span><span class="na">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_domain</span><span class="c1"></span>

<span class="c1">    #Optional</span>
<span class="w">    </span><span class="na">additional_domains</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_additional_domains</span><span class="w"></span>
<span class="w">    </span><span class="nb">defined_tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"Operations.CostCenter"</span><span class="o">=</span><span class="w"> </span><span class="s2">"42"</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="na">display_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_display_name</span><span class="w"></span>
<span class="w">    </span><span class="nb">freeform_tags</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s2">"Department"</span><span class="o">=</span><span class="w"> </span><span class="s2">"Finance"</span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">origin_groups</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">        #Optional</span>
<span class="w">        </span><span class="na">origins</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_origin_groups_origins</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">origins</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">        #Required</span>
<span class="w">        </span><span class="na">uri</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_origins_uri</span><span class="c1"></span>

<span class="c1">        #Optional</span>
<span class="w">        </span><span class="nb">custom_headers</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_origins_custom_headers_name</span><span class="w"></span>
<span class="w">            </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_origins_custom_headers_value</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="na">http_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_origins_http_port</span><span class="w"></span>
<span class="w">        </span><span class="na">https_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_origins_https_port</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">policy_config</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">        #Optional</span>
<span class="w">        </span><span class="na">certificate_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">oci_waas_certificate.test_certificate.id</span><span class="w"></span>
<span class="w">        </span><span class="na">cipher_group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_cipher_group</span><span class="w"></span>
<span class="w">        </span><span class="na">client_address_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_client_address_header</span><span class="w"></span>
<span class="w">        </span><span class="nb">health_checks</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">expected_response_code_group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_expected_response_code_group</span><span class="w"></span>
<span class="w">            </span><span class="na">expected_response_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_expected_response_text</span><span class="w"></span>
<span class="w">            </span><span class="na">headers</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_headers</span><span class="w"></span>
<span class="w">            </span><span class="na">healthy_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_healthy_threshold</span><span class="w"></span>
<span class="w">            </span><span class="na">interval_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_interval_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">is_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_is_enabled</span><span class="w"></span>
<span class="w">            </span><span class="na">is_response_text_check_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_is_response_text_check_enabled</span><span class="w"></span>
<span class="w">            </span><span class="na">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_method</span><span class="w"></span>
<span class="w">            </span><span class="na">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_path</span><span class="w"></span>
<span class="w">            </span><span class="na">timeout_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_timeout_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">unhealthy_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_health_checks_unhealthy_threshold</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="na">is_behind_cdn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_behind_cdn</span><span class="w"></span>
<span class="w">        </span><span class="na">is_cache_control_respected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_cache_control_respected</span><span class="w"></span>
<span class="w">        </span><span class="na">is_https_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_https_enabled</span><span class="w"></span>
<span class="w">        </span><span class="na">is_https_forced</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_https_forced</span><span class="w"></span>
<span class="w">        </span><span class="na">is_origin_compression_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_origin_compression_enabled</span><span class="w"></span>
<span class="w">        </span><span class="na">is_response_buffering_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_response_buffering_enabled</span><span class="w"></span>
<span class="w">        </span><span class="na">is_sni_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_is_sni_enabled</span><span class="w"></span>
<span class="w">        </span><span class="nb">load_balancing_method</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_load_balancing_method_method</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">domain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_load_balancing_method_domain</span><span class="w"></span>
<span class="w">            </span><span class="na">expiration_time_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_load_balancing_method_expiration_time_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_load_balancing_method_name</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="na">tls_protocols</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_tls_protocols</span><span class="w"></span>
<span class="w">        </span><span class="na">websocket_path_prefixes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_policy_config_websocket_path_prefixes</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="nb">waf_config</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">        #Optional</span>
<span class="w">        </span><span class="nb">access_rules</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_action</span><span class="w"></span>
<span class="w">            </span><span class="nb">criteria</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">                #Required</span>
<span class="w">                </span><span class="na">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_criteria_condition</span><span class="w"></span>
<span class="w">                </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_criteria_value</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">is_case_sensitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_criteria_is_case_sensitive</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_name</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">block_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_block_action</span><span class="w"></span>
<span class="w">            </span><span class="na">block_error_page_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_block_error_page_code</span><span class="w"></span>
<span class="w">            </span><span class="na">block_error_page_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_block_error_page_description</span><span class="w"></span>
<span class="w">            </span><span class="na">block_error_page_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_block_error_page_message</span><span class="w"></span>
<span class="w">            </span><span class="na">block_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_block_response_code</span><span class="w"></span>
<span class="w">            </span><span class="na">bypass_challenges</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_bypass_challenges</span><span class="w"></span>
<span class="w">            </span><span class="na">captcha_footer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_captcha_footer</span><span class="w"></span>
<span class="w">            </span><span class="na">captcha_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_captcha_header</span><span class="w"></span>
<span class="w">            </span><span class="na">captcha_submit_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_captcha_submit_label</span><span class="w"></span>
<span class="w">            </span><span class="na">captcha_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_captcha_title</span><span class="w"></span>
<span class="w">            </span><span class="na">redirect_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_redirect_response_code</span><span class="w"></span>
<span class="w">            </span><span class="na">redirect_url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_redirect_url</span><span class="w"></span>
<span class="w">            </span><span class="nb">response_header_manipulation</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">                #Required</span>
<span class="w">                </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_response_header_manipulation_action</span><span class="w"></span>
<span class="w">                </span><span class="na">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_response_header_manipulation_header</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_access_rules_response_header_manipulation_value</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">address_rate_limiting</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">is_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_address_rate_limiting_is_enabled</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">allowed_rate_per_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_address_rate_limiting_allowed_rate_per_address</span><span class="w"></span>
<span class="w">            </span><span class="na">block_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_address_rate_limiting_block_response_code</span><span class="w"></span>
<span class="w">            </span><span class="na">max_delayed_count_per_address</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_address_rate_limiting_max_delayed_count_per_address</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">caching_rules</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_action</span><span class="w"></span>
<span class="w">            </span><span class="nb">criteria</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">                #Required</span>
<span class="w">                </span><span class="na">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_criteria_condition</span><span class="w"></span>
<span class="w">                </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_criteria_value</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_name</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">caching_duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_caching_duration</span><span class="w"></span>
<span class="w">            </span><span class="na">client_caching_duration</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_client_caching_duration</span><span class="w"></span>
<span class="w">            </span><span class="na">is_client_caching_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_is_client_caching_enabled</span><span class="w"></span>
<span class="w">            </span><span class="na">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_caching_rules_key</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">captchas</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">failure_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_failure_message</span><span class="w"></span>
<span class="w">            </span><span class="na">session_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_session_expiration_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">submit_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_submit_label</span><span class="w"></span>
<span class="w">            </span><span class="na">title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_title</span><span class="w"></span>
<span class="w">            </span><span class="na">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_url</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">footer_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_footer_text</span><span class="w"></span>
<span class="w">            </span><span class="na">header_text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_captchas_header_text</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">custom_protection_rules</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_custom_protection_rules_action</span><span class="w"></span>
<span class="w">            </span><span class="nb">exclusions</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">exclusions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_custom_protection_rules_exclusions_exclusions</span><span class="w"></span>
<span class="w">                </span><span class="na">target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_custom_protection_rules_exclusions_target</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_custom_protection_rules_id</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">device_fingerprint_challenge</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">is_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_is_enabled</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_action</span><span class="w"></span>
<span class="w">            </span><span class="na">action_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_action_expiration_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="nb">challenge_settings</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">block_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_block_action</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_block_error_page_code</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_block_error_page_description</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_block_error_page_message</span><span class="w"></span>
<span class="w">                </span><span class="na">block_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_block_response_code</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_footer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_captcha_footer</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_captcha_header</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_submit_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_captcha_submit_label</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_challenge_settings_captcha_title</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">failure_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_failure_threshold</span><span class="w"></span>
<span class="w">            </span><span class="na">failure_threshold_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_failure_threshold_expiration_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">max_address_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_max_address_count</span><span class="w"></span>
<span class="w">            </span><span class="na">max_address_count_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_device_fingerprint_challenge_max_address_count_expiration_in_seconds</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">human_interaction_challenge</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">is_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_is_enabled</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_action</span><span class="w"></span>
<span class="w">            </span><span class="na">action_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_action_expiration_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="nb">challenge_settings</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">block_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_block_action</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_block_error_page_code</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_block_error_page_description</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_block_error_page_message</span><span class="w"></span>
<span class="w">                </span><span class="na">block_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_block_response_code</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_footer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_captcha_footer</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_captcha_header</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_submit_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_captcha_submit_label</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_challenge_settings_captcha_title</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">failure_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_failure_threshold</span><span class="w"></span>
<span class="w">            </span><span class="na">failure_threshold_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_failure_threshold_expiration_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">interaction_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_interaction_threshold</span><span class="w"></span>
<span class="w">            </span><span class="na">is_nat_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_is_nat_enabled</span><span class="w"></span>
<span class="w">            </span><span class="na">recording_period_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_recording_period_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="nb">set_http_header</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">                #Required</span>
<span class="w">                </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_set_http_header_name</span><span class="w"></span>
<span class="w">                </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_human_interaction_challenge_set_http_header_value</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">js_challenge</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">is_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_is_enabled</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_action</span><span class="w"></span>
<span class="w">            </span><span class="na">action_expiration_in_seconds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_action_expiration_in_seconds</span><span class="w"></span>
<span class="w">            </span><span class="na">are_redirects_challenged</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_are_redirects_challenged</span><span class="w"></span>
<span class="w">            </span><span class="nb">challenge_settings</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">block_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_block_action</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_block_error_page_code</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_block_error_page_description</span><span class="w"></span>
<span class="w">                </span><span class="na">block_error_page_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_block_error_page_message</span><span class="w"></span>
<span class="w">                </span><span class="na">block_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_block_response_code</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_footer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_captcha_footer</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_captcha_header</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_submit_label</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_captcha_submit_label</span><span class="w"></span>
<span class="w">                </span><span class="na">captcha_title</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_challenge_settings_captcha_title</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="nb">criteria</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">                #Required</span>
<span class="w">                </span><span class="na">condition</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_criteria_condition</span><span class="w"></span>
<span class="w">                </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_criteria_value</span><span class="c1"></span>

<span class="c1">                #Optional</span>
<span class="w">                </span><span class="na">is_case_sensitive</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_criteria_is_case_sensitive</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">            </span><span class="na">failure_threshold</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_failure_threshold</span><span class="w"></span>
<span class="w">            </span><span class="na">is_nat_enabled</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_is_nat_enabled</span><span class="w"></span>
<span class="w">            </span><span class="nb">set_http_header</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">                #Required</span>
<span class="w">                </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_set_http_header_name</span><span class="w"></span>
<span class="w">                </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_js_challenge_set_http_header_value</span><span class="w"></span>
<span class="w">            </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="na">origin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_origin</span><span class="w"></span>
<span class="w">        </span><span class="na">origin_groups</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_origin_groups</span><span class="w"></span>
<span class="w">        </span><span class="nb">protection_settings</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">allowed_http_methods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_allowed_http_methods</span><span class="w"></span>
<span class="w">            </span><span class="na">block_action</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_block_action</span><span class="w"></span>
<span class="w">            </span><span class="na">block_error_page_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_block_error_page_code</span><span class="w"></span>
<span class="w">            </span><span class="na">block_error_page_description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_block_error_page_description</span><span class="w"></span>
<span class="w">            </span><span class="na">block_error_page_message</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_block_error_page_message</span><span class="w"></span>
<span class="w">            </span><span class="na">block_response_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_block_response_code</span><span class="w"></span>
<span class="w">            </span><span class="na">is_response_inspected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_is_response_inspected</span><span class="w"></span>
<span class="w">            </span><span class="na">max_argument_count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_max_argument_count</span><span class="w"></span>
<span class="w">            </span><span class="na">max_name_length_per_argument</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_max_name_length_per_argument</span><span class="w"></span>
<span class="w">            </span><span class="na">max_response_size_in_ki_b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_max_response_size_in_ki_b</span><span class="w"></span>
<span class="w">            </span><span class="na">max_total_name_length_of_arguments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_max_total_name_length_of_arguments</span><span class="w"></span>
<span class="w">            </span><span class="na">media_types</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_media_types</span><span class="w"></span>
<span class="w">            </span><span class="na">recommendations_period_in_days</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_protection_settings_recommendations_period_in_days</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="nb">whitelists</span><span class="w"> </span><span class="p">{</span><span class="c1"></span>
<span class="c1">            #Required</span>
<span class="w">            </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_whitelists_name</span><span class="c1"></span>

<span class="c1">            #Optional</span>
<span class="w">            </span><span class="na">address_lists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_whitelists_address_lists</span><span class="w"></span>
<span class="w">            </span><span class="na">addresses</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.waas_policy_waf_config_whitelists_addresses</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><code>additional_domains</code> - (Optional) (Updatable) An array of additional domains for the specified web application.</li>
<li><code>compartment_id</code> - (Required) (Updatable) The <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm">OCID</a> of the compartment in which to create the WAAS policy.</li>
<li><code>defined_tags</code> - (Optional) (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a>.  Example: <code>{"Operations.CostCenter": "42"}</code> </li>
<li><code>display_name</code> - (Optional) (Updatable) A user-friendly name for the WAAS policy. The name can be changed and does not need to be unique.</li>
<li><code>domain</code> - (Required) The web application domain that the WAAS policy protects.</li>
<li><code>freeform_tags</code> - (Optional) (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a>.  Example: <code>{"Department": "Finance"}</code> </li>
<li><code>origin_groups</code> - (Optional) (Updatable) The map of origin groups and their keys used to associate origins to the <code>wafConfig</code>. Origin groups allow you to apply weights to groups of origins for load balancing purposes. Origins with higher weights will receive larger proportions of client requests. To add additional origins to your WAAS policy, update the <code>origins</code> field of a <code>UpdateWaasPolicy</code> request.
<ul>
<li><code>origins</code> - (Optional) (Updatable) The list of objects containing origin references and additional properties.</li>
</ul></li>
<li><code>origins</code> - (Optional) (Updatable) A map of host to origin for the web application. The key should be a customer friendly name for the host, ex. primary, secondary, etc.
<ul>
<li><code>custom_headers</code> - (Optional) (Updatable) A list of HTTP headers to forward to your origin.
<ul>
<li><code>name</code> - (Required) (Updatable) The name of the header.</li>
<li><code>value</code> - (Required) (Updatable) The value of the header.</li>
</ul></li>
<li><code>http_port</code> - (Optional) (Updatable) The HTTP port on the origin that the web application listens on. If unspecified, defaults to <code>80</code>. If <code>0</code> is specified - the origin is not used for HTTP traffic.</li>
<li><code>https_port</code> - (Optional) (Updatable) The HTTPS port on the origin that the web application listens on. If unspecified, defaults to <code>443</code>. If <code>0</code> is specified - the origin is not used for HTTPS traffic.</li>
<li><code>uri</code> - (Required) (Updatable) The URI of the origin. Does not support paths. Port numbers should be specified in the <code>httpPort</code> and <code>httpsPort</code> fields.</li>
</ul></li>
<li><p><code>policy_config</code> - (Optional) (Updatable) The configuration details for the WAAS policy.</p>

<ul>
<li><code>certificate_id</code> - (Optional) (Updatable) The OCID of the SSL certificate to use if HTTPS is supported.</li>
<li><code>cipher_group</code> - (Optional) (Updatable) The set cipher group for the configured TLS protocol. This sets the configuration for the TLS connections between clients and edge nodes only.
<ul>
<li><strong>DEFAULT:</strong> Cipher group supports TLS 1.0, TLS 1.1, TLS 1.2, TLS 1.3 protocols. It has the following ciphers enabled: <code>ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:!DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA</code></li>
</ul></li>
<li><p><code>client_address_header</code> - (Optional) (Updatable) Specifies an HTTP header name which is treated as the connecting client's IP address. Applicable only if <code>isBehindCdn</code> is enabled.</p>

<p>The edge node reads this header and its value and sets the client IP address as specified. It does not create the header if the header is not present in the request. If the header is not present, the connecting IP address will be used as the client's true IP address. It uses the last IP address in the header's value as the true IP address.</p>

<p>Example: <code>X-Client-Ip: 11.1.1.1, 13.3.3.3</code></p>

<p>In the case of multiple headers with the same name, only the first header will be used. It is assumed that CDN sets the correct client IP address to prevent spoofing.</p>

<ul>
<li><strong>X_FORWARDED_FOR:</strong> Corresponds to <code>X-Forwarded-For</code> header name.</li>
<li><strong>X_CLIENT_IP:</strong> Corresponds to <code>X-Client-Ip</code> header name.</li>
<li><strong>X_REAL_IP:</strong> Corresponds to <code>X-Real-Ip</code> header name.</li>
<li><strong>CLIENT_IP:</strong> Corresponds to <code>Client-Ip</code> header name.</li>
<li><strong>TRUE_CLIENT_IP:</strong> Corresponds to <code>True-Client-Ip</code> header name.</li>
</ul></li>
<li><p><code>health_checks</code> - (Optional) (Updatable) Health checks monitor the status of your origin servers and only route traffic to the origins that pass the health check. If the health check fails, origin is automatically removed from the load balancing. There is roughly one health check per EDGE POP per period. Any checks that pass will be reported as "healthy".</p>

<ul>
<li><code>expected_response_code_group</code> - (Optional) (Updatable) The HTTP response codes that signify a healthy state.
<ul>
<li><strong>2XX:</strong> Success response code group.</li>
<li><strong>3XX:</strong> Redirection response code group.</li>
<li><strong>4XX:</strong> Client errors response code group.</li>
<li><strong>5XX:</strong> Server errors response code group.</li>
</ul></li>
<li><code>expected_response_text</code> - (Optional) (Updatable) Health check will search for the given text in a case-sensitive manner within the response body and will fail if the text is not found.</li>
<li><p><code>headers</code> - (Optional) (Updatable) HTTP header fields to include in health check requests, expressed as <code>"name": "value"</code> properties. Because HTTP header field names are case-insensitive, any use of names that are case-insensitive equal to other names will be rejected. If Host is not specified, requests will include a Host header field with value matching the policy's protected domain. If User-Agent is not specified, requests will include a User-Agent header field with value "waf health checks".</p>

<p><strong>Note:</strong> The only currently-supported header fields are Host and User-Agent.</p></li>
<li><code>healthy_threshold</code> - (Optional) (Updatable) Number of successful health checks after which the server is marked up.</li>
<li><code>interval_in_seconds</code> - (Optional) (Updatable) Time between health checks of an individual origin server, in seconds.</li>
<li><code>is_enabled</code> - (Optional) (Updatable) Enables or disables the health checks.</li>
<li><code>is_response_text_check_enabled</code> - (Optional) (Updatable) Enables or disables additional check for predefined text in addition to response code.</li>
<li><code>method</code> - (Optional) (Updatable) An HTTP verb (i.e. HEAD, GET, or POST) to use when performing the health check.</li>
<li><code>path</code> - (Optional) (Updatable) Path to visit on your origins when performing the health check.</li>
<li><code>timeout_in_seconds</code> - (Optional) (Updatable) Response timeout represents wait time until request is considered failed, in seconds.</li>
<li><code>unhealthy_threshold</code> - (Optional) (Updatable) Number of failed health checks after which the server is marked down.</li>
</ul></li>
<li><code>is_behind_cdn</code> - (Optional) (Updatable) Enabling <code>isBehindCdn</code> allows for the collection of IP addresses from client requests if the WAF is connected to a CDN.</li>
<li><code>is_cache_control_respected</code> - (Optional) (Updatable) Enable or disable automatic content caching based on the response <code>cache-control</code> header. This feature enables the origin to act as a proxy cache. Caching is usually defined using <code>cache-control</code> header. For example <code>cache-control: max-age=120</code> means that the returned resource is valid for 120 seconds. Caching rules will overwrite this setting.</li>
<li><code>is_https_enabled</code> - (Optional) (Updatable) Enable or disable HTTPS support. If true, a <code>certificateId</code> is required. If unspecified, defaults to <code>false</code>.</li>
<li><code>is_https_forced</code> - (Optional) (Updatable) Force HTTP to HTTPS redirection. If unspecified, defaults to <code>false</code>.</li>
<li><code>is_origin_compression_enabled</code> - (Optional) (Updatable) Enable or disable GZIP compression of origin responses. If enabled, the header <code>Accept-Encoding: gzip</code> is sent to origin, otherwise, the empty <code>Accept-Encoding:</code> header is used.</li>
<li><code>is_response_buffering_enabled</code> - (Optional) (Updatable) Enable or disable buffering of responses from the origin. Buffering improves overall stability in case of network issues, but slightly increases Time To First Byte.</li>
<li><code>is_sni_enabled</code> - (Optional) (Updatable) SNI stands for Server Name Indication and is an extension of the TLS protocol. It indicates which hostname is being contacted by the browser at the beginning of the 'handshake'-process. This allows a server to connect multiple SSL Certificates to one IP address and port.</li>
<li><code>load_balancing_method</code> - (Optional) (Updatable) An object that represents a load balancing method and its properties.
<ul>
<li><code>domain</code> - (Applicable when method=STICKY_COOKIE) (Updatable) The domain for which the cookie is set, defaults to WAAS policy domain. </li>
<li><code>expiration_time_in_seconds</code> - (Applicable when method=STICKY_COOKIE) (Updatable) The time for which a browser should keep the cookie in seconds. Empty value will cause the cookie to expire at the end of a browser session. </li>
<li><code>method</code> - (Required) (Updatable) Load balancing methods are algorithms used to efficiently distribute traffic among origin servers.
<ul>
<li><strong><a href="../iaas/api.html#/en/waas/latest/datatypes/IPHashLoadBalancingMethod">IP_HASH</a>:</strong> All the incoming requests from the same client IP address should go to the same content origination server. IP_HASH load balancing method uses origin weights when choosing which origin should the hash be assigned to initially.</li>
<li><strong><a href="../iaas/api.html#/en/waas/latest/datatypes/RoundRobinLoadBalancingMethod">ROUND_ROBIN</a>:</strong> Forwards requests sequentially to the available origin servers. The first request - to the first origin server, the second request - to the next origin server, and so on. After it sends a request to the last origin server, it starts again with the first origin server. When using weights on origins, Weighted Round Robin assigns more requests to origins with a greater weight. Over a period of time, origins will receive a number of requests in proportion to their weight.</li>
<li><strong><a href="../iaas/api.html#/en/waas/latest/datatypes/StickyCookieLoadBalancingMethod">STICKY_COOKIE</a>:</strong> Adds a session cookie to the first response from the origin server and identifies the server that sent the response. The client's next request contains the cookie value, and nginx routes the request to the origin server that responded to the first request. STICKY_COOKIE load balancing method falls back to Round Robin for the first request.</li>
</ul></li>
<li><code>name</code> - (Applicable when method=STICKY_COOKIE) (Updatable) The name of the cookie used to track the persistence. Can contain any US-ASCII character except separator or control character. </li>
</ul></li>
<li><p><code>tls_protocols</code> - (Optional) (Updatable) A list of allowed TLS protocols. Only applicable when HTTPS support is enabled. The TLS protocol is negotiated while the request is connecting and the most recent protocol supported by both the edge node and client browser will be selected. If no such version exists, the connection will be aborted.</p>

<ul>
<li><strong>TLS_V1:</strong> corresponds to TLS 1.0 specification.</li>
<li><strong>TLS_V1_1:</strong> corresponds to TLS 1.1 specification.</li>
<li><strong>TLS_V1_2:</strong> corresponds to TLS 1.2 specification.</li>
<li><strong>TLS_V1_3:</strong> corresponds to TLS 1.3 specification.</li>
</ul>

<p></p><p>Enabled TLS protocols must go in a row. For example if <code>TLS_v1_1</code> and <code>TLS_V1_3</code> are enabled, <code>TLS_V1_2</code> must be enabled too.</p></li>
<li><code>websocket_path_prefixes</code> - (Optional) (Updatable) ModSecurity is not capable to inspect WebSockets. Therefore paths specified here have WAF disabled if Connection request header from the client has the value Upgrade (case insensitive matching) and Upgrade request header has the value websocket (case insensitive matching). Paths matches if the concatenation of request URL path and query starts with the contents of the one of <code>websocketPathPrefixes</code> array value. In All other cases challenges, like JSC, HIC and etc., remain active.</li>
</ul><p></p></li>
<li><p><code>waf_config</code> - (Optional) (Updatable) The Web Application Firewall configuration for the WAAS policy creation.</p>

<ul>
<li><p><code>access_rules</code> - (Optional) (Updatable) The access rules applied to the Web Application Firewall. Access rules allow custom content access policies to be defined and <code>ALLOW</code>, <code>DETECT</code>, or <code>BLOCK</code> actions to be taken on a request when specified criteria are met.</p>

<ul>
<li><p><code>action</code> - (Required) (Updatable) The action to take when the access criteria are met for a rule. If unspecified, defaults to <code>ALLOW</code>.</p>

<ul>
<li><strong>ALLOW:</strong> Takes no action, just logs the request.</li>
<li><strong>DETECT:</strong> Takes no action, but creates an alert for the request.</li>
<li><strong>BLOCK:</strong> Blocks the request by returning specified response code or showing error page.</li>
<li><strong>BYPASS:</strong> Bypasses some or all challenges.</li>
<li><strong>REDIRECT:</strong> Redirects the request to the specified URL. These fields are required when <code>REDIRECT</code> is selected: <code>redirectUrl</code>, <code>redirectResponseCode</code>.</li>
<li><strong>SHOW_CAPTCHA:</strong> Show a CAPTCHA Challenge page instead of the requested page.</li>
</ul>

<p>Regardless of action, no further rules are processed once a rule is matched.</p></li>
<li><code>block_action</code> - (Optional) (Updatable) The method used to block requests if <code>action</code> is set to <code>BLOCK</code> and the access criteria are met. If unspecified, defaults to <code>SET_RESPONSE_CODE</code>.</li>
<li><code>block_error_page_code</code> - (Optional) (Updatable) The error code to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the access criteria are met. If unspecified, defaults to 'Access rules'.</li>
<li><code>block_error_page_description</code> - (Optional) (Updatable) The description text to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the access criteria are met. If unspecified, defaults to 'Access blocked by website owner. Please contact support.'</li>
<li><code>block_error_page_message</code> - (Optional) (Updatable) The message to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the access criteria are met. If unspecified, defaults to 'Access to the website is blocked.'</li>
<li><code>block_response_code</code> - (Optional) (Updatable) The response status code to return when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SET_RESPONSE_CODE</code>, and the access criteria are met. If unspecified, defaults to <code>403</code>. The list of available response codes: <code>200</code>, <code>201</code>, <code>202</code>, <code>204</code>, <code>206</code>, <code>300</code>, <code>301</code>, <code>302</code>, <code>303</code>, <code>304</code>, <code>307</code>, <code>400</code>, <code>401</code>, <code>403</code>, <code>404</code>, <code>405</code>, <code>408</code>, <code>409</code>, <code>411</code>, <code>412</code>, <code>413</code>, <code>414</code>, <code>415</code>, <code>416</code>, <code>422</code>, <code>444</code>, <code>494</code>, <code>495</code>, <code>496</code>, <code>497</code>, <code>499</code>, <code>500</code>, <code>501</code>, <code>502</code>, <code>503</code>, <code>504</code>, <code>507</code>.</li>
<li><code>bypass_challenges</code> - (Optional) (Updatable) The list of challenges to bypass when <code>action</code> is set to <code>BYPASS</code>. If unspecified or empty, all challenges are bypassed.


md5-9be74bd0930462a7f60478f671830562



<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>HTTP_METHOD_IS_NOT:</strong> Matches if the request is not identical to any of the contents of the <code>value</code> field. The <code>value</code> in this case is string with one or multiple HTTP methods separated by new line symbol \n The list of available methods: <code>GET</code>, <code>HEAD</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>CONNECT</code>, <code>OPTIONS</code>, <code>TRACE</code>, <code>PATCH</code></li>
</ul>

<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>COUNTRY_IS:</strong> Matches if the request originates from one of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>COUNTRY_IS_NOT:</strong> Matches if the request does not originate from any of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>USER_AGENT_IS:</strong> Matches if the requesting user agent is identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
<li><strong>USER_AGENT_IS_NOT:</strong> Matches if the requesting user agent is not identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
</ul></li>
<li><code>is_case_sensitive</code> - (Optional) (Updatable) When enabled, the condition will be matched with case-sensitive rules.</li>
<li><code>value</code> - (Required) (Updatable) The criteria value.</li>
</ul></li>
<li><code>name</code> - (Required) (Updatable) The unique name of the access rule.</li>
<li><code>redirect_response_code</code> - (Optional) (Updatable) The response status code to return when <code>action</code> is set to <code>REDIRECT</code>.
<ul>
<li><strong>MOVED_PERMANENTLY:</strong> Used for designating the permanent movement of a page (numerical code - 301).</li>
<li><strong>FOUND:</strong> Used for designating the temporary movement of a page (numerical code - 302).</li>
</ul></li>
<li><code>redirect_url</code> - (Optional) (Updatable) The target to which the request should be redirected, represented as a URI reference. Required when <code>action</code> is <code>REDIRECT</code>.</li>
<li><code>response_header_manipulation</code> - (Optional) (Updatable) An object that represents an action to apply to an HTTP response headers if all rule criteria will be matched regardless of <code>action</code> value.
<ul>
<li><code>action</code> - (Required) (Updatable) The action can be one of these values: <code>ADD_HTTP_RESPONSE_HEADER</code>, <code>EXTEND_HTTP_RESPONSE_HEADER</code>, <code>REMOVE_HTTP_RESPONSE_HEADER</code></li>
<li><code>header</code> - (Required) (Updatable) A header field name that conforms to RFC 7230.  Example: <code>example_header_name</code> </li>
<li><code>value</code> - (Required when action=ADD_HTTP_RESPONSE_HEADER | EXTEND_HTTP_RESPONSE_HEADER) (Updatable) A header field value that conforms to RFC 7230.  Example: <code>example_value</code> </li>
</ul></li>
</ul></li>
<li><code>address_rate_limiting</code> - (Optional) (Updatable) The settings used to limit the number of requests from an IP address.
<ul>
<li><code>allowed_rate_per_address</code> - (Optional) (Updatable) The number of allowed requests per second from one IP address. If unspecified, defaults to <code>1</code>.</li>
<li><code>block_response_code</code> - (Optional) (Updatable) The response status code returned when a request is blocked. If unspecified, defaults to <code>503</code>. The list of available response codes: <code>400</code>, <code>401</code>, <code>403</code>, <code>404</code>, <code>405</code>, <code>408</code>, <code>409</code>, <code>411</code>, <code>412</code>, <code>413</code>, <code>414</code>, <code>415</code>, <code>416</code>, <code>422</code>, <code>494</code>, <code>495</code>, <code>496</code>, <code>497</code>, <code>499</code>, <code>500</code>, <code>501</code>, <code>502</code>, <code>503</code>, <code>504</code>, <code>507</code>.</li>
<li><code>is_enabled</code> - (Required) (Updatable) Enables or disables the address rate limiting Web Application Firewall feature.</li>
<li><code>max_delayed_count_per_address</code> - (Optional) (Updatable) The maximum number of requests allowed to be queued before subsequent requests are dropped. If unspecified, defaults to <code>10</code>.</li>
</ul></li>
<li><p><code>caching_rules</code> - (Optional) (Updatable) A list of caching rules applied to the web application.</p>

<ul>
<li><code>action</code> - (Required) (Updatable) The action to take when the criteria of a caching rule are met.
<ul>
<li><strong>CACHE:</strong> Caches requested content when the criteria of the rule are met.</li>
<li><strong>BYPASS_CACHE:</strong> Allows requests to bypass the cache and be directed to the origin when the criteria of the rule is met.</li>
</ul></li>
<li><code>caching_duration</code> - (Optional) (Updatable) The duration to cache content for the caching rule, specified in ISO 8601 extended format. Supported units: seconds, minutes, hours, days, weeks, months. The maximum value that can be set for any unit is <code>99</code>. Mixing of multiple units is not supported. Only applies when the <code>action</code> is set to <code>CACHE</code>. Example: <code>PT1H</code></li>
<li><code>client_caching_duration</code> - (Optional) (Updatable) The duration to cache content in the user's browser, specified in ISO 8601 extended format. Supported units: seconds, minutes, hours, days, weeks, months. The maximum value that can be set for any unit is <code>99</code>. Mixing of multiple units is not supported. Only applies when the <code>action</code> is set to <code>CACHE</code>. Example: <code>PT1H</code></li>
<li><p><code>criteria</code> - (Required) (Updatable) The array of the rule criteria with condition and value. The caching rule would be applied for the requests that matched any of the listed conditions.</p>

<ul>
<li><p><code>condition</code> - (Required) (Updatable) The condition of the caching rule criteria.</p>

<ul>
<li><strong>URL_IS:</strong> Matches if the concatenation of request URL path and query is identical to the contents of the <code>value</code> field.</li>
<li><strong>URL_STARTS_WITH:</strong> Matches if the concatenation of request URL path and query starts with the contents of the <code>value</code> field.</li>
<li><strong>URL_PART_ENDS_WITH:</strong> Matches if the concatenation of request URL path and query ends with the contents of the <code>value</code> field.</li>
<li><strong>URL_PART_CONTAINS:</strong> Matches if the concatenation of request URL path and query contains the contents of the <code>value</code> field.</li>
</ul>

<p></p><p></p><p>URLs must start with a <code>/</code>. URLs can't contain restricted double slashes <code>//</code>. URLs can't contain the restricted <code>'</code> <code>&amp;</code> <code>?</code> symbols. Resources to cache can only be specified by a URL, any query parameters are ignored.</p></li>
<li><code>value</code> - (Required) (Updatable) The value of the caching rule criteria.</li>
</ul><p></p></li>
<li><code>is_client_caching_enabled</code> - (Optional) (Updatable) Enables or disables client caching. Browsers use the <code>Cache-Control</code> header value for caching content locally in the browser. This setting overrides the addition of a <code>Cache-Control</code> header in responses.</li>
<li><code>key</code> - (Optional) (Updatable) The unique key for the caching rule.</li>
<li><code>name</code> - (Required) (Updatable) The name of the caching rule.</li>
</ul><p></p></li>
<li><code>captchas</code> - (Optional) (Updatable) A list of CAPTCHA challenge settings. CAPTCHAs challenge requests to ensure a human is attempting to reach the specified URL and not a bot.


md5-35fe3679adf23e4722866fe01a9fd50e



<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>HTTP_METHOD_IS_NOT:</strong> Matches if the request is not identical to any of the contents of the <code>value</code> field. The <code>value</code> in this case is string with one or multiple HTTP methods separated by new line symbol \n The list of available methods: <code>GET</code>, <code>HEAD</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>CONNECT</code>, <code>OPTIONS</code>, <code>TRACE</code>, <code>PATCH</code></li>
</ul>

<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>COUNTRY_IS:</strong> Matches if the request originates from one of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>COUNTRY_IS_NOT:</strong> Matches if the request does not originate from any of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>USER_AGENT_IS:</strong> Matches if the requesting user agent is identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
<li><strong>USER_AGENT_IS_NOT:</strong> Matches if the requesting user agent is not identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
</ul></li>
<li><code>is_case_sensitive</code> - (Optional) (Updatable) When enabled, the condition will be matched with case-sensitive rules.</li>
<li><code>value</code> - (Required) (Updatable) The criteria value.</li>
</ul>
<li><code>failure_threshold</code> - (Optional) (Updatable) The number of failed requests before taking action. If unspecified, defaults to <code>10</code>.</li>
<li><code>is_enabled</code> - (Required) (Updatable) Enables or disables the JavaScript challenge Web Application Firewall feature.</li>
<li><code>is_nat_enabled</code> - (Optional) (Updatable) When enabled, the user is identified not only by the IP address but also by an unique additional hash, which prevents blocking visitors with shared IP addresses.</li>
<li><code>set_http_header</code> - (Optional) (Updatable) Adds an additional HTTP header to requests that fail the challenge before being passed to the origin. Only applicable when the <code>action</code> is set to <code>DETECT</code>.
<ul>
<li><code>name</code> - (Required) (Updatable) The name of the header.</li>
<li><code>value</code> - (Required) (Updatable) The value of the header.</li>
</ul></li>

<li><code>origin</code> - (Optional) (Updatable) The key in the map of origins referencing the origin used for the Web Application Firewall. The origin must already be included in <code>Origins</code>. Required when creating the <code>WafConfig</code> resource, but is not required upon updating the configuration.</li>
<li><code>origin_groups</code> - (Optional) (Updatable) The map of origin groups and their keys used to associate origins to the <code>wafConfig</code>. Origin groups allow you to apply weights to groups of origins for load balancing purposes. Origins with higher weights will receive larger proportions of client requests. To add additional origins to your WAAS policy, update the <code>origins</code> field of a <code>UpdateWaasPolicy</code> request.</li>
<li><p><code>protection_settings</code> - (Optional) (Updatable) The settings applied to protection rules.</p>

<ul>
<li><code>allowed_http_methods</code> - (Optional) (Updatable) The list of allowed HTTP methods. If unspecified, default to <code>[OPTIONS, GET, HEAD, POST]</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Restrict HTTP Request Methods" rule (key: 911100).</li>
<li><code>block_action</code> - (Optional) (Updatable) If <code>action</code> is set to <code>BLOCK</code>, this specifies how the traffic is blocked when detected as malicious by a protection rule. If unspecified, defaults to <code>SET_RESPONSE_CODE</code>.</li>
<li><code>block_error_page_code</code> - (Optional) (Updatable) The error code to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to <code>403</code>.</li>
<li><code>block_error_page_description</code> - (Optional) (Updatable) The description text to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to <code>Access blocked by website owner. Please contact support.</code></li>
<li><code>block_error_page_message</code> - (Optional) (Updatable) The message to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to 'Access to the website is blocked.'</li>
<li><code>block_response_code</code> - (Optional) (Updatable) The response code returned when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SET_RESPONSE_CODE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to <code>403</code>. The list of available response codes: <code>400</code>, <code>401</code>, <code>403</code>, <code>405</code>, <code>409</code>, <code>411</code>, <code>412</code>, <code>413</code>, <code>414</code>, <code>415</code>, <code>416</code>, <code>500</code>, <code>501</code>, <code>502</code>, <code>503</code>, <code>504</code>, <code>507</code>.</li>
<li><p><code>is_response_inspected</code> - (Optional) (Updatable) Inspects the response body of origin responses. Can be used to detect leakage of sensitive data. If unspecified, defaults to <code>false</code>.</p>

<p><strong>Note:</strong> Only origin responses with a Content-Type matching a value in <code>mediaTypes</code> will be inspected.</p></li>
<li><code>max_argument_count</code> - (Optional) (Updatable) The maximum number of arguments allowed to be passed to your application before an action is taken. Arguements are query parameters or body parameters in a PUT or POST request. If unspecified, defaults to <code>255</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Number of Arguments Limits" rule (key: 960335).  Example: If <code>maxArgumentCount</code> to <code>2</code> for the Max Number of Arguments protection rule (key: 960335), the following requests would be blocked: <code>GET /myapp/path?query=one&amp;query=two&amp;query=three</code> <code>POST /myapp/path</code> with Body <code>{"argument1":"one","argument2":"two","argument3":"three"}</code></li>
<li><code>max_name_length_per_argument</code> - (Optional) (Updatable) The maximum length allowed for each argument name, in characters. Arguements are query parameters or body parameters in a PUT or POST request. If unspecified, defaults to <code>400</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Values Limits" rule (key: 960208).</li>
<li><code>max_response_size_in_ki_b</code> - (Optional) (Updatable) The maximum response size to be fully inspected, in binary kilobytes (KiB). Anything over this limit will be partially inspected. If unspecified, defaults to <code>1024</code>.</li>
<li><code>max_total_name_length_of_arguments</code> - (Optional) (Updatable) The maximum length allowed for the sum of the argument name and value, in characters. Arguements are query parameters or body parameters in a PUT or POST request. If unspecified, defaults to <code>64000</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Total Arguments Limits" rule (key: 960341).</li>
<li><p><code>media_types</code> - (Optional) (Updatable) The list of media types to allow for inspection, if <code>isResponseInspected</code> is enabled. Only responses with MIME types in this list will be inspected. If unspecified, defaults to <code>["text/html", "text/plain", "text/xml"]</code>.</p>

<p>Supported MIME types include:</p>

<ul>
<li>text/html</li>
<li>text/plain</li>
<li>text/asp</li>
<li>text/css</li>
<li>text/x-script</li>
<li>application/json</li>
<li>text/webviewhtml</li>
<li>text/x-java-source</li>
<li>application/x-javascript</li>
<li>application/javascript</li>
<li>application/ecmascript</li>
<li>text/javascript</li>
<li>text/ecmascript</li>
<li>text/x-script.perl</li>
<li>text/x-script.phyton</li>
<li>application/plain</li>
<li>application/xml</li>
<li>text/xml</li>
</ul></li>
<li><p><code>recommendations_period_in_days</code> - (Optional) (Updatable) The length of time to analyze traffic traffic, in days. After the analysis period, <code>WafRecommendations</code> will be populated. If unspecified, defaults to <code>10</code>.</p>

<p>Use <code>GET /waasPolicies/{waasPolicyId}/wafRecommendations</code> to view WAF recommendations.</p></li>
</ul></li>
<li><code>whitelists</code> - (Optional) (Updatable) A list of IP addresses that bypass the Web Application Firewall.
<ul>
<li><code>address_lists</code> - (Optional) (Updatable) A list of <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm">OCID</a> of IP address lists to include in the whitelist.</li>
<li><code>addresses</code> - (Optional) (Updatable) A set of IP addresses or CIDR notations to include in the whitelist.</li>
<li><code>name</code> - (Required) (Updatable) The unique name of the whitelist.</li>
</ul></li>



<p><em>* IMPORTANT *</em>
Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>The following attributes are exported:</p>

<ul>
<li><code>additional_domains</code> - An array of additional domains for this web application.</li>
<li><code>cname</code> - The CNAME record to add to your DNS configuration to route traffic for the domain, and all additional domains, through the WAF.</li>
<li><code>compartment_id</code> - The <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm">OCID</a> of the WAAS policy's compartment.</li>
<li><code>defined_tags</code> - Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a>.  Example: <code>{"Operations.CostCenter": "42"}</code> </li>
<li><code>display_name</code> - The user-friendly name of the WAAS policy. The name can be changed and does not need to be unique.</li>
<li><code>domain</code> - The web application domain that the WAAS policy protects.</li>
<li><code>freeform_tags</code> - Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm">Resource Tags</a>.  Example: <code>{"Department": "Finance"}</code> </li>
<li><code>id</code> - The <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm">OCID</a> of the WAAS policy.</li>
<li><code>origin_groups</code> - The map of origin groups and their keys used to associate origins to the <code>wafConfig</code>. Origin groups allow you to apply weights to groups of origins for load balancing purposes. Origins with higher weights will receive larger proportions of client requests.
<ul>
<li><code>origins</code> - The list of objects containing origin references and additional properties.</li>
</ul></li>
<li><code>origins</code> - A map of host servers (origins) and their keys for the web application. Origin keys are used to associate origins to specific protection rules. The key should be a user-friendly name for the host. <strong>Examples:</strong> <code>primary</code> or <code>secondary</code>.
<ul>
<li><code>custom_headers</code> - A list of HTTP headers to forward to your origin.
<ul>
<li><code>name</code> - The name of the header.</li>
<li><code>value</code> - The value of the header.</li>
</ul></li>
<li><code>http_port</code> - The HTTP port on the origin that the web application listens on. If unspecified, defaults to <code>80</code>. If <code>0</code> is specified - the origin is not used for HTTP traffic.</li>
<li><code>https_port</code> - The HTTPS port on the origin that the web application listens on. If unspecified, defaults to <code>443</code>. If <code>0</code> is specified - the origin is not used for HTTPS traffic.</li>
<li><code>uri</code> - The URI of the origin. Does not support paths. Port numbers should be specified in the <code>httpPort</code> and <code>httpsPort</code> fields.</li>
</ul></li>
<li><p><code>policy_config</code> - The configuration details for the WAAS policy.</p>

<ul>
<li><code>certificate_id</code> - The OCID of the SSL certificate to use if HTTPS is supported.</li>
<li><code>cipher_group</code> - The set cipher group for the configured TLS protocol. This sets the configuration for the TLS connections between clients and edge nodes only.
<ul>
<li><strong>DEFAULT:</strong> Cipher group supports TLS 1.0, TLS 1.1, TLS 1.2, TLS 1.3 protocols. It has the following ciphers enabled: <code>ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:!DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA</code></li>
</ul></li>
<li><p><code>client_address_header</code> - Specifies an HTTP header name which is treated as the connecting client's IP address. Applicable only if <code>isBehindCdn</code> is enabled.</p>

<p>The edge node reads this header and its value and sets the client IP address as specified. It does not create the header if the header is not present in the request. If the header is not present, the connecting IP address will be used as the client's true IP address. It uses the last IP address in the header's value as the true IP address.</p>

<p>Example: <code>X-Client-Ip: 11.1.1.1, 13.3.3.3</code></p>

<p>In the case of multiple headers with the same name, only the first header will be used. It is assumed that CDN sets the correct client IP address to prevent spoofing.</p>

<ul>
<li><strong>X_FORWARDED_FOR:</strong> Corresponds to <code>X-Forwarded-For</code> header name.</li>
<li><strong>X_CLIENT_IP:</strong> Corresponds to <code>X-Client-Ip</code> header name.</li>
<li><strong>X_REAL_IP:</strong> Corresponds to <code>X-Real-Ip</code> header name.</li>
<li><strong>CLIENT_IP:</strong> Corresponds to <code>Client-Ip</code> header name.</li>
<li><strong>TRUE_CLIENT_IP:</strong> Corresponds to <code>True-Client-Ip</code> header name.</li>
</ul></li>
<li><p><code>health_checks</code> - Health checks monitor the status of your origin servers and only route traffic to the origins that pass the health check. If the health check fails, origin is automatically removed from the load balancing. There is roughly one health check per EDGE POP per period. Any checks that pass will be reported as "healthy".</p>

<ul>
<li><code>expected_response_code_group</code> - The HTTP response codes that signify a healthy state.
<ul>
<li><strong>2XX:</strong> Success response code group.</li>
<li><strong>3XX:</strong> Redirection response code group.</li>
<li><strong>4XX:</strong> Client errors response code group.</li>
<li><strong>5XX:</strong> Server errors response code group.</li>
</ul></li>
<li><code>expected_response_text</code> - Health check will search for the given text in a case-sensitive manner within the response body and will fail if the text is not found.</li>
<li><p><code>headers</code> - HTTP header fields to include in health check requests, expressed as <code>"name": "value"</code> properties. Because HTTP header field names are case-insensitive, any use of names that are case-insensitive equal to other names will be rejected. If Host is not specified, requests will include a Host header field with value matching the policy's protected domain. If User-Agent is not specified, requests will include a User-Agent header field with value "waf health checks".</p>

<p><strong>Note:</strong> The only currently-supported header fields are Host and User-Agent.</p></li>
<li><code>healthy_threshold</code> - Number of successful health checks after which the server is marked up.</li>
<li><code>interval_in_seconds</code> - Time between health checks of an individual origin server, in seconds.</li>
<li><code>is_enabled</code> - Enables or disables the health checks.</li>
<li><code>is_response_text_check_enabled</code> - Enables or disables additional check for predefined text in addition to response code.</li>
<li><code>method</code> - An HTTP verb (i.e. HEAD, GET, or POST) to use when performing the health check.</li>
<li><code>path</code> - Path to visit on your origins when performing the health check.</li>
<li><code>timeout_in_seconds</code> - Response timeout represents wait time until request is considered failed, in seconds.</li>
<li><code>unhealthy_threshold</code> - Number of failed health checks after which the server is marked down.</li>
</ul></li>
<li><code>is_behind_cdn</code> - Enabling <code>isBehindCdn</code> allows for the collection of IP addresses from client requests if the WAF is connected to a CDN.</li>
<li><code>is_cache_control_respected</code> - Enable or disable automatic content caching based on the response <code>cache-control</code> header. This feature enables the origin to act as a proxy cache. Caching is usually defined using <code>cache-control</code> header. For example <code>cache-control: max-age=120</code> means that the returned resource is valid for 120 seconds. Caching rules will overwrite this setting.</li>
<li><code>is_https_enabled</code> - Enable or disable HTTPS support. If true, a <code>certificateId</code> is required. If unspecified, defaults to <code>false</code>.</li>
<li><code>is_https_forced</code> - Force HTTP to HTTPS redirection. If unspecified, defaults to <code>false</code>.</li>
<li><code>is_origin_compression_enabled</code> - Enable or disable GZIP compression of origin responses. If enabled, the header <code>Accept-Encoding: gzip</code> is sent to origin, otherwise, the empty <code>Accept-Encoding:</code> header is used.</li>
<li><code>is_response_buffering_enabled</code> - Enable or disable buffering of responses from the origin. Buffering improves overall stability in case of network issues, but slightly increases Time To First Byte.</li>
<li><code>is_sni_enabled</code> - SNI stands for Server Name Indication and is an extension of the TLS protocol. It indicates which hostname is being contacted by the browser at the beginning of the 'handshake'-process. This allows a server to connect multiple SSL Certificates to one IP address and port.</li>
<li><code>load_balancing_method</code> - An object that represents a load balancing method and its properties.
<ul>
<li><code>domain</code> - The domain for which the cookie is set, defaults to WAAS policy domain. </li>
<li><code>expiration_time_in_seconds</code> - The time for which a browser should keep the cookie in seconds. Empty value will cause the cookie to expire at the end of a browser session. </li>
<li><code>method</code> - Load balancing methods are algorithms used to efficiently distribute traffic among origin servers.
<ul>
<li><strong><a href="../iaas/api.html#/en/waas/latest/datatypes/IPHashLoadBalancingMethod">IP_HASH</a>:</strong> All the incoming requests from the same client IP address should go to the same content origination server. IP_HASH load balancing method uses origin weights when choosing which origin should the hash be assigned to initially.</li>
<li><strong><a href="../iaas/api.html#/en/waas/latest/datatypes/RoundRobinLoadBalancingMethod">ROUND_ROBIN</a>:</strong> Forwards requests sequentially to the available origin servers. The first request - to the first origin server, the second request - to the next origin server, and so on. After it sends a request to the last origin server, it starts again with the first origin server. When using weights on origins, Weighted Round Robin assigns more requests to origins with a greater weight. Over a period of time, origins will receive a number of requests in proportion to their weight.</li>
<li><strong><a href="../iaas/api.html#/en/waas/latest/datatypes/StickyCookieLoadBalancingMethod">STICKY_COOKIE</a>:</strong> Adds a session cookie to the first response from the origin server and identifies the server that sent the response. The client's next request contains the cookie value, and nginx routes the request to the origin server that responded to the first request. STICKY_COOKIE load balancing method falls back to Round Robin for the first request.</li>
</ul></li>
<li><code>name</code> - The name of the cookie used to track the persistence. Can contain any US-ASCII character except separator or control character. </li>
</ul></li>
<li><p><code>tls_protocols</code> - A list of allowed TLS protocols. Only applicable when HTTPS support is enabled. The TLS protocol is negotiated while the request is connecting and the most recent protocol supported by both the edge node and client browser will be selected. If no such version exists, the connection will be aborted.</p>

<ul>
<li><strong>TLS_V1:</strong> corresponds to TLS 1.0 specification.</li>
<li><strong>TLS_V1_1:</strong> corresponds to TLS 1.1 specification.</li>
<li><strong>TLS_V1_2:</strong> corresponds to TLS 1.2 specification.</li>
<li><strong>TLS_V1_3:</strong> corresponds to TLS 1.3 specification.</li>
</ul>

<p></p><p>Enabled TLS protocols must go in a row. For example if <code>TLS_v1_1</code> and <code>TLS_V1_3</code> are enabled, <code>TLS_V1_2</code> must be enabled too.</p></li>
<li><code>websocket_path_prefixes</code> - ModSecurity is not capable to inspect WebSockets. Therefore paths specified here have WAF disabled if Connection request header from the client has the value Upgrade (case insensitive matching) and Upgrade request header has the value websocket (case insensitive matching). Paths matches if the concatenation of request URL path and query starts with the contents of the one of <code>websocketPathPrefixes</code> array value. In All other cases challenges, like JSC, HIC and etc., remain active.</li>
</ul><p></p></li>
<li><code>state</code> - The current lifecycle state of the WAAS policy.</li>
<li><code>time_created</code> - The date and time the policy was created, expressed in RFC 3339 timestamp format.</li>
<li><p><code>waf_config</code> - The Web Application Firewall configuration for the WAAS policy.</p>

<ul>
<li><p><code>access_rules</code> - The access rules applied to the Web Application Firewall. Used for defining custom access policies with the combination of <code>ALLOW</code>, <code>DETECT</code>, and <code>BLOCK</code> rules, based on different criteria.</p>

<ul>
<li><p><code>action</code> - The action to take when the access criteria are met for a rule. If unspecified, defaults to <code>ALLOW</code>.</p>

<ul>
<li><strong>ALLOW:</strong> Takes no action, just logs the request.</li>
<li><strong>DETECT:</strong> Takes no action, but creates an alert for the request.</li>
<li><strong>BLOCK:</strong> Blocks the request by returning specified response code or showing error page.</li>
<li><strong>BYPASS:</strong> Bypasses some or all challenges.</li>
<li><strong>REDIRECT:</strong> Redirects the request to the specified URL. These fields are required when <code>REDIRECT</code> is selected: <code>redirectUrl</code>, <code>redirectResponseCode</code>.</li>
<li><strong>SHOW_CAPTCHA:</strong> Show a CAPTCHA Challenge page instead of the requested page.</li>
</ul>

<p>Regardless of action, no further rules are processed once a rule is matched.</p></li>
<li><code>block_action</code> - The method used to block requests if <code>action</code> is set to <code>BLOCK</code> and the access criteria are met. If unspecified, defaults to <code>SET_RESPONSE_CODE</code>.</li>
<li><code>block_error_page_code</code> - The error code to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the access criteria are met. If unspecified, defaults to 'Access rules'.</li>
<li><code>block_error_page_description</code> - The description text to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the access criteria are met. If unspecified, defaults to 'Access blocked by website owner. Please contact support.'</li>
<li><code>block_error_page_message</code> - The message to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the access criteria are met. If unspecified, defaults to 'Access to the website is blocked.'</li>
<li><code>block_response_code</code> - The response status code to return when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SET_RESPONSE_CODE</code>, and the access criteria are met. If unspecified, defaults to <code>403</code>. The list of available response codes: <code>200</code>, <code>201</code>, <code>202</code>, <code>204</code>, <code>206</code>, <code>300</code>, <code>301</code>, <code>302</code>, <code>303</code>, <code>304</code>, <code>307</code>, <code>400</code>, <code>401</code>, <code>403</code>, <code>404</code>, <code>405</code>, <code>408</code>, <code>409</code>, <code>411</code>, <code>412</code>, <code>413</code>, <code>414</code>, <code>415</code>, <code>416</code>, <code>422</code>, <code>444</code>, <code>494</code>, <code>495</code>, <code>496</code>, <code>497</code>, <code>499</code>, <code>500</code>, <code>501</code>, <code>502</code>, <code>503</code>, <code>504</code>, <code>507</code>.</li>
<li><code>bypass_challenges</code> - The list of challenges to bypass when <code>action</code> is set to <code>BYPASS</code>. If unspecified or empty, all challenges are bypassed.


md5-711e0183c949ab8184489b62414dcb63



<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>HTTP_METHOD_IS_NOT:</strong> Matches if the request is not identical to any of the contents of the <code>value</code> field. The <code>value</code> in this case is string with one or multiple HTTP methods separated by new line symbol \n The list of available methods: <code>GET</code>, <code>HEAD</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>CONNECT</code>, <code>OPTIONS</code>, <code>TRACE</code>, <code>PATCH</code></li>
</ul>

<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>COUNTRY_IS:</strong> Matches if the request originates from one of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>COUNTRY_IS_NOT:</strong> Matches if the request does not originate from any of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>USER_AGENT_IS:</strong> Matches if the requesting user agent is identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
<li><strong>USER_AGENT_IS_NOT:</strong> Matches if the requesting user agent is not identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
</ul></li>
<li><code>is_case_sensitive</code> - When enabled, the condition will be matched with case-sensitive rules.</li>
<li><code>value</code> - The criteria value.</li>
</ul></li>
<li><code>name</code> - The unique name of the access rule.</li>
<li><code>redirect_response_code</code> - The response status code to return when <code>action</code> is set to <code>REDIRECT</code>.
<ul>
<li><strong>MOVED_PERMANENTLY:</strong> Used for designating the permanent movement of a page (numerical code - 301).</li>
<li><strong>FOUND:</strong> Used for designating the temporary movement of a page (numerical code - 302).</li>
</ul></li>
<li><code>redirect_url</code> - The target to which the request should be redirected, represented as a URI reference. Required when <code>action</code> is <code>REDIRECT</code>.</li>
<li><code>response_header_manipulation</code> - An object that represents an action to apply to an HTTP response headers if all rule criteria will be matched regardless of <code>action</code> value.
<ul>
<li><code>action</code> - The action can be one of these values: <code>ADD_HTTP_RESPONSE_HEADER</code>, <code>EXTEND_HTTP_RESPONSE_HEADER</code>, <code>REMOVE_HTTP_RESPONSE_HEADER</code></li>
<li><code>header</code> - A header field name that conforms to RFC 7230.  Example: <code>example_header_name</code> </li>
<li><code>value</code> - A header field value that conforms to RFC 7230.  Example: <code>example_value</code> </li>
</ul></li>
</ul></li>
<li><code>address_rate_limiting</code> - The IP address rate limiting settings used to limit the number of requests from an address.
<ul>
<li><code>allowed_rate_per_address</code> - The number of allowed requests per second from one IP address. If unspecified, defaults to <code>1</code>.</li>
<li><code>block_response_code</code> - The response status code returned when a request is blocked. If unspecified, defaults to <code>503</code>. The list of available response codes: <code>400</code>, <code>401</code>, <code>403</code>, <code>404</code>, <code>405</code>, <code>408</code>, <code>409</code>, <code>411</code>, <code>412</code>, <code>413</code>, <code>414</code>, <code>415</code>, <code>416</code>, <code>422</code>, <code>494</code>, <code>495</code>, <code>496</code>, <code>497</code>, <code>499</code>, <code>500</code>, <code>501</code>, <code>502</code>, <code>503</code>, <code>504</code>, <code>507</code>.</li>
<li><code>is_enabled</code> - Enables or disables the address rate limiting Web Application Firewall feature.</li>
<li><code>max_delayed_count_per_address</code> - The maximum number of requests allowed to be queued before subsequent requests are dropped. If unspecified, defaults to <code>10</code>.</li>
</ul></li>
<li><p><code>caching_rules</code> - A list of caching rules applied to the web application.</p>

<ul>
<li><code>action</code> - The action to take when the criteria of a caching rule are met.
<ul>
<li><strong>CACHE:</strong> Caches requested content when the criteria of the rule are met.</li>
<li><strong>BYPASS_CACHE:</strong> Allows requests to bypass the cache and be directed to the origin when the criteria of the rule is met.</li>
</ul></li>
<li><code>caching_duration</code> - The duration to cache content for the caching rule, specified in ISO 8601 extended format. Supported units: seconds, minutes, hours, days, weeks, months. The maximum value that can be set for any unit is <code>99</code>. Mixing of multiple units is not supported. Only applies when the <code>action</code> is set to <code>CACHE</code>. Example: <code>PT1H</code></li>
<li><code>client_caching_duration</code> - The duration to cache content in the user's browser, specified in ISO 8601 extended format. Supported units: seconds, minutes, hours, days, weeks, months. The maximum value that can be set for any unit is <code>99</code>. Mixing of multiple units is not supported. Only applies when the <code>action</code> is set to <code>CACHE</code>. Example: <code>PT1H</code></li>
<li><p><code>criteria</code> - The array of the rule criteria with condition and value. The caching rule would be applied for the requests that matched any of the listed conditions.</p>

<ul>
<li><p><code>condition</code> - The condition of the caching rule criteria.</p>

<ul>
<li><strong>URL_IS:</strong> Matches if the concatenation of request URL path and query is identical to the contents of the <code>value</code> field.</li>
<li><strong>URL_STARTS_WITH:</strong> Matches if the concatenation of request URL path and query starts with the contents of the <code>value</code> field.</li>
<li><strong>URL_PART_ENDS_WITH:</strong> Matches if the concatenation of request URL path and query ends with the contents of the <code>value</code> field.</li>
<li><strong>URL_PART_CONTAINS:</strong> Matches if the concatenation of request URL path and query contains the contents of the <code>value</code> field.</li>
</ul>

<p></p><p></p><p>URLs must start with a <code>/</code>. URLs can't contain restricted double slashes <code>//</code>. URLs can't contain the restricted <code>'</code> <code>&amp;</code> <code>?</code> symbols. Resources to cache can only be specified by a URL, any query parameters are ignored.</p></li>
<li><code>value</code> - The value of the caching rule criteria.</li>
</ul><p></p></li>
<li><code>is_client_caching_enabled</code> - Enables or disables client caching. Browsers use the <code>Cache-Control</code> header value for caching content locally in the browser. This setting overrides the addition of a <code>Cache-Control</code> header in responses.</li>
<li><code>key</code> - The unique key for the caching rule.</li>
<li><code>name</code> - The name of the caching rule.</li>
</ul><p></p></li>
<li><code>captchas</code> - A list of CAPTCHA challenge settings. These are used to challenge requests with a CAPTCHA to block bots.


md5-1a8124efaeb32bb3ae0a4937848a7831



<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>HTTP_METHOD_IS_NOT:</strong> Matches if the request is not identical to any of the contents of the <code>value</code> field. The <code>value</code> in this case is string with one or multiple HTTP methods separated by new line symbol \n The list of available methods: <code>GET</code>, <code>HEAD</code>, <code>POST</code>, <code>PUT</code>, <code>DELETE</code>, <code>CONNECT</code>, <code>OPTIONS</code>, <code>TRACE</code>, <code>PATCH</code></li>
</ul>

<p><em>Example:</em> "GET\nPOST"</p>

<ul>
<li><strong>COUNTRY_IS:</strong> Matches if the request originates from one of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>COUNTRY_IS_NOT:</strong> Matches if the request does not originate from any of countries in the <code>value</code> field. The <code>value</code> in this case is string with one or multiple countries separated by new line symbol \n Country codes are in ISO 3166-1 alpha-2 format. For a list of codes, see <a href="https://www.iso.org/obp/ui/#search/code/">ISO's website</a>. <em>Example:</em> "AL\nDZ\nAM"</li>
<li><strong>USER_AGENT_IS:</strong> Matches if the requesting user agent is identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
<li><strong>USER_AGENT_IS_NOT:</strong> Matches if the requesting user agent is not identical to the contents of the <code>value</code> field. <em>Example:</em> <code>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:35.0) Gecko/20100101 Firefox/35.0</code></li>
</ul></li>
<li><code>is_case_sensitive</code> - When enabled, the condition will be matched with case-sensitive rules.</li>
<li><code>value</code> - The criteria value.</li>
</ul>
<li><code>failure_threshold</code> - The number of failed requests before taking action. If unspecified, defaults to <code>10</code>.</li>
<li><code>is_enabled</code> - Enables or disables the JavaScript challenge Web Application Firewall feature.</li>
<li><code>is_nat_enabled</code> - When enabled, the user is identified not only by the IP address but also by an unique additional hash, which prevents blocking visitors with shared IP addresses.</li>
<li><code>set_http_header</code> - Adds an additional HTTP header to requests that fail the challenge before being passed to the origin. Only applicable when the <code>action</code> is set to <code>DETECT</code>.
<ul>
<li><code>name</code> - The name of the header.</li>
<li><code>value</code> - The value of the header.</li>
</ul></li>

<li><code>origin</code> - The key in the map of origins referencing the origin used for the Web Application Firewall. The origin must already be included in <code>Origins</code>. Required when creating the <code>WafConfig</code> resource, but not on update.</li>
<li><code>origin_groups</code> - The map of origin groups and their keys used to associate origins to the <code>wafConfig</code>. Origin groups allow you to apply weights to groups of origins for load balancing purposes. Origins with higher weights will receive larger proportions of client requests. To add additional origins to your WAAS policy, update the <code>origins</code> field of a <code>UpdateWaasPolicy</code> request.</li>
<li><p><code>protection_settings</code> - The settings to apply to protection rules.</p>

<ul>
<li><code>allowed_http_methods</code> - The list of allowed HTTP methods. If unspecified, default to <code>[OPTIONS, GET, HEAD, POST]</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Restrict HTTP Request Methods" rule (key: 911100).</li>
<li><code>block_action</code> - If <code>action</code> is set to <code>BLOCK</code>, this specifies how the traffic is blocked when detected as malicious by a protection rule. If unspecified, defaults to <code>SET_RESPONSE_CODE</code>.</li>
<li><code>block_error_page_code</code> - The error code to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to <code>403</code>.</li>
<li><code>block_error_page_description</code> - The description text to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to <code>Access blocked by website owner. Please contact support.</code></li>
<li><code>block_error_page_message</code> - The message to show on the error page when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SHOW_ERROR_PAGE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to 'Access to the website is blocked.'</li>
<li><code>block_response_code</code> - The response code returned when <code>action</code> is set to <code>BLOCK</code>, <code>blockAction</code> is set to <code>SET_RESPONSE_CODE</code>, and the traffic is detected as malicious by a protection rule. If unspecified, defaults to <code>403</code>. The list of available response codes: <code>400</code>, <code>401</code>, <code>403</code>, <code>405</code>, <code>409</code>, <code>411</code>, <code>412</code>, <code>413</code>, <code>414</code>, <code>415</code>, <code>416</code>, <code>500</code>, <code>501</code>, <code>502</code>, <code>503</code>, <code>504</code>, <code>507</code>.</li>
<li><p><code>is_response_inspected</code> - Inspects the response body of origin responses. Can be used to detect leakage of sensitive data. If unspecified, defaults to <code>false</code>.</p>

<p><strong>Note:</strong> Only origin responses with a Content-Type matching a value in <code>mediaTypes</code> will be inspected.</p></li>
<li><code>max_argument_count</code> - The maximum number of arguments allowed to be passed to your application before an action is taken. Arguements are query parameters or body parameters in a PUT or POST request. If unspecified, defaults to <code>255</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Number of Arguments Limits" rule (key: 960335).  Example: If <code>maxArgumentCount</code> to <code>2</code> for the Max Number of Arguments protection rule (key: 960335), the following requests would be blocked: <code>GET /myapp/path?query=one&amp;query=two&amp;query=three</code> <code>POST /myapp/path</code> with Body <code>{"argument1":"one","argument2":"two","argument3":"three"}</code></li>
<li><code>max_name_length_per_argument</code> - The maximum length allowed for each argument name, in characters. Arguements are query parameters or body parameters in a PUT or POST request. If unspecified, defaults to <code>400</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Values Limits" rule (key: 960208).</li>
<li><code>max_response_size_in_ki_b</code> - The maximum response size to be fully inspected, in binary kilobytes (KiB). Anything over this limit will be partially inspected. If unspecified, defaults to <code>1024</code>.</li>
<li><code>max_total_name_length_of_arguments</code> - The maximum length allowed for the sum of the argument name and value, in characters. Arguements are query parameters or body parameters in a PUT or POST request. If unspecified, defaults to <code>64000</code>. This setting only applies if a corresponding protection rule is enabled, such as the "Total Arguments Limits" rule (key: 960341).</li>
<li><p><code>media_types</code> - The list of media types to allow for inspection, if <code>isResponseInspected</code> is enabled. Only responses with MIME types in this list will be inspected. If unspecified, defaults to <code>["text/html", "text/plain", "text/xml"]</code>.</p>

<p>Supported MIME types include:</p>

<ul>
<li>text/html</li>
<li>text/plain</li>
<li>text/asp</li>
<li>text/css</li>
<li>text/x-script</li>
<li>application/json</li>
<li>text/webviewhtml</li>
<li>text/x-java-source</li>
<li>application/x-javascript</li>
<li>application/javascript</li>
<li>application/ecmascript</li>
<li>text/javascript</li>
<li>text/ecmascript</li>
<li>text/x-script.perl</li>
<li>text/x-script.phyton</li>
<li>application/plain</li>
<li>application/xml</li>
<li>text/xml</li>
</ul></li>
<li><p><code>recommendations_period_in_days</code> - The length of time to analyze traffic traffic, in days. After the analysis period, <code>WafRecommendations</code> will be populated. If unspecified, defaults to <code>10</code>.</p>

<p>Use <code>GET /waasPolicies/{waasPolicyId}/wafRecommendations</code> to view WAF recommendations.</p></li>
</ul></li>
<li><code>whitelists</code> - A list of IP addresses that bypass the Web Application Firewall.
<ul>
<li><code>address_lists</code> - A list of <a href="https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm">OCID</a> of IP address lists to include in the whitelist.</li>
<li><code>addresses</code> - A set of IP addresses or CIDR notations to include in the whitelist.</li>
<li><code>name</code> - The unique name of the whitelist.</li>
</ul></li>



<a class="dashAnchor" name="//apple_ref/cpp/Section/Timeouts"></a><h2 id="timeouts">Timeouts</h2>

<p>The <code>timeouts</code> block allows you to specify <a href="https://registry.terraform.io/providers/oracle/oci/latest/docs/guides/changing_timeouts">timeouts</a> for certain operations:
    * <code>create</code> - (Defaults to 2 hours), when creating the Waas Policy
    * <code>update</code> - (Defaults to 2 hours), when updating the Waas Policy
    * <code>delete</code> - (Defaults to 2 hours), when destroying the Waas Policy</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>WaasPolicies can be imported using the <code>id</code>, e.g.</p>

<pre><code>$ terraform import oci_waas_waas_policy.test_waas_policy "id"
</code></pre>

            
        
    </body></html>