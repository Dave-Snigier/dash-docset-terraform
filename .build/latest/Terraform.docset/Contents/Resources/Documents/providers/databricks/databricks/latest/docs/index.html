<html><!-- Online page at https://registry.terraform.io/providers/databricks/databricks/latest/docs --><head>
                <title>Databricks Provider</title>
                <meta charset="utf-8"/>
                <link href="../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="databricks-provider">Databricks Provider</h1>

<p>Use the Databricks Terraform provider to interact with almost all of <a href="http://databricks.com/">Databricks</a> resources. If you're new to Databricks, please follow guide to create a workspace on <a href="guides/azure-workspace.md">Azure</a>, <a href="guides/aws-workspace.md">AWS</a> or <a href="guides/gcp-workspace.md">GCP</a> and then this <a href="guides/workspace-management.md">workspace management</a> tutorial.  Take advantage of <a href="https://www.terraform.io/docs/modules/index.html">Terraform Modules</a> to make your code simpler and reuse <a href="https://registry.terraform.io/search/modules?namespace=databricks">existing modules for Databricks resources</a>.   Changelog is available <a href="https://github.com/databricks/terraform-provider-databricks/blob/main/CHANGELOG.md">on GitHub</a>.</p>

<p><img alt="Resources" src="https://raw.githubusercontent.com/databricks/terraform-provider-databricks/main/docs/resources.png"/></p>

<p>Compute resources</p>

<ul>
<li>Deploy <a href="resources/cluster.md">databricks_cluster</a> on selected <a href="data-sources/node_type.md">databricks_node_type</a></li>
<li>Schedule automated <a href="resources/job.md">databricks_job</a></li>
<li>Control cost and data access with <a href="resources/cluster_policy.md">databricks_cluster_policy</a></li>
<li>Speedup job &amp; cluster startup with <a href="resources/instance_pool.md">databricks_instance_pool</a></li>
<li>Customize clusters with <a href="resources/global_init_script.md">databricks_global_init_script</a></li>
<li>Manage few <a href="resources/notebook.md">databricks_notebook</a>, and even <a href="data-sources/notebook_paths.md">list them</a></li>
<li>Manage <a href="resources/repo.md">databricks_repo</a></li>
</ul>

<p>Storage</p>

<ul>
<li>Manage JAR, Wheel &amp; Egg libraries through <a href="resources/dbfs_file.md">databricks_dbfs_file</a></li>
<li>List entries on DBFS with <a href="data-sources/dbfs_file_paths.md">databricks_dbfs_file_paths</a> data source</li>
<li>Get contents of small files with <a href="data-sources/dbfs_file.md">databricks_dbfs_file</a> data source</li>
<li>Mount storage with <a href="resources/mount.md">databricks_mount</a> resource</li>
</ul>

<p>Security</p>

<ul>
<li>Organize <a href="resources/user.md">databricks_user</a> into <a href="resources/group.md">databricks_group</a> through <a href="resources/group_member.md">databricks_group_member</a>, also reading <a href="data-sources/group.md">metadata</a></li>
<li>Create <a href="resources/service_principal.md">databricks_service_principal</a> with <a href="resources/obo_token.md">databricks_obo_token</a> to enable even more restricted access control.</li>
<li>Create <a href="resources/service_principal.md">databricks_service_principal</a> with <a href="resources/service_principal_secret.md">databricks_service_principal_secret</a> to authenticate with the service principal OAuth tokens (Only for AWS deployments)</li>
<li>Manage data access with <a href="resources/instance_profile.md">databricks_instance_profile</a>, which can be assigned through <a href="resources/group_instance_profile.md">databricks_group_instance_profile</a> and <a href="resources/user_instance_profile.md">databricks_user_instance_profile</a></li>
<li>Control which networks can access workspace with <a href="resources/ip_access_list.md">databricks_ip_access_list</a></li>
<li>Generically manage <a href="resources/permissions.md">databricks_permissions</a></li>
<li>Manage data object access control lists with <a href="resources/sql_permissions.md">databricks_sql_permissions</a></li>
<li>Keep sensitive elements like passwords in <a href="resources/secret.md">databricks_secret</a>, grouped into <a href="resources/secret_scope.md">databricks_secret_scope</a> and controlled by <a href="resources/secret_acl.md">databricks_secret_acl</a></li>
</ul>

<p><a href="../docs/guides/aws-workspace.md">Databricks workspace on AWS</a></p>

<ul>
<li>Create <a href="resources/mws_workspaces.md">workspaces</a> in your <a href="resources/mws_networks.md">VPC</a> with <a href="resources/mws_storage_configurations.md">DBFS</a> using <a href="resources/mws_credentials.md">cross-account IAM roles</a>, having your notebooks encrypted with <a href="resources/mws_customer_managed_keys.md">CMK</a>.</li>
<li>Use predefined AWS IAM Policy Templates: <a href="data-sources/aws_assume_role_policy.md">databricks_aws_assume_role_policy</a>, <a href="data-sources/aws_crossaccount_policy.md">databricks_aws_crossaccount_policy</a>, <a href="data-sources/aws_bucket_policy.md">databricks_aws_bucket_policy</a></li>
<li>Configure billing and audit <a href="resources/mws_log_delivery.md">databricks_mws_log_delivery</a></li>
</ul>

<p>Databricks SQL</p>

<ul>
<li>Create <a href="resources/sql_endpoint.md">databricks_sql_endpoint</a> controlled by <a href="resources/permissions.md">databricks_permissions</a>.</li>
<li>Manage <a href="resources/sql_query.md">queries</a> and their <a href="resources/sql_visualization.md">visualizations</a>.</li>
<li>Manage <a href="resources/sql_dashboard.md">dashboards</a> and their <a href="resources/sql_widget.md">widgets</a>.</li>
<li>Provide <a href="resources/sql_global_config.md">global configuration for all SQL warehouses</a></li>
</ul>

<p>Machine Learning</p>

<ul>
<li>Create <a href="resources/registered_model.md">models in Unity Catalog</a>.</li>
<li>Create <a href="resources/mlflow_experiment.md">MLflow experiments</a>.</li>
<li>Create <a href="resources/mlflow_model.md">models in the workspace model registry</a>.</li>
<li>Create <a href="resources/model_serving.md">model serving endpoints</a>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"databricks"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"databricks_current_user"</span><span class="w"> </span><span class="nv">"me"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="nc">"databricks_spark_version"</span><span class="w"> </span><span class="nv">"latest"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="nc">"databricks_node_type"</span><span class="w"> </span><span class="nv">"smallest"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">local_disk</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"databricks_notebook"</span><span class="w"> </span><span class="nv">"this"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">path</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"${data.databricks_current_user.me.home}/Terraform"</span><span class="w"></span>
<span class="w">  </span><span class="na">language</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PYTHON"</span><span class="w"></span>
<span class="w">  </span><span class="na">content_base64</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">base64encode</span><span class="p">(</span><span class="o">&lt;&lt;-</span><span class="dl">EOT</span><span class="sh"></span>
<span class="sh">    # created from ${abspath(path.module)}</span>
<span class="sh">    display(spark.range(10))</span>
<span class="dl">    EOT</span>
<span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"databricks_job"</span><span class="w"> </span><span class="nv">"this"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Terraform Demo (${data.databricks_current_user.me.alphanumeric})"</span><span class="w"></span>

<span class="w">  </span><span class="nb">task</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">task_key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"task1"</span><span class="w"></span>

<span class="w">    </span><span class="nb">notebook_task</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">notebook_path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">databricks_notebook.this.path</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>

<span class="w">    </span><span class="nb">new_cluster</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="na">num_workers</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
<span class="w">      </span><span class="na">spark_version</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">data.databricks_spark_version.latest.id</span><span class="w"></span>
<span class="w">      </span><span class="na">node_type_id</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">data.databricks_node_type.smallest.id</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">output</span><span class="w"> </span><span class="nv">"notebook_url"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">databricks_notebook.this.url</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">output</span><span class="w"> </span><span class="nv">"job_url"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">databricks_job.this.url</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Switching%20from%20databrickslabs%20to%20databricks%20namespace"></a><h2 id="switching-from-databrickslabs-to-databricks-namespace">Switching from <code>databrickslabs</code> to <code>databricks</code> namespace</h2>

<p>To make Databricks Terraform Provider generally available, we've moved it from <a href="https://github.com/databrickslabs">https://github.com/databrickslabs</a> to <a href="https://github.com/databricks">https://github.com/databricks</a>. We've worked closely with the Terraform Registry team at Hashicorp to ensure a smooth migration. Existing terraform deployments continue to work as expected without any action from your side. We ask you to replace <code>databrickslabs/databricks</code> with <code>databricks/databricks</code> in all your <code>.tf</code> files.</p>

<p>You should have <a href="https://github.com/databrickslabs/terraform-provider-databricks/blob/v0.6.2/scripts/versions-lock.hcl"><code>.terraform.lock.hcl</code></a> file in your state directory that is checked into source control. terraform init will give you the following warning.</p>

<div class="codehilite"><pre><span></span><code>Warning: Additional provider information from registry 

The remote registry returned warnings for registry.terraform.io/databrickslabs/databricks:
- For users on Terraform 0.13 or greater, this provider has moved to databricks/databricks. Please update your source in required_providers.
</code></pre></div>

<p>After you replace <code>databrickslabs/databricks</code> with <code>databricks/databricks</code> in the <code>required_providers</code> block, the warning will disappear. Do a global "search and replace" in <code>*.tf</code> files. Alternatively you can run <code>python3 -c "$(curl -Ls https://dbricks.co/updtfns)"</code> from the command-line, that would do all the boring work for you.</p>

<p>If you didn't check-in <a href="https://www.terraform.io/language/files/dependency-lock#lock-file-location"><code>.terraform.lock.hcl</code></a> to the source code version control, you may see <code>Failed to install provider</code> error. Please follow the simple steps described in the <a href="guides/troubleshooting.md">troubleshooting guide</a>.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Troubleshooting"></a><h2 id="troubleshooting">Troubleshooting</h2>

<p>In case of the problems using Databricks Terraform provider follow the steps outlined in the <a href="guides/troubleshooting.md">troubleshooting guide</a>.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authentication"></a><h2 id="authentication">Authentication</h2>

<aside class="admonition danger">
    <strong>danger</strong>
    <em>Warning</em>
    <p>Please be aware that hard coding any credentials in plain text is not something that is recommended. We strongly recommend using a Terraform backend that supports encryption. Please use <a href="#environment-variables">environment variables</a>, <code>~/.databrickscfg</code> file, encrypted <code>.tfvars</code> files or secret store of your choice (Hashicorp <a href="https://www.vaultproject.io/">Vault</a>, AWS <a href="https://aws.amazon.com/secrets-manager/">Secrets Manager</a>, AWS <a href="https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-parameter-store.html">Param Store</a>, Azure <a href="https://azure.microsoft.com/en-us/services/key-vault/">Key Vault</a>)</p>
</aside>

<p>There are currently a number of supported methods to <a href="https://docs.databricks.com/dev-tools/api/latest/authentication.html">authenticate</a> into the Databricks platform to create resources:</p>

<ul>
<li><a href="#authenticating-with-hostname-and-token">PAT Tokens</a></li>
<li>AWS, Azure and GCP via <a href="#authenticating-with-databricks-managed-service-principal">Databricks-managed Service Principals</a></li>
<li>GCP via <a href="#special-configurations-for-gcp">Google Cloud CLI</a></li>
<li>Azure Active Directory Tokens via <a href="#authenticating-with-azure-cli">Azure CLI</a>, <a href="#authenticating-with-azure-managed-service-principal">Azure-managed Service Principals</a>, or <a href="#authenticating-with-azure-msi">Managed Service Identities</a></li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20Databricks%20CLI%20credentials"></a><h3 id="authenticating-with-databricks-cli-credentials">Authenticating with Databricks CLI credentials</h3>

<p>If no configuration option is given, the provider will look up configured credentials in <code>~/.databrickscfg</code> file. It is created by the <code>databricks configure --token</code> command. Check <a href="https://docs.databricks.com/dev-tools/cli/index.html#set-up-authentication">this page</a>
for more details. The provider uses config file credentials only when <code>host</code>/<code>token</code> or <code>azure_auth</code> options are not specified.
It is the recommended way to use Databricks Terraform provider, in case you're already using the same approach with
<a href="https://www.terraform.io/docs/providers/aws/index.html#shared-credentials-file">AWS Shared Credentials File</a>
or <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/guides/azure_cli">Azure CLI authentication</a>.</p>

<pre><code>provider "databricks" {
}
</code></pre>

<p>You can specify non-standard location of configuration file through <code>config_file</code> parameter or <code>DATABRICKS_CONFIG_FILE</code> environment variable:</p>

<pre><code>provider "databricks" {
  config_file = "/opt/databricks/cli-config"
}
</code></pre>

<p>You can specify a <a href="https://docs.databricks.com/dev-tools/cli/index.html#connection-profiles">CLI connection profile</a> through <code>profile</code> parameter or <code>DATABRICKS_CONFIG_PROFILE</code> environment variable:</p>

<pre><code>provider "databricks" {
  profile = "ML_WORKSPACE"
}
</code></pre>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20hostname%20and%20token"></a><h3 id="authenticating-with-hostname-and-token">Authenticating with hostname and token</h3>

<p>You can use <code>host</code> and <code>token</code> parameters to supply credentials to the workspace. When environment variables are preferred, then you can specify <code>DATABRICKS_HOST</code> and <code>DATABRICKS_TOKEN</code> instead. Environment variables are the second most recommended way of configuring this provider.</p>

<pre><code>provider "databricks" {
  host  = "https://abc-cdef-ghi.cloud.databricks.com"
  token = "dapitokenhere"
}
</code></pre>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20Databricks-managed%20Service%20Principal"></a><h3 id="authenticating-with-databricks-managed-service-principal">Authenticating with Databricks-managed Service Principal</h3>

<p>You can use the <code>client_id</code> + <code>client_secret</code> attributes to authenticate with a Databricks-managed service principal at both the account and workspace levels in all supported clouds. The <code>client_id</code> is the <code>application_id</code> of the <a href="resources/service_principal.md">Service Principal</a> and <code>client_secret</code> is its secret. You can generate the secret from Databricks Accounts Console (see <a href="https://docs.databricks.com/dev-tools/authentication-oauth.html#step-2-create-an-oauth-secret-for-a-service-principal">instruction</a>) or by using the Terraform resource <a href="resources/service_principal_secret.md">databricks_service_principal_secret</a>.</p>

<pre><code>provider "databricks" {
  host          = "https://abc-cdef-ghi.cloud.databricks.com"
  client_id     = var.client_id
  client_secret = var.client_secret
}
</code></pre>

<p>To create resources at both the account and workspace levels, you can create two providers as shown below</p>

<pre><code>provider "databricks" {
  alias         = "accounts"
  host          = "https://accounts.cloud.databricks.com"
  client_id     = var.client_id
  client_secret = var.client_secret
  account_id    = "00000000-0000-0000-0000-000000000000"
}

provider "databricks" {
  alias         = "workspace"
  host          = var.workspace_host
  client_id     = var.client_id
  client_secret = var.client_secret
}
</code></pre>

<p>Next, you can specify the corresponding provider when creating the resource. For example, you can use the workspace provider to create a workspace group</p>

<pre><code>resource "databricks_group" "cluster_admin" {
  provider                   = databricks.workspace
  display_name               = "cluster_admin"
  allow_cluster_create       = true
  allow_instance_pool_create = false
}
</code></pre>

<ul>
<li><code>client_id</code> - The <code>application_id</code> of the <a href="resources/service_principal.md">Service Principal</a>. Alternatively, you can provide this value as an environment variable <code>DATABRICKS_CLIENT_ID</code>.</li>
<li><code>client_secret</code> - Secret of the service principal. Alternatively, you can provide this value as an environment variable <code>DATABRICKS_CLIENT_SECRET</code>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>If you experience technical difficulties with rolling out resources in this example, please make sure that <a href="#environment-variables">environment variables</a> don't <a href="#empty-provider-block">conflict with other</a> provider block attributes. When in doubt, please run <code>TF_LOG=DEBUG terraform apply</code> to enable <a href="https://www.terraform.io/docs/internals/debugging.html">debug mode</a> through the <a href="https://www.terraform.io/docs/cli/config/environment-variables.html#tf_log"><code>TF_LOG</code></a> environment variable. Look specifically for <code>Explicit and implicit attributes</code> lines, that should indicate authentication attributes used.</p>
</aside>

<p>The provider block supports the following arguments:</p>

<ul>
<li><code>host</code> - (optional) This is the host of the Databricks workspace. It is a URL that you use to login to your workspace.
Alternatively, you can provide this value as an environment variable <code>DATABRICKS_HOST</code>.</li>
<li><code>token</code> - (optional) This is the API token to authenticate into the workspace. Alternatively, you can provide this value as an environment variable <code>DATABRICKS_TOKEN</code>.</li>
<li><code>config_file</code> - (optional) Location of the Databricks CLI credentials file created by <code>databricks configure --token</code> command (~/.databrickscfg by default). Check <a href="https://docs.databricks.com/dev-tools/cli/index.html#set-up-authentication">Databricks CLI documentation</a> for more details. The provider uses configuration file credentials when you don't specify host/token/azure attributes. Alternatively, you can provide this value as an environment variable <code>DATABRICKS_CONFIG_FILE</code>. This field defaults to <code>~/.databrickscfg</code>.</li>
<li><code>profile</code> - (optional) Connection profile specified within ~/.databrickscfg. Please check <a href="https://docs.databricks.com/dev-tools/cli/index.html#connection-profiles">connection profiles section</a> for more details. This field defaults to
<code>DEFAULT</code>.</li>
<li><code>account_id</code> - (required for account-level operations) Account ID found in the top right corner of <a href="https://accounts.cloud.databricks.com/">Accounts Console</a>. Alternatively, you can provide this value as an environment variable <code>DATABRICKS_ACCOUNT_ID</code>. Only has effect when <code>host = "https://accounts.cloud.databricks.com/"</code>, and is currently used to provision account admins via <a href="resources/user.md">databricks_user</a>. <strong>Note:  do NOT use in the workspace-level provider to avoid <code>...invalid Databricks Account configuration</code> errors</strong>.</li>
<li><code>auth_type</code> - (optional) enforce specific auth type to be used in very rare cases, where a single Terraform state manages Databricks workspaces on more than one cloud and <code>more than one authorization method configured</code> error is a false positive. Valid values are <code>pat</code>, <code>basic</code>, <code>oauth-m2m</code>, <code>azure-client-secret</code>, <code>azure-msi</code>, <code>azure-cli</code>, <code>github-oidc-azure</code>, <code>google-credentials</code>, and <code>google-id</code>.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Special%20configurations%20for%20Azure"></a><h2 id="special-configurations-for-azure">Special configurations for Azure</h2>

<p>The below Azure authentication options are supported at both the account and workspace levels. The provider works with <a href="https://docs.microsoft.com/en-us/cli/azure/authenticate-azure-cli?view=azure-cli-latest">Azure CLI authentication</a> to facilitate local development workflows, though for automated scenarios, managed identity or service principal auth is recommended (and specification of <code>azure_use_msi</code>, <code>azure_client_id</code>, <code>azure_client_secret</code> and <code>azure_tenant_id</code> parameters).</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20Azure%20MSI"></a><h3 id="authenticating-with-azure-msi">Authenticating with Azure MSI</h3>

<p>Since v0.3.8, it's possible to leverage <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/guides/managed_service_identity">Azure Managed Service Identity</a> authentication, which is using the same environment variables as <code>azurerm</code> provider. Both <code>SystemAssigned</code> and <code>UserAssigned</code> identities work, as long as they have <code>Contributor</code> role on subscription level and created the workspace resource, or directly added to workspace through <a href="resources/service_principal.md">databricks_service_principal</a>.</p>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"databricks"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">host</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="nv">data.azurerm_databricks_workspace.this.workspace_url</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_workspace_resource_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_databricks_workspace.this.id</span><span class="c1"></span>

<span class="c1">  # ARM_USE_MSI environment variable is recommended</span>
<span class="w">  </span><span class="na">azure_use_msi</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20Azure%20CLI"></a><h3 id="authenticating-with-azure-cli">Authenticating with Azure CLI</h3>

<p>It's possible to use <a href="https://docs.microsoft.com/cli/azure/">Azure CLI</a> authentication, where the provider would rely on access token cached by <code>az login</code> command so that local development scenarios are possible. Technically, the provider will call <code>az account get-access-token</code> each time before an access token is about to expire.</p>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"azurerm"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="nb">features</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_databricks_workspace"</span><span class="w"> </span><span class="nv">"this"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">"centralus"</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-workspace-name"</span><span class="w"></span>
<span class="w">  </span><span class="na">resource_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.resource_group</span><span class="w"></span>
<span class="w">  </span><span class="na">sku</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"premium"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">provider</span><span class="w"> </span><span class="nv">"databricks"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">host</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_databricks_workspace.this.workspace_url</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"databricks_user"</span><span class="w"> </span><span class="nv">"my-user"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">user_name</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"test-user@databricks.com"</span><span class="w"></span>
<span class="w">  </span><span class="na">display_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"Test User"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20Azure-managed%20Service%20Principal%20using%20Client%20Secret"></a><h3 id="authenticating-with-azure-managed-service-principal-using-client-secret">Authenticating with Azure-managed Service Principal using Client Secret</h3>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"azurerm"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">client_id</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">var.client_id</span><span class="w"></span>
<span class="w">  </span><span class="na">client_secret</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">var.client_secret</span><span class="w"></span>
<span class="w">  </span><span class="na">tenant_id</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">var.tenant_id</span><span class="w"></span>
<span class="w">  </span><span class="na">subscription_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.subscription_id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_databricks_workspace"</span><span class="w"> </span><span class="nv">"this"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">"centralus"</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-workspace-name"</span><span class="w"></span>
<span class="w">  </span><span class="na">resource_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.resource_group</span><span class="w"></span>
<span class="w">  </span><span class="na">sku</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"premium"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">provider</span><span class="w"> </span><span class="nv">"databricks"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">host</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_databricks_workspace.this.workspace_url</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_workspace_resource_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_databricks_workspace.this.id</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_client_id</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">var.client_id</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_client_secret</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="nv">var.client_secret</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_tenant_id</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">var.tenant_id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"databricks_user"</span><span class="w"> </span><span class="nv">"my-user"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">user_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test-user@databricks.com"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<ul>
<li><code>azure_workspace_resource_id</code> - (optional) <code>id</code> attribute of <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/databricks_workspace">azurerm_databricks_workspace</a> resource. Combination of subscription id, resource group name, and workspace name. Required with <code>auzre_use_msi</code> or <code>azure_client_secret</code>.</li>
<li><code>azure_client_secret</code> - (optional) This is the Azure Enterprise Application (Service principal) client secret. This service principal requires contributor access to your Azure Databricks deployment. Alternatively, you can provide this value as an environment variable <code>ARM_CLIENT_SECRET</code>.</li>
<li><code>azure_client_id</code> - (optional) This is the Azure Enterprise Application (Service principal) client id. This service principal requires contributor access to your Azure Databricks deployment. Alternatively, you can provide this value as an environment variable <code>ARM_CLIENT_ID</code>.</li>
<li><code>azure_tenant_id</code> - (optional) This is the Azure Active Directory Tenant id in which the Enterprise Application (Service Principal)
resides. Alternatively, you can provide this value as an environment variable <code>ARM_TENANT_ID</code>.</li>
<li><code>azure_environment</code> - (optional) This is the Azure Environment which defaults to the <code>public</code> cloud. Other options are <code>german</code>, <code>china</code> and <code>usgovernment</code>. Alternatively, you can provide this value as an environment variable <code>ARM_ENVIRONMENT</code>.</li>
<li><code>azure_use_msi</code> - (optional) Use <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/guides/managed_service_identity">Azure Managed Service Identity</a> authentication. Alternatively, you can provide this value as an environment variable <code>ARM_USE_MSI</code>.</li>
</ul>

<p>There are <code>ARM_*</code> environment variables provide a way to share authentication configuration using the <code>databricks</code> provider alongside the <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest"><code>azurerm</code> provider</a>.</p>

<p>When a workspace is created using a service principal account, that service principal account is automatically added to the workspace as a member of the admins group. To add a new service principal account to an existing workspace, create a <a href="resources/service_principal.md">databricks_service_principal</a>.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Authenticating%20with%20Azure-managed%20Service%20Principal%20using%20GITHUB%20OIDC"></a><h3 id="authenticating-with-azure-managed-service-principal-using-github-oidc">Authenticating with Azure-managed Service Principal using GITHUB OIDC</h3>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"azurerm"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">client_id</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">var.client_id</span><span class="w"></span>
<span class="w">  </span><span class="na">tenant_id</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">var.tenant_id</span><span class="w"></span>
<span class="w">  </span><span class="na">subscription_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.subscription_id</span><span class="w"></span>
<span class="w">  </span><span class="na">use_oidc</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"azurerm_databricks_workspace"</span><span class="w"> </span><span class="nv">"this"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">location</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">"centralus"</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">                </span><span class="o">=</span><span class="w"> </span><span class="s2">"my-workspace-name"</span><span class="w"></span>
<span class="w">  </span><span class="na">resource_group_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">var.resource_group</span><span class="w"></span>
<span class="w">  </span><span class="na">sku</span><span class="w">                 </span><span class="o">=</span><span class="w"> </span><span class="s2">"premium"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">provider</span><span class="w"> </span><span class="nv">"databricks"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">host</span><span class="w">                        </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_databricks_workspace.this.workspace_url</span><span class="w"></span>
<span class="w">  </span><span class="na">auth_type</span><span class="w">                   </span><span class="o">=</span><span class="w"> </span><span class="s2">"github-oidc-azure"</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_workspace_resource_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">azurerm_databricks_workspace.this.id</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_client_id</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">var.client_id</span><span class="w"></span>
<span class="w">  </span><span class="na">azure_tenant_id</span><span class="w">             </span><span class="o">=</span><span class="w"> </span><span class="nv">var.tenant_id</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"databricks_user"</span><span class="w"> </span><span class="nv">"my-user"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">user_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"test-user@databricks.com"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>Follow the <a href="https://docs.github.com/en/actions/security-for-github-actions/security-hardening-your-deployments/configuring-openid-connect-in-azure">Configuring OpenID Connect in Azure</a>. You can then use the Azure service principal to authenticate in databricks. </p>

<ul>
<li><p><code>azure_workspace_resource_id</code> - (optional) <code>id</code> attribute of <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/databricks_workspace">azurerm_databricks_workspace</a> resource. Combination of subscription id, resource group name, and workspace name. Required with <code>azure_use_msi</code> or <code>azure_client_secret</code>.</p></li>
<li><p><code>azure_client_id</code> - (optional) This is the Azure Enterprise Application (Service principal) client id. This service principal requires contributor access to your Azure Databricks deployment. Alternatively, you can provide this value as an environment variable <code>ARM_CLIENT_ID</code>.</p></li>
<li><code>azure_tenant_id</code> - (optional) This is the Azure Active Directory Tenant id in which the Enterprise Application (Service Principal)
resides. Alternatively, you can provide this value as an environment variable <code>ARM_TENANT_ID</code>.</li>
<li><code>azure_environment</code> - (optional) This is the Azure Environment which defaults to the <code>public</code> cloud. Other options are <code>german</code>, <code>china</code> and <code>usgovernment</code>. Alternatively, you can provide this value as an environment variable <code>ARM_ENVIRONMENT</code>.</li>
<li><code>auth_type</code> - (required) This is the Authentication Type that is used for specifying the authenticate method. This is required for this authentication type.</li>
</ul>

<p>There are <code>ARM_*</code> environment variables provide a way to share authentication configuration using the <code>databricks</code> provider alongside the <a href="https://registry.terraform.io/providers/hashicorp/azurerm/latest"><code>azurerm</code> provider</a>.</p>

<p>When a workspace is created using a service principal account, that service principal account is automatically added to the workspace as a member of the admins group. To add a new service principal account to an existing workspace, create a <a href="resources/service_principal.md">databricks_service_principal</a>.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Special%20configurations%20for%20GCP"></a><h2 id="special-configurations-for-gcp">Special configurations for GCP</h2>

<p>The provider works with <a href="https://cloud.google.com/sdk/docs/authorizing">Google Cloud CLI authentication</a> to facilitate local development workflows. For automated scenarios, a service principal auth is necessary using <code>google_service_account</code> parameter with <a href="https://cloud.google.com/docs/authentication#service-accounts">impersonation</a> and Application Default Credentials. Alternatively, you could provide the service account key directly by passing it to <code>google_credentials</code> parameter (or <code>GOOGLE_CREDENTIALS</code> environment variable)</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Special%20configuration%20for%20Unity%20Catalog"></a><h2 id="special-configuration-for-unity-catalog">Special configuration for Unity Catalog</h2>

<p>Except for metastore, metastore assignment and storage credential objects, Unity Catalog APIs are accessible via <strong>workspace-level APIs</strong>. This design may change in the future.</p>

<p>If you are configuring a new Databricks account for the first time, please create at least one workspace with an identity (user or service principal) that you intend to use for Unity Catalog rollout. You can then configure the provider using that identity and workspace to provision the required Unity Catalog resources.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Special%20considerations%20for%20Unity%20Catalog%20Resources"></a><h2 id="special-considerations-for-unity-catalog-resources">Special considerations for Unity Catalog Resources</h2>

<p>When performing a single Terraform apply to update both the owner and other fields for Unity Catalog resources, the process first updates the owner, followed by the other fields using the new owner's permissions. If your principal is not the owner (specifically, the newly updated owner), you will not have the authority to modify those fields. In cases where you wish to change the owner to another individual and also update other fields, we recommend initially updating the fields using your principal, which should have owner permissions, and then updating the owner in a separate step.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Miscellaneous%20configuration%20parameters"></a><h2 id="miscellaneous-configuration-parameters">Miscellaneous configuration parameters</h2>

<aside class="admonition danger">
    <strong>danger</strong>
    <em>Warning</em>
    <p>Combination of <code>debug_headers</code> and <code>debug_truncate_bytes</code> results in dumping of sensitive information to logs. Use it for troubleshooting purposes only.</p>
</aside>

<p>This section covers configuration parameters not related to authentication. They could be used when debugging problems, or do an additional tuning of provider's behaviour:</p>

<ul>
<li><code>http_timeout_seconds</code> - the amount of time Terraform waits for a response from Databricks REST API. Default is <em>60</em>.</li>
<li><code>rate_limit</code> - defines maximum number of requests per second made to Databricks REST API by Terraform. Default is <em>15</em>.</li>
<li><code>debug_truncate_bytes</code> - Applicable only when <code>TF_LOG=DEBUG</code> is set. Truncate JSON fields in HTTP requests and responses above this limit. Default is <em>96</em>.</li>
<li><code>debug_headers</code> - Applicable only when <code>TF_LOG=DEBUG</code> is set. Debug HTTP headers of requests made by the provider. Default is <em>false</em>. We recommend turning this flag on only under exceptional circumstances, when troubleshooting authentication issues. Turning this flag on will log first <code>debug_truncate_bytes</code> of any HTTP header value in cleartext.</li>
<li><code>skip_verify</code> - skips SSL certificate verification for HTTP calls. <em>Use at your own risk.</em> Default is <em>false</em> (don't skip verification).</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Environment%20variables"></a><h2 id="environment-variables">Environment variables</h2>

<p>The following configuration attributes can be passed via environment variables:</p>

<table>
<thead>
<tr>
  <th style="text-align:right;">Argument</th>
  <th>Environment variable</th>
</tr>
</thead>
<tbody>
<tr>
  <td style="text-align:right;"><code>auth_type</code></td>
  <td><code>DATABRICKS_AUTH_TYPE</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>host</code></td>
  <td><code>DATABRICKS_HOST</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>token</code></td>
  <td><code>DATABRICKS_TOKEN</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>account_id</code></td>
  <td><code>DATABRICKS_ACCOUNT_ID</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>config_file</code></td>
  <td><code>DATABRICKS_CONFIG_FILE</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>profile</code></td>
  <td><code>DATABRICKS_CONFIG_PROFILE</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>client_id</code></td>
  <td><code>DATABRICKS_CLIENT_ID</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>client_secret</code></td>
  <td><code>DATABRICKS_CLIENT_SECRET</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>azure_client_secret</code></td>
  <td><code>ARM_CLIENT_SECRET</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>azure_client_id</code></td>
  <td><code>ARM_CLIENT_ID</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>azure_tenant_id</code></td>
  <td><code>ARM_TENANT_ID</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>azure_workspace_resource_id</code></td>
  <td><code>DATABRICKS_AZURE_RESOURCE_ID</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>azure_use_msi</code></td>
  <td><code>ARM_USE_MSI</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>azure_environment</code></td>
  <td><code>ARM_ENVIRONMENT</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>google_credentials</code></td>
  <td><code>GOOGLE_CREDENTIALS</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>google_service_account</code></td>
  <td><code>GOOGLE_SERVICE_ACCOUNT</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>debug_truncate_bytes</code></td>
  <td><code>DATABRICKS_DEBUG_TRUNCATE_BYTES</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>debug_headers</code></td>
  <td><code>DATABRICKS_DEBUG_HEADERS</code></td>
</tr>
<tr>
  <td style="text-align:right;"><code>rate_limit</code></td>
  <td><code>DATABRICKS_RATE_LIMIT</code></td>
</tr>
</tbody>
</table>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Empty%20provider%20block"></a><h2 id="empty-provider-block">Empty provider block</h2>

<p>For example, with the following zero-argument configuration:</p>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"databricks"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
</code></pre></div>

<ol>
<li>Provider will check all the supported environment variables and set values of relevant arguments.</li>
<li>In case any conflicting arguments are present, the plan will end with an error.</li>
<li>Will check for the presence of <code>host</code> + <code>token</code> pair, continue trying otherwise.</li>
<li>Will check for Azure workspace ID, <code>azure_client_secret</code> + <code>azure_client_id</code> + <code>azure_tenant_id</code> presence, continue trying otherwise.</li>
<li>Will check for availability of Azure MSI, if enabled via <code>azure_use_msi</code>, continue trying otherwise.</li>
<li>Will check for Azure workspace ID presence, and if <code>AZ CLI</code> returns an access token, continue trying otherwise.</li>
<li>Will check for the <code>~/.databrickscfg</code> file in the home directory, will fail otherwise.</li>
<li>Will check for <code>profile</code> presence and try picking from that file will fail otherwise.</li>
</ol>

<p>Please check <a href="https://github.com/databricks/databricks-sdk-go#default-authentication-flow">Default Authentication Flow</a> from <a href="https://docs.databricks.com/dev-tools/sdk-go.html">Databricks SDK for Go</a> in case you need more details.</p>

            
        
    </body></html>