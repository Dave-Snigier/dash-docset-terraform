<html><!-- Online page at https://registry.terraform.io/providers/aliyun/alicloud/latest/docs/resources/fc_trigger --><head>
                <title>alicloud_fc_trigger</title>
                <meta charset="utf-8"/>
                <link href="../../../../../../style.css" rel="stylesheet"/>
            </head>
            <body>
                <h1 id="alicloud_fc_trigger">alicloud_fc_trigger</h1>

<p>Provides an Alicloud Function Compute Trigger resource. Based on trigger, execute your code in response to events in Alibaba Cloud.
 For information about Service and how to use it, see <a href="https://www.alibabacloud.com/help/en/fc/developer-reference/api-fc-open-2021-04-06-createtrigger">What is Function Compute</a>.</p>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>The resource requires a provider field 'account_id'. <a href="https://www.terraform.io/docs/providers/alicloud/index.html#account_id">See account_id</a>.</p>
</aside>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>Available since v1.93.0.</p>
</aside>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Example%20Usage"></a><h2 id="example-usage">Example Usage</h2>

<p>Basic Usage</p>

<div style="display: block;margin-bottom: 40px;"><div class="oics-button" style="float: right;position: absolute;margin-bottom: 10px;">
  <a href="https://api.aliyun.com/terraform?resource=alicloud_fc_trigger&amp;exampleId=f10270d0-14d4-416c-f574-29002e67f3a40b4f4fbd&amp;activeTab=example&amp;spm=docs.r.fc_trigger.0.f10270d014&amp;intl_lang=EN_US" target="_blank">
    <img alt="Open in AliCloud" src="https://img.alicdn.com/imgextra/i1/O1CN01hjjqXv1uYUlY56FyX_!!6000000006049-55-tps-254-36.svg" style="max-height: 44px; max-width: 100%;"/>
  </a>
</div></div>

<div class="codehilite"><pre><span></span><code><span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_account"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_regions"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"random_integer"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99999</span><span class="w"></span>
<span class="w">  </span><span class="na">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_log_project"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">project_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value-${random_integer.default.result}"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_log_store"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">project_name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_log_project.default.project_name</span><span class="w"></span>
<span class="w">  </span><span class="na">logstore_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_log_store"</span><span class="w"> </span><span class="nv">"source_store"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">project_name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_log_project.default.project_name</span><span class="w"></span>
<span class="w">  </span><span class="na">logstore_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-source-store"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ram_role"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"fcservicerole-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">document</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">  {</span>
<span class="sh">      "Statement": [</span>
<span class="sh">        {</span>
<span class="sh">          "Action": "sts:AssumeRole",</span>
<span class="sh">          "Effect": "Allow",</span>
<span class="sh">          "Principal": {</span>
<span class="sh">            "Service": [</span>
<span class="sh">              "fc.aliyuncs.com"</span>
<span class="sh">            ]</span>
<span class="sh">          }</span>
<span class="sh">        }</span>
<span class="sh">      ],</span>
<span class="sh">      "Version": "1"</span>
<span class="sh">  }</span>
<span class="sh">  EOF</span>
<span class="sh">  description = "this is a example"</span>
<span class="sh">  force       = true</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_ram_role_policy_attachment" "default" {</span>
<span class="sh">  role_name   = alicloud_ram_role.default.name</span>
<span class="sh">  policy_name = "AliyunLogFullAccess"</span>
<span class="sh">  policy_type = "System"</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_fc_service" "default" {</span>
<span class="sh">  name        = "example-value-${random_integer.default.result}"</span>
<span class="sh">  description = "example-value"</span>
<span class="sh">  role        = alicloud_ram_role.default.arn</span>
<span class="sh">  log_config {</span>
<span class="sh">    project                 = alicloud_log_project.default.project_name</span>
<span class="sh">    logstore                = alicloud_log_store.default.logstore_name</span>
<span class="sh">    enable_instance_metrics = true</span>
<span class="sh">    enable_request_metrics  = true</span>
<span class="sh">  }</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_oss_bucket" "default" {</span>
<span class="sh">  bucket = "terraform-example-${random_integer.default.result}"</span>
<span class="sh">}</span>
<span class="sh"># If you upload the function by OSS Bucket, you need to specify path can't upload by content.</span>
<span class="sh">resource "alicloud_oss_bucket_object" "default" {</span>
<span class="sh">  bucket  = alicloud_oss_bucket.default.id</span>
<span class="sh">  key     = "index.py"</span>
<span class="sh">  content = "import logging \ndef handler(event, context): \nlogger = logging.getLogger() \nlogger.info('hello world') \nreturn 'hello world'"</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_fc_function" "default" {</span>
<span class="sh">  service     = alicloud_fc_service.default.name</span>
<span class="sh">  name        = "terraform-example"</span>
<span class="sh">  description = "example"</span>
<span class="sh">  oss_bucket  = alicloud_oss_bucket.default.id</span>
<span class="sh">  oss_key     = alicloud_oss_bucket_object.default.key</span>
<span class="sh">  memory_size = "512"</span>
<span class="sh">  runtime     = "python3.10"</span>
<span class="sh">  handler     = "hello.handler"</span>
<span class="sh">}</span>


<span class="sh">resource "alicloud_fc_trigger" "default" {</span>
<span class="sh">  service    = alicloud_fc_service.default.name</span>
<span class="sh">  function   = alicloud_fc_function.default.name</span>
<span class="sh">  name       = "terraform-example"</span>
<span class="sh">  role       = alicloud_ram_role.default.arn</span>
<span class="sh">  source_arn = "acs:log:${data.alicloud_regions.default.regions.0.id}:${data.alicloud_account.default.id}:project/${alicloud_log_project.default.project_name}"</span>
<span class="sh">  type       = "log"</span>
<span class="sh">  config     = &lt;&lt;EOF</span>
<span class="sh">    {</span>
<span class="sh">        "sourceConfig": {</span>
<span class="sh">            "logstore": "${alicloud_log_store.source_store.logstore_name}",</span>
<span class="sh">            "startTime": null</span>
<span class="sh">        },</span>
<span class="sh">        "jobConfig": {</span>
<span class="sh">            "maxRetryTime": 3,</span>
<span class="sh">            "triggerInterval": 60</span>
<span class="sh">        },</span>
<span class="sh">        "functionParameter": {</span>
<span class="sh">            "a": "b",</span>
<span class="sh">            "c": "d"</span>
<span class="sh">        },</span>
<span class="sh">        "logConfig": {</span>
<span class="sh">             "project": "${alicloud_log_project.default.project_name}",</span>
<span class="sh">            "logstore": "${alicloud_log_store.default.logstore_name}"</span>
<span class="sh">        },</span>
<span class="sh">        "enable": true</span>
<span class="sh">    }</span>

<span class="dl">EOF</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>MNS topic trigger:</p>

<div style="display: block;margin-bottom: 40px;"><div class="oics-button" style="float: right;position: absolute;margin-bottom: 10px;">
  <a href="https://api.aliyun.com/terraform?resource=alicloud_fc_trigger&amp;exampleId=04f4d0c3-a376-e4c2-9aab-11d153798b2d63b483eb&amp;activeTab=example&amp;spm=docs.r.fc_trigger.1.04f4d0c3a3&amp;intl_lang=EN_US" target="_blank">
    <img alt="Open in AliCloud" src="https://img.alicdn.com/imgextra/i1/O1CN01hjjqXv1uYUlY56FyX_!!6000000006049-55-tps-254-36.svg" style="max-height: 44px; max-width: 100%;"/>
  </a>
</div></div>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"alicloud"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cn-hangzhou"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_account"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_regions"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"random_integer"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99999</span><span class="w"></span>
<span class="w">  </span><span class="na">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_mns_topic"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value-${random_integer.default.result}"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ram_role"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"fcservicerole-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">document</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="err">  {</span>
<span class="err">      "Statement": [</span>
<span class="err">        {</span>
<span class="err">          "Action": "sts:AssumeRole",</span>
<span class="err">          "Effect": "Allow",</span>
<span class="err">          "Principal": {</span>
<span class="err">            "Service": [</span>
<span class="err">              "mns.aliyuncs.com"</span>
<span class="err">            ]</span>
<span class="err">          }</span>
<span class="err">        }</span>
<span class="err">      ],</span>
<span class="err">      "Version": "1"</span>
<span class="err">  }</span>
<span class="err">  EOF</span>
<span class="err">  description = "this is a example"</span>
<span class="err">  force       = true</span>
<span class="err">}</span>

<span class="err">resource "alicloud_ram_role_policy_attachment" "default" {</span>
<span class="err">  role_name   = alicloud_ram_role.default.name</span>
<span class="err">  policy_name = "AliyunMNSNotificationRolePolicy"</span>
<span class="err">  policy_type = "System"</span>
<span class="err">}</span>

<span class="err">resource "alicloud_fc_service" "default" {</span>
<span class="err">  name            = "example-value-${random_integer.default.result}"</span>
<span class="err">  description     = "example-value"</span>
<span class="err">  internet_access = false</span>
<span class="err">}</span>

<span class="err">resource "alicloud_oss_bucket" "default" {</span>
<span class="err">  bucket = "terraform-example-${random_integer.default.result}"</span>
<span class="err">}</span>
<span class="err"># If you upload the function by OSS Bucket, you need to specify path can't upload by content.</span>
<span class="err">resource "alicloud_oss_bucket_object" "default" {</span>
<span class="err">  bucket  = alicloud_oss_bucket.default.id</span>
<span class="err">  key     = "index.py"</span>
<span class="err">  content = "import logging \ndef handler(event, context): \nlogger = logging.getLogger() \nlogger.info('hello world') \nreturn 'hello world'"</span>
<span class="err">}</span>

<span class="err">resource "alicloud_fc_function" "default" {</span>
<span class="err">  service     = alicloud_fc_service.default.name</span>
<span class="err">  name        = "terraform-example-${random_integer.default.result}"</span>
<span class="err">  description = "example"</span>
<span class="err">  oss_bucket  = alicloud_oss_bucket.default.id</span>
<span class="err">  oss_key     = alicloud_oss_bucket_object.default.key</span>
<span class="err">  memory_size = "512"</span>
<span class="err">  runtime     = "python3.10"</span>
<span class="err">  handler     = "hello.handler"</span>
<span class="err">}</span>

<span class="err">resource "alicloud_fc_trigger" "default" {</span>
<span class="err">  service    = alicloud_fc_service.default.name</span>
<span class="err">  function   = alicloud_fc_function.default.name</span>
<span class="err">  name       = "terraform-example"</span>
<span class="err">  role       = alicloud_ram_role.default.arn</span>
<span class="err">  source_arn = "acs:mns:${data.alicloud_regions.default.regions.0.id}:${data.alicloud_account.default.id}:/topics/${alicloud_mns_topic.default.name}"</span>
<span class="err">  type       = "mns_topic"</span>
<span class="err">  config_mns = &lt;&lt;EOF</span>
<span class="err">  {</span>
<span class="err">    "filterTag":"exampleTag",</span>
<span class="err">    "notifyContentFormat":"STREAM",</span>
<span class="err">    "notifyStrategy":"BACKOFF_RETRY"</span>
<span class="err">  }</span>
<span class="err">  EOF</span>
<span class="err">}</span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Statement"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">        </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"Action"</span><span class="o">:</span><span class="w"> </span><span class="s2">"sts:AssumeRole"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s2">"Effect"</span><span class="o">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s2">"Principal"</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Service"</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="w"></span>
<span class="w">              </span><span class="s2">"mns.aliyuncs.com"</span><span class="w"></span>
<span class="w">            </span><span class="p">]</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">],</span><span class="w"></span>
<span class="w">      </span><span class="s2">"Version"</span><span class="o">:</span><span class="w"> </span><span class="s2">"1"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="err">EOF</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"this is a example"</span><span class="w"></span>
<span class="w">  </span><span class="na">force</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ram_role_policy_attachment"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">role_name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_ram_role.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AliyunMNSNotificationRolePolicy"</span><span class="w"></span>
<span class="w">  </span><span class="na">policy_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"System"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_service"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value"</span><span class="w"></span>
<span class="w">  </span><span class="na">internet_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_oss_bucket"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-${random_integer.default.result}"</span><span class="w"></span>
<span class="p">}</span><span class="c1"></span>
<span class="c1"># If you upload the function by OSS Bucket, you need to specify path can't upload by content.</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_oss_bucket_object"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">bucket</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_oss_bucket.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">key</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"index.py"</span><span class="w"></span>
<span class="w">  </span><span class="na">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"import logging \ndef handler(event, context): \nlogger = logging.getLogger() \nlogger.info('hello world') \nreturn 'hello world'"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_function"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>
<span class="w">  </span><span class="na">oss_bucket</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_oss_bucket.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">oss_key</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_oss_bucket_object.default.key</span><span class="w"></span>
<span class="w">  </span><span class="na">memory_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"512"</span><span class="w"></span>
<span class="w">  </span><span class="na">runtime</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"python3.10"</span><span class="w"></span>
<span class="w">  </span><span class="na">handler</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"hello.handler"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_trigger"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">function</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_function.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example"</span><span class="w"></span>
<span class="w">  </span><span class="na">role</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_ram_role.default.arn</span><span class="w"></span>
<span class="w">  </span><span class="na">source_arn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"acs:mns:${data.alicloud_regions.default.regions.0.id}:${data.alicloud_account.default.id}:/topics/${alicloud_mns_topic.default.name}"</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"mns_topic"</span><span class="w"></span>
<span class="w">  </span><span class="na">config_mns</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="err">  {</span>
<span class="err">    "filterTag":"exampleTag",</span>
<span class="err">    "notifyContentFormat":"STREAM",</span>
<span class="err">    "notifyStrategy":"BACKOFF_RETRY"</span>
<span class="err">  }</span>
<span class="err">  EOF</span>
<span class="err">}</span>
<span class="w">  </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="s2">"filterTag"</span><span class="o">:</span><span class="s2">"exampleTag"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">"notifyContentFormat"</span><span class="o">:</span><span class="s2">"STREAM"</span><span class="p">,</span><span class="w"></span>
<span class="w">    </span><span class="s2">"notifyStrategy"</span><span class="o">:</span><span class="s2">"BACKOFF_RETRY"</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="err">EOF</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>CDN events trigger:</p>

<div style="display: block;margin-bottom: 40px;"><div class="oics-button" style="float: right;position: absolute;margin-bottom: 10px;">
  <a href="https://api.aliyun.com/terraform?resource=alicloud_fc_trigger&amp;exampleId=33bbfc00-315e-a4c1-44ac-4df032a1b46a0167ff13&amp;activeTab=example&amp;spm=docs.r.fc_trigger.2.33bbfc0031&amp;intl_lang=EN_US" target="_blank">
    <img alt="Open in AliCloud" src="https://img.alicdn.com/imgextra/i1/O1CN01hjjqXv1uYUlY56FyX_!!6000000006049-55-tps-254-36.svg" style="max-height: 44px; max-width: 100%;"/>
  </a>
</div></div>

<div class="codehilite"><pre><span></span><code><span class="kr">provider</span><span class="w"> </span><span class="nv">"alicloud"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">region</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"cn-hangzhou"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_account"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"random_integer"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99999</span><span class="w"></span>
<span class="w">  </span><span class="na">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_cdn_domain_new"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">domain_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example${random_integer.default.result}.tf.com"</span><span class="w"></span>
<span class="w">  </span><span class="na">cdn_type</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="s2">"web"</span><span class="w"></span>
<span class="w">  </span><span class="na">scope</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"overseas"</span><span class="w"></span>
<span class="w">  </span><span class="nb">sources</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="na">content</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"1.1.1.1"</span><span class="w"></span>
<span class="w">    </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"ipaddr"</span><span class="w"></span>
<span class="w">    </span><span class="na">priority</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">20</span><span class="w"></span>
<span class="w">    </span><span class="na">port</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="m">80</span><span class="w"></span>
<span class="w">    </span><span class="na">weight</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="m">10</span><span class="w"></span>
<span class="w">  </span><span class="p">}</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_service"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value"</span><span class="w"></span>
<span class="w">  </span><span class="na">internet_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ram_role"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"fcservicerole-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">document</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="dl">EOF</span><span class="sh"></span>
<span class="sh">    {</span>
<span class="sh">      "Statement": [</span>
<span class="sh">        {</span>
<span class="sh">          "Action": "sts:AssumeRole",</span>
<span class="sh">          "Effect": "Allow",</span>
<span class="sh">          "Principal": {</span>
<span class="sh">            "Service": [</span>
<span class="sh">              "cdn.aliyuncs.com"</span>
<span class="sh">            ]</span>
<span class="sh">          }</span>
<span class="sh">        }</span>
<span class="sh">      ],</span>
<span class="sh">      "Version": "1"</span>
<span class="sh">  }</span>
<span class="sh">  EOF</span>
<span class="sh">  description = "this is a example"</span>
<span class="sh">  force       = true</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_ram_policy" "default" {</span>
<span class="sh">  policy_name     = "fcservicepolicy-${random_integer.default.result}"</span>
<span class="sh">  policy_document = &lt;&lt;EOF</span>
<span class="sh">    {</span>
<span class="sh">        "Version": "1",</span>
<span class="sh">        "Statement": [</span>
<span class="sh">        {</span>
<span class="sh">            "Action": [</span>
<span class="sh">            "fc:InvokeFunction"</span>
<span class="sh">            ],</span>
<span class="sh">        "Resource": [</span>
<span class="sh">            "acs:fc:*:*:services/${alicloud_fc_service.default.name}/functions/*",</span>
<span class="sh">            "acs:fc:*:*:services/${alicloud_fc_service.default.name}.*/functions/*"</span>
<span class="sh">        ],</span>
<span class="sh">        "Effect": "Allow"</span>
<span class="sh">        }</span>
<span class="sh">        ]</span>
<span class="sh">    }</span>
<span class="sh">    EOF</span>
<span class="sh">  description     = "this is a example"</span>
<span class="sh">  force           = true</span>
<span class="sh">}</span>
<span class="sh">resource "alicloud_ram_role_policy_attachment" "default" {</span>
<span class="sh">  role_name   = alicloud_ram_role.default.name</span>
<span class="sh">  policy_name = alicloud_ram_policy.default.policy_name</span>
<span class="sh">  policy_type = "Custom"</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_oss_bucket" "default" {</span>
<span class="sh">  bucket = "terraform-example-${random_integer.default.result}"</span>
<span class="sh">}</span>
<span class="sh"># If you upload the function by OSS Bucket, you need to specify path can't upload by content.</span>
<span class="sh">resource "alicloud_oss_bucket_object" "default" {</span>
<span class="sh">  bucket  = alicloud_oss_bucket.default.id</span>
<span class="sh">  key     = "index.py"</span>
<span class="sh">  content = "import logging \ndef handler(event, context): \nlogger = logging.getLogger() \nlogger.info('hello world') \nreturn 'hello world'"</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_fc_function" "default" {</span>
<span class="sh">  service     = alicloud_fc_service.default.name</span>
<span class="sh">  name        = "terraform-example-${random_integer.default.result}"</span>
<span class="sh">  description = "example"</span>
<span class="sh">  oss_bucket  = alicloud_oss_bucket.default.id</span>
<span class="sh">  oss_key     = alicloud_oss_bucket_object.default.key</span>
<span class="sh">  memory_size = "512"</span>
<span class="sh">  runtime     = "python3.10"</span>
<span class="sh">  handler     = "hello.handler"</span>
<span class="sh">}</span>

<span class="sh">resource "alicloud_fc_trigger" "default" {</span>
<span class="sh">  service    = alicloud_fc_service.default.name</span>
<span class="sh">  function   = alicloud_fc_function.default.name</span>
<span class="sh">  name       = "terraform-example"</span>
<span class="sh">  role       = alicloud_ram_role.default.arn</span>
<span class="sh">  source_arn = "acs:cdn:*:${data.alicloud_account.default.id}"</span>
<span class="sh">  type       = "cdn_events"</span>
<span class="sh">  config     = &lt;&lt;EOF</span>
<span class="sh">      {"eventName":"LogFileCreated",</span>
<span class="sh">     "eventVersion":"1.0.0",</span>
<span class="sh">     "notes":"cdn events trigger",</span>
<span class="sh">     "filter":{</span>
<span class="sh">        "domain": ["${alicloud_cdn_domain_new.default.domain_name}"]</span>
<span class="sh">        }</span>
<span class="sh">    }</span>
<span class="dl">EOF</span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<p>EventBridge trigger:</p>

<div style="display: block;margin-bottom: 40px;"><div class="oics-button" style="float: right;position: absolute;margin-bottom: 10px;">
  <a href="https://api.aliyun.com/terraform?resource=alicloud_fc_trigger&amp;exampleId=5012b39c-cc91-006c-2926-09ba180ba3ac7b724656&amp;activeTab=example&amp;spm=docs.r.fc_trigger.3.5012b39ccc&amp;intl_lang=EN_US" target="_blank">
    <img alt="Open in AliCloud" src="https://img.alicdn.com/imgextra/i1/O1CN01hjjqXv1uYUlY56FyX_!!6000000006049-55-tps-254-36.svg" style="max-height: 44px; max-width: 100%;"/>
  </a>
</div></div>

<div class="codehilite"><pre><span></span><code><span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_account"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{}</span><span class="w"></span>
<span class="kr">data</span><span class="w"> </span><span class="nc">"alicloud_regions"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">current</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"random_integer"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">max</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">99999</span><span class="w"></span>
<span class="w">  </span><span class="na">min</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10000</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_event_bridge_service_linked_role"</span><span class="w"> </span><span class="nv">"service_linked_role"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">product_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"AliyunServiceRoleForEventBridgeSendToFC"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_service"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-value"</span><span class="w"></span>
<span class="w">  </span><span class="na">internet_access</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="no">false</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_oss_bucket"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">bucket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-${random_integer.default.result}"</span><span class="w"></span>
<span class="p">}</span><span class="c1"></span>
<span class="c1"># If you upload the function by OSS Bucket, you need to specify path can't upload by content.</span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_oss_bucket_object"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">bucket</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_oss_bucket.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">key</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"index.py"</span><span class="w"></span>
<span class="w">  </span><span class="na">content</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"import logging \ndef handler(event, context): \nlogger = logging.getLogger() \nlogger.info('hello world') \nreturn 'hello world'"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_function"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example"</span><span class="w"></span>
<span class="w">  </span><span class="na">description</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example"</span><span class="w"></span>
<span class="w">  </span><span class="na">oss_bucket</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_oss_bucket.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">oss_key</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_oss_bucket_object.default.key</span><span class="w"></span>
<span class="w">  </span><span class="na">memory_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"512"</span><span class="w"></span>
<span class="w">  </span><span class="na">runtime</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"python3.10"</span><span class="w"></span>
<span class="w">  </span><span class="na">handler</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"hello.handler"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_trigger"</span><span class="w"> </span><span class="nv">"oss_trigger"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_function.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-oss"</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"eventbridge"</span><span class="w"></span>
<span class="w">  </span><span class="na">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsonencode</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="s2">"triggerEnable"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"asyncInvocationType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSourceConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"Default"</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventRuleFilterPattern"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"{\"source\":[\"acs.oss\"],\"type\"</span><span class="o">:</span><span class="p">[</span><span class="err">\</span><span class="s2">"oss:BucketCreated:PutBucket\"]}"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSinkConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"deliveryOption"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s2">"eventSchema"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"CloudEvents"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"runOptions"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"retryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"PushRetryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"BACKOFF_RETRY"</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="s2">"errorsTolerance"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"ALL"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"></span>


<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_trigger"</span><span class="w"> </span><span class="nv">"mns_trigger"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_function.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-mns"</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"eventbridge"</span><span class="w"></span>
<span class="w">  </span><span class="na">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsonencode</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="s2">"triggerEnable"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"asyncInvocationType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSourceConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"MNS"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceParameters"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"sourceMNSParameters"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="s2">"RegionId"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${data.alicloud_regions.default.regions.0.id}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"QueueName"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"mns-queue"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"IsBase64Decode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventRuleFilterPattern"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSinkConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"deliveryOption"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s2">"eventSchema"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"CloudEvents"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"runOptions"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"retryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"PushRetryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"BACKOFF_RETRY"</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="s2">"errorsTolerance"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"ALL"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ons_instance"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">remark</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ons_group"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">group_name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"GID-example"</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_ons_instance.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">remark</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_ons_topic"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">topic_name</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"mytopic"</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_id</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_ons_instance.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">message_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="w"></span>
<span class="w">  </span><span class="na">remark</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_trigger"</span><span class="w"> </span><span class="nv">"rocketmq_trigger"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_function.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-rocketmq"</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"eventbridge"</span><span class="w"></span>
<span class="w">  </span><span class="na">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsonencode</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="s2">"triggerEnable"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"asyncInvocationType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventRuleFilterPattern"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSinkConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"deliveryOption"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s2">"eventSchema"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"CloudEvents"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSourceConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"RocketMQ"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceParameters"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"sourceRocketMQParameters"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="s2">"RegionId"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${data.alicloud_regions.default.regions.0.id}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"InstanceId"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${alicloud_ons_instance.default.id}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"GroupID"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${alicloud_ons_group.default.group_name}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Topic"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${alicloud_ons_topic.default.topic_name}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Timestamp"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="m">1686296162</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Tag"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"example-tag"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"Offset"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"CONSUME_FROM_LAST_OFFSET"</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"runOptions"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"retryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"PushRetryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"BACKOFF_RETRY"</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="s2">"errorsTolerance"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"ALL"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_amqp_instance"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_name</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-${random_integer.default.result}"</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_type</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">"professional"</span><span class="w"></span>
<span class="w">  </span><span class="na">max_tps</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="m">1000</span><span class="w"></span>
<span class="w">  </span><span class="na">queue_capacity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">50</span><span class="w"></span>
<span class="w">  </span><span class="na">support_eip</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="no">true</span><span class="w"></span>
<span class="w">  </span><span class="na">max_eip_tps</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="m">128</span><span class="w"></span>
<span class="w">  </span><span class="na">payment_type</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="s2">"Subscription"</span><span class="w"></span>
<span class="w">  </span><span class="na">period</span><span class="w">         </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_amqp_virtual_host"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_id</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_amqp_instance.default.id</span><span class="w"></span>
<span class="w">  </span><span class="na">virtual_host_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-VirtualHost"</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_amqp_queue"</span><span class="w"> </span><span class="nv">"default"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">instance_id</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_amqp_virtual_host.default.instance_id</span><span class="w"></span>
<span class="w">  </span><span class="na">queue_name</span><span class="w">        </span><span class="o">=</span><span class="w"> </span><span class="s2">"example-queue"</span><span class="w"></span>
<span class="w">  </span><span class="na">virtual_host_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_amqp_virtual_host.default.virtual_host_name</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>

<span class="kr">resource</span><span class="w"> </span><span class="nc">"alicloud_fc_trigger"</span><span class="w"> </span><span class="nv">"rabbitmq_trigger"</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">  </span><span class="na">service</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_service.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">function</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">alicloud_fc_function.default.name</span><span class="w"></span>
<span class="w">  </span><span class="na">name</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"terraform-example-rabbitmq"</span><span class="w"></span>
<span class="w">  </span><span class="na">type</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">"eventbridge"</span><span class="w"></span>
<span class="w">  </span><span class="na">config</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">jsonencode</span><span class="p">(</span><span class="w"></span>
<span class="w">    </span><span class="p">{</span><span class="w"></span>
<span class="w">      </span><span class="s2">"triggerEnable"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"asyncInvocationType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="no">false</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventRuleFilterPattern"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"{}"</span><span class="p">,</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSourceConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceType"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"RabbitMQ"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"eventSourceParameters"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"sourceRabbitMQParameters"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">            </span><span class="s2">"RegionId"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${data.alicloud_regions.default.regions.0.id}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"InstanceId"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${alicloud_amqp_instance.default.id}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"VirtualHostName"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${alicloud_amqp_virtual_host.default.virtual_host_name}"</span><span class="p">,</span><span class="w"></span>
<span class="w">            </span><span class="s2">"QueueName"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"${alicloud_amqp_queue.default.queue_name}"</span><span class="w"></span>
<span class="w">          </span><span class="p">}</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"eventSinkConfig"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"deliveryOption"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="p">,</span><span class="w"></span>
<span class="w">          </span><span class="s2">"eventSchema"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"CloudEvents"</span><span class="w"></span>
<span class="w">        </span><span class="p">}</span><span class="w"></span>
<span class="w">      </span><span class="p">},</span><span class="w"></span>
<span class="w">      </span><span class="s2">"runOptions"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">        </span><span class="s2">"retryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">          </span><span class="s2">"PushRetryStrategy"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"BACKOFF_RETRY"</span><span class="w"></span>
<span class="w">        </span><span class="p">},</span><span class="w"></span>
<span class="w">        </span><span class="s2">"errorsTolerance"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"ALL"</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="s2">"mode"</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s2">"event-driven"</span><span class="w"></span>
<span class="w">      </span><span class="p">}</span><span class="w"></span>
<span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="w">  </span><span class="p">)</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
</code></pre></div>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Module%20Support"></a><h2 id="module-support">Module Support</h2>

<p>You can use to the existing <a href="https://registry.terraform.io/modules/terraform-alicloud-modules/fc/alicloud">fc module</a> 
to create several triggers quickly.</p>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Argument%20Reference"></a><h2 id="argument-reference">Argument Reference</h2>

<p>The following arguments are supported:</p>

<ul>
<li><code>service</code> - (Required, ForceNew) The Function Compute service name.</li>
<li><code>function</code> - (Required, ForceNew) The Function Compute function name.</li>
<li><code>name</code> - (ForceNew, Optional) The Function Compute trigger name. It is the only in one service and is conflict with "name_prefix".</li>
<li><code>name_prefix</code> - (ForceNew, Optional) Setting a prefix to get a only trigger name. It is conflict with "name".</li>
<li><code>role</code> - (Optional) RAM role arn attached to the Function Compute trigger. Role used by the event source to call the function. The value format is "acs:ram::$account-id:role/$role-name". See <a href="https://www.alibabacloud.com/help/doc-detail/53102.htm">Create a trigger</a> for more details.</li>
<li><code>source_arn</code> - (Optional, ForceNew) Event source resource address. See <a href="https://www.alibabacloud.com/help/doc-detail/53102.htm">Create a trigger</a> for more details.</li>
<li><code>config</code> - (Optional) The config of Function Compute trigger.It is valid when <code>type</code> is not "mns_topic".See <a href="https://www.alibabacloud.com/help/doc-detail/70140.htm">Configure triggers and events</a> for more details.</li>
<li><code>config_mns</code> - (Optional, ForceNew, Available in 1.41.0) The config of Function Compute trigger when the type is "mns_topic".It is conflict with <code>config</code>.</li>
<li><code>type</code> - (Required, ForceNew) The Type of the trigger. Valid values: ["oss", "log", "timer", "http", "mns_topic", "cdn_events", "eventbridge"].</li>
</ul>

<aside class="admonition note">
    <strong>note</strong>
    <em>note</em>
    <p>Config does not support modification when type is mns_topic. -&gt; <strong>NOTE:</strong> type = cdn_events, available in 1.47.0+. -&gt; <strong>NOTE:</strong> type = eventbridge, available in 1.173.0+.</p>
</aside>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Attributes%20Reference"></a><h2 id="attributes-reference">Attributes Reference</h2>

<p>The following arguments are exported:</p>

<ul>
<li><code>id</code> - The ID of the function. The value is formate as <code>&lt;service&gt;:&lt;function&gt;:&lt;name&gt;</code>.</li>
<li><code>last_modified</code> - The date this resource was last modified.</li>
<li><code>trigger_id</code> - The Function Compute trigger ID.</li>
</ul>

<a class="dashAnchor" name="//apple_ref/cpp/Section/Import"></a><h2 id="import">Import</h2>

<p>Function Compute trigger can be imported using the id, e.g.</p>

<div class="codehilite"><pre><span></span><code>$ terraform import alicloud_fc_trigger.foo my-fc-service:hello-world:hello-trigger
</code></pre></div>

            
        
    </body></html>